---------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submit
> tion\Log\DataCleaning.log
  log type:  text
 opened on:  29 Oct 2018, 14:48:36

. 
. * 1: Data cleaning
. local n: word count $DataSet /* set counter of data set */

. forvalues m = 1/`n' { /* loop within data set */
  2.         /* select data set */
.         global CurrentData: word `m' of $DataSet
  3.         /* select year list according to data set */
.         local currentYearList: word `m' of $YearList
  4.         /* set counter of year list */
.         local numYear: word count $`currentYearList'
  5.         dis "Current data: $CurrentData, year list: `currentYearList', numbe
> r of year: `numYear' "
  6.         
.         forvalues k = 1/`numYear'{ /* loop reading do-file within year list */
  7.                 /* set a survey year */
.                 global SVYY: word `k' of $`currentYearList'
  8.                 disp "Current survey year: $SVYY"
  9.                 do "$Path\Code\DataCleaning.do"
 10.         }
 11. }
Current data: JHPS, year list: JHPSyear, number of year: 6 
Current survey year: 2009

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2009

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/JHPS2009.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(523 vars, 4,022 obs)

. count
  4,022

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistJHPS2009
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in JHPS 2009
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 edbg workstatus ///
>                                 occ owner ind size employed regular ///
>                                 empsinceyear empsincemonth union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 edbg workstatus                                
>  occ owner ind size employed regular                                 empsinceye
> ar empsincemonth union                                 paymethod monthlypaid da
> ilypaid hourlypaid yearlypaid bonus                                 workdayperm
> onth workhourperweek overworkperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v101 v102 v103 ///
>                                 v142 v146 ///
>                                 v153 v154 v155 v156 v159 v160 ///
>                                 v167 v168 v169 ///
>                                 v173 v174 v175 v176 v177 v178 ///
>                                 v180 v181 v182

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      4,022    2637.299    1733.446          1       6092
          v4 |      4,022    1.281701    .4498841          1          2
          v5 |      4,022    1.514918    .4998395          1          2
          v6 |      4,022    1958.712     16.3414       1916       1989
          v7 |      4,022    6.356539    3.555253          1         12
-------------+---------------------------------------------------------
        v101 |      4,022    2.466932    9.331139          1         99
        v102 |      4,022    1.946295    .8146263          1          9
        v103 |      4,022    77.45699    28.24138          1         99
        v142 |      4,022    2.843362    1.373472          1          9
        v146 |      4,022    2.824714    2.203715          1          9
-------------+---------------------------------------------------------
        v153 |      4,022    33.66609    38.94466          1         99
        v154 |      4,022    3.945549     2.94858          1          9
        v155 |      4,022    35.02685    37.27762          1         99
        v156 |      4,022     4.78369     2.67142          1          9
        v159 |      4,022    5.564644    2.070667          1          9
-------------+---------------------------------------------------------
        v160 |      4,022    5.305818    2.982326          1          9
        v167 |      4,022    4481.334    3371.899       1949       9999
        v168 |      4,022    37.03332    41.00278          1         99
        v169 |      4,022    4.177772    3.101447          1          9
        v173 |      4,022    4.150671    3.178229          1          9
-------------+---------------------------------------------------------
        v174 |      4,022    51527.95    43953.48          0      99999
        v175 |      4,022    860167.5    156593.7       2500     999999
        v176 |      4,022    768266.9    304489.4        400     999999
        v177 |      4,022    86012.27    15761.64         10      99999
        v178 |      4,022     33344.9    43788.53          0      99999
-------------+---------------------------------------------------------
        v180 |      4,022    43.32844    32.69565          1         99
        v181 |      4,022    343.4744    413.1666          1        999
        v182 |      4,022    485.4229    466.2065          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v12 v13 v14 ///
>                                 v101 v102 v103 ///
>                                 v274 v279 ///
>                                 v286 v287 v288 v289 v292 v293 ///
>                                 v300 v301 v302 ///
>                                 v306 v307 v308 v309 v310 v311 ///
>                                 v313 v314 v315

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      4,022    2637.299    1733.446          1       6092
          v4 |      4,022    1.281701    .4498841          1          2
         v12 |      4,022     1.84361    1.659428          1          9
         v13 |      4,022    2451.917     1812.62       1906       9999
         v14 |      4,022    12.33516    22.02487          1         99
-------------+---------------------------------------------------------
        v101 |      4,022    2.466932    9.331139          1         99
        v102 |      4,022    1.946295    .8146263          1          9
        v103 |      4,022    77.45699    28.24138          1         99
        v274 |      4,022    3.774739    2.734906          1          9
        v279 |      4,022    4.401293    2.965285          1          9
-------------+---------------------------------------------------------
        v286 |      4,022    49.98409    40.91722          1         99
        v287 |      4,022    5.161363    3.104188          1          9
        v288 |      4,022    50.82944     39.4608          1         99
        v289 |      4,022    5.697166    2.717264          1          9
        v292 |      4,022     6.24913    2.116148          1          9
-------------+---------------------------------------------------------
        v293 |      4,022    6.151914    2.764673          1          9
        v300 |      4,022    5892.018    3468.528       1942       9999
        v301 |      4,022    53.44381    41.46709          1         99
        v302 |      4,022    5.406266    3.061427          1          9
        v306 |      4,022    5.384883     3.24657          1          9
-------------+---------------------------------------------------------
        v307 |      4,022    62327.02    40796.79          0      99999
        v308 |      4,022    871975.2    121136.7       1600     999999
        v309 |      4,022    833198.2    215697.7        350     999999
        v310 |      4,022    86569.86    14242.99         30      99999
        v311 |      4,022    52197.71    44494.67          0      99999
-------------+---------------------------------------------------------
        v313 |      4,022    58.31452    34.03751          1         99
        v314 |      4,022    529.7999    425.6853          1        999
        v315 |      4,022    632.0052    423.6972          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2009

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      4,022    2637.299    1733.446          1       6092
 make household head dummy  
(4,022 missing values generated)
(1,989 real changes made)
(2,033 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .52647975  .45189762 | .50546992
(4,022 missing values generated)
(1,796 real changes made)
(1,928 real changes made)
(2,094 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .49428868  .44130627 |  .4793635
          pri[4022,30]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      4,022    2637.299    1733.446          1       6092
(4,022 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      4,022     12637.3    1733.446      10001      16092
(1,133 observations deleted)
  2,889
 make household head dummy  
(2,889 missing values generated)
(1,652 real changes made)
(1,237 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .42817584 | .42817584
(2,889 missing values generated)
(1,106 real changes made)
(77 real changes made)
(2,812 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .02665282 | .02665282
          spo[2889,30]
          pri[4022,30]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[6911,30]
          spo[2889,30]
          pri[4022,30]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 6911
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 6,911

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2009.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      3,421       49.50       49.50
          2 |      3,490       50.50      100.00
------------+-----------------------------------
      Total |      6,911      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      6,911        2009           0       2009       2009

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2009m1

. disp %tm r(max)
 2009m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 10 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 14 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      6,901     1957.38    15.53208       1916       1989

. gen bym=ym(byear, bmonth)
(14 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1916m1

. disp %tm r(max)
 1989m9

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(14 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           21             19
 5%           25             19
10%           29             19       Obs               6,897
25%           38             19       Sum of Wgt.       6,897

50%           51                      Mean           50.72481
                        Largest       Std. Dev.      15.54779
75%           63             87
90%           71             88       Variance       241.7337
95%           74             91       Skewness      -.0863486
99%           81             93       Kurtosis       2.036084

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(6,911 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
empsinceyear: 2191 missing values generated
empsinceyear: 345 missing values generated
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
empsincemo~h: 2191 missing values generated
empsincemo~h: 487 missing values generated
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
(2,678 missing values generated)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
 1942m4
.         disp %tm r(max)
 2009m4
.         
.         gen emptenure=(svyym-empym)
(2,678 missing values generated)
.         label var emptenure "Tenure months" 
.         sum emptenure, de

                        Tenure months
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0             -3
 5%            5             -3
10%           11             -3       Obs               4,233
25%           34             -3       Sum of Wgt.       4,233

50%          113                      Mean           161.0789
                        Largest       Std. Dev.      150.7683
75%          250            711
90%          395            729       Variance       22731.08
95%          465            741       Skewness       .9900505
99%          573            801       Kurtosis       3.158892
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
.         sum emptenure
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2009.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2010

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2010

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/JHPS2010.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(1,510 vars, 3,470 obs)

. count
  3,470

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistJHPS2010
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in JHPS 2010
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. *** common variable with other years
. local varList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. *** variables of working experience
. global ExpList ///
>                                 cas* full* self* side* fmw*     

. disp "`varList'" "$ExpList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweekcas* full* self* side* fmw*

. 
. ** variable number of principal
. *** common variable with other years
. local renameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v101 v102 v103 ///
>                                 v175 ///
>                                 v182 v183 v184 v185 v188 v189 ///
>                                 v231 v196 ///
>                                 v198 v199 v200 v201 v202 v203 ///
>                                 v205 v206 v207

. *** variables of working experience
. global CasPri v368-v420

. global FullPri v421-v473

. global SelfPri v474-v526

. global SidePri v527-v579

. global FmwPri v580-v632

. sum `renameListPri' $CasPri $FullPri $SelfPri $SidePri $FmwPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,470    2595.789     1720.81          1       6092
          v4 |      3,470    1.268012    .4429875          1          2
          v5 |      3,470    1.509798     .499976          1          2
          v6 |      3,470    1958.452    16.03453       1917       1989
          v7 |      3,470    6.336023    3.552765          1         12
-------------+---------------------------------------------------------
        v101 |      3,470    2.464265    9.343653          1         99
        v102 |      3,470    2.004323    1.060974          1          9
        v103 |      3,470    76.43573    29.27373          1         99
        v175 |      3,470    2.851297    2.249453          1          9
        v182 |      3,470    33.48127    38.86635          1         99
-------------+---------------------------------------------------------
        v183 |      3,470    3.930259    2.929316          1          9
        v184 |      3,470    35.14813    37.13274          1         99
        v185 |      3,470    4.800288    2.665486          1          9
        v188 |      3,470     5.56196    2.071661          1          9
        v189 |      3,470    5.285879    2.958462          1          9
-------------+---------------------------------------------------------
        v231 |      3,470     5.53487    14.59237          1         99
        v196 |      3,470    4.370605    3.153121          1          9
        v198 |      3,470    4.181844    3.173573          1          9
        v199 |      3,470    51636.72    43879.95          5      99999
        v200 |      3,470    859663.4    158117.3       1600     999999
-------------+---------------------------------------------------------
        v201 |      3,470    770545.4      302034        400     999999
        v202 |      3,470    85408.37    17235.54         10      99999
        v203 |      3,470    32208.74    43306.53          0      99999
        v205 |      3,470    43.29798    32.72365          1         99
        v206 |      3,470    341.4239    412.5037          1        999
-------------+---------------------------------------------------------
        v207 |      3,470    505.5628    466.0535          0        999
        v368 |      3,470    8.624207    1.692911          1          9
        v369 |      3,470     8.49049    1.953863          1          9
        v370 |      3,470    8.455908    2.014416          1          9
        v371 |      3,470    8.428242     2.06116          1          9
-------------+---------------------------------------------------------
        v372 |      3,470    8.430548    2.057319          1          9
        v373 |      3,470    8.405187     2.09904          1          9
        v374 |      3,470    8.432853    2.053469          1          9
        v375 |      3,470    8.425937    2.064991          1          9
        v376 |      3,470    8.467435    1.994502          1          9
-------------+---------------------------------------------------------
        v377 |      3,470    8.543516    1.855933          1          9
        v378 |      3,470    8.525072     1.89074          1          9
        v379 |      3,470    8.550432    1.842664          1          9
        v380 |      3,470    8.545821    1.851523          1          9
        v381 |      3,470    8.499712    1.937292          1          9
-------------+---------------------------------------------------------
        v382 |      3,470    8.508934    1.920533          1          9
        v383 |      3,470    8.492795    1.949737          1          9
        v384 |      3,470    8.462824    2.002499          1          9
        v385 |      3,470    8.423631    2.068812          1          9
        v386 |      3,470     8.39366    2.117632          1          9
-------------+---------------------------------------------------------
        v387 |      3,470    8.372911    2.150536          1          9
        v388 |      3,470    8.356772    2.175648          1          9
        v389 |      3,470    8.345245    2.193336          1          9
        v390 |      3,470    8.319885    2.231547          1          9
        v391 |      3,470    8.338329    2.203852          1          9
-------------+---------------------------------------------------------
        v392 |      3,470    8.324496     2.22467          1          9
        v393 |      3,470    8.336023    2.207341          1          9
        v394 |      3,470    8.342939    2.196849          1          9
        v395 |      3,470    8.359078    2.172086          1          9
        v396 |      3,470    8.398271    2.110222          1          9
-------------+---------------------------------------------------------
        v397 |      3,470    8.414409    2.084001          1          9
        v398 |      3,470    8.412104    2.087775          1          9
        v399 |      3,470    8.416715    2.080218          1          9
        v400 |      3,470    8.435159    2.049609          1          9
        v401 |      3,470    8.460519    2.006482          1          9
-------------+---------------------------------------------------------
        v402 |      3,470    8.492795    1.949737          1          9
        v403 |      3,470    8.527378    1.886434          1          9
        v404 |      3,470     8.54121     1.86033          1          9
        v405 |      3,470    8.566571     1.81122          1          9
        v406 |      3,470    8.559654     1.82478          1          9
-------------+---------------------------------------------------------
        v407 |      3,470    8.571182    1.802109          1          9
        v408 |      3,470    8.596542    1.750934          1          9
        v409 |      3,470    8.608069    1.727048          1          9
        v410 |      3,470    8.610375    1.722222          1          9
        v411 |      3,470    8.522767    1.895033          1          9
-------------+---------------------------------------------------------
        v412 |      3,470    8.566571     1.81122          1          9
        v413 |      3,470    8.633429     1.67302          1          9
        v414 |      3,470    8.686455    1.552656          1          9
        v415 |      3,470    8.725648    1.456075          1          9
        v416 |      3,470    8.790202    1.278609          1          9
-------------+---------------------------------------------------------
        v417 |      3,470    8.836311    1.132734          1          9
        v418 |      3,470    8.884726     .953501          1          9
        v419 |      3,470    8.905476    .8645672          1          9
        v420 |      3,470    8.930836    .7407351          1          9
        v421 |      3,470    6.429395    3.736423          1          9
-------------+---------------------------------------------------------
        v422 |      3,470    5.717003    3.935781          1          9
        v423 |      3,470     5.38732    3.981778          1          9
        v424 |      3,470    4.834006     3.99713          1          9
        v425 |      3,470    4.414409    3.957474          1          9
        v426 |      3,470    3.985591    3.869792          1          9
-------------+---------------------------------------------------------
        v427 |      3,470    4.054755     3.88727          1          9
        v428 |      3,470    4.308357    3.940318          1          9
        v429 |      3,470    4.555043    3.975748          1          9
        v430 |      3,470     4.78098    3.994575          1          9
        v431 |      3,470    4.990778    4.000566          1          9
-------------+---------------------------------------------------------
        v432 |      3,470    5.159078    3.997412          1          9
        v433 |      3,470    5.299712    3.989331          1          9
        v434 |      3,470    5.456484     3.97444          1          9
        v435 |      3,470    5.530259    3.965269          1          9
        v436 |      3,470    5.634006    3.950004          1          9
-------------+---------------------------------------------------------
        v437 |      3,470    5.721614    3.934938          1          9
        v438 |      3,470    5.797695    3.920218          1          9
        v439 |      3,470    5.862248    3.906524          1          9
        v440 |      3,470    5.965994    3.882164          1          9
        v441 |      3,470    6.012104    3.870396          1          9
-------------+---------------------------------------------------------
        v442 |      3,470    6.069741    3.854859          1          9
        v443 |      3,470    6.173487    3.824545          1          9
        v444 |      3,470    6.251873    3.799602          1          9
        v445 |      3,470     6.33487    3.771236          1          9
        v446 |      3,470    6.385591    3.752892          1          9
-------------+---------------------------------------------------------
        v447 |      3,470    6.459366    3.724815          1          9
        v448 |      3,470    6.519308    3.700763          1          9
        v449 |      3,470    6.595389    3.668598          1          9
        v450 |      3,470    6.694524    3.623861          1          9
        v451 |      3,470    6.795965     3.57466          1          9
-------------+---------------------------------------------------------
        v452 |      3,470    6.867435    3.537837          1          9
        v453 |      3,470    6.959654    3.487587          1          9
        v454 |      3,470    7.074928    3.420241          1          9
        v455 |      3,470    7.137176    3.381682          1          9
        v456 |      3,470    7.234006    3.318492          1          9
-------------+---------------------------------------------------------
        v457 |      3,470    7.319308    3.259428          1          9
        v458 |      3,470    7.420749    3.184791          1          9
        v459 |      3,470    7.519885    3.106922          1          9
        v460 |      3,470    7.605187     3.03573          1          9
        v461 |      3,470    7.683573    2.966643          1          9
-------------+---------------------------------------------------------
        v462 |      3,470    7.801153    2.855853          1          9
        v463 |      3,470    7.918732    2.735537          1          9
        v464 |      3,470    8.430548    2.057319          1          9
        v465 |      3,470    8.552738    1.838213          1          9
        v466 |      3,470    8.665706    1.601043          1          9
-------------+---------------------------------------------------------
        v467 |      3,470    8.739481    1.420162          1          9
        v468 |      3,470    8.776369    1.318916          1          9
        v469 |      3,470     8.85245    1.076553          1          9
        v470 |      3,470    8.880115    .9720997          1          9
        v471 |      3,470    8.900865    .8851449          1          9
-------------+---------------------------------------------------------
        v472 |      3,470    8.921614    .7881142          1          9
        v473 |      3,470    8.940058    .6899877          1          9
        v474 |      3,470    8.850144    1.084772          1          9
        v475 |      3,470    8.817867     1.19344          1          9
        v476 |      3,470    8.790202    1.278609          1          9
-------------+---------------------------------------------------------
        v477 |      3,470    8.744092    1.407958          1          9
        v478 |      3,470     8.70951    1.496723          1          9
        v479 |      3,470    8.647262    1.642637          1          9
        v480 |      3,470    8.580403    1.783712          1          9
        v481 |      3,470    8.527378    1.886434          1          9
-------------+---------------------------------------------------------
        v482 |      3,470    8.495101      1.9456          1          9
        v483 |      3,470    8.469741    1.990488          1          9
        v484 |      3,470    8.458213    2.010454          1          9
        v485 |      3,470    8.412104    2.087775          1          9
        v486 |      3,470    8.386744    2.128679          1          9
-------------+---------------------------------------------------------
        v487 |      3,470    8.352161    2.182748          1          9
        v488 |      3,470    8.349856    2.186285          1          9
        v489 |      3,470    8.315274    2.238393          1          9
        v490 |      3,470    8.299135    2.262118          1          9
        v491 |      3,470    8.285303    2.282167          1          9
-------------+---------------------------------------------------------
        v492 |      3,470     8.27147    2.301958          1          9
        v493 |      3,470    8.280692    2.288793          1          9
        v494 |      3,470    8.278386    2.292095          1          9
        v495 |      3,470    8.280692    2.288793          1          9
        v496 |      3,470    8.278386    2.292095          1          9
-------------+---------------------------------------------------------
        v497 |      3,470    8.289914    2.275513          1          9
        v498 |      3,470    8.299135    2.262118          1          9
        v499 |      3,470     8.29683    2.265478          1          9
        v500 |      3,470    8.282997    2.285484          1          9
        v501 |      3,470    8.299135    2.262118          1          9
-------------+---------------------------------------------------------
        v502 |      3,470    8.303746    2.255377          1          9
        v503 |      3,470    8.310663    2.245209          1          9
        v504 |      3,470    8.315274    2.238393          1          9
        v505 |      3,470    8.326801    2.221219          1          9
        v506 |      3,470    8.324496     2.22467          1          9
-------------+---------------------------------------------------------
        v507 |      3,470    8.342939    2.196849          1          9
        v508 |      3,470    8.352161    2.182748          1          9
        v509 |      3,470    8.370605    2.154149          1          9
        v510 |      3,470    8.391354    2.121323          1          9
        v511 |      3,470    8.405187     2.09904          1          9
-------------+---------------------------------------------------------
        v512 |      3,470    8.435159    2.049609          1          9
        v513 |      3,470    8.467435    1.994502          1          9
        v514 |      3,470     8.49049    1.953863          1          9
        v515 |      3,470    8.513545    1.912082          1          9
        v516 |      3,470    8.531988    1.877784          1          9
-------------+---------------------------------------------------------
        v517 |      3,470    8.555043    1.833749          1          9
        v518 |      3,470    8.589625    1.765074          1          9
        v519 |      3,470    8.651873    1.632357          1          9
        v520 |      3,470     8.68415     1.55812          1          9
        v521 |      3,470    8.702594    1.513757          1          9
-------------+---------------------------------------------------------
        v522 |      3,470    8.760231    1.364259          1          9
        v523 |      3,470    8.799424    1.250932          1          9
        v524 |      3,470    8.810951    1.215351          1          9
        v525 |      3,470    8.836311    1.132734          1          9
        v526 |      3,470    8.854755    1.068266          1          9
-------------+---------------------------------------------------------
        v527 |      3,470    8.986167    .3324204          1          9
        v528 |      3,470    8.986167    .3324204          1          9
        v529 |      3,470    8.983862    .3590032          1          9
        v530 |      3,470     8.97464    .4497744          1          9
        v531 |      3,470    8.956196    .5904354          1          9
-------------+---------------------------------------------------------
        v532 |      3,470    8.944669    .6631112          1          9
        v533 |      3,470    8.933141    .7283908          1          9
        v534 |      3,470     8.92853    .7528701          1          9
        v535 |      3,470    8.912392    .8326999          1          9
        v536 |      3,470     8.90317    .8749196          1          9
-------------+---------------------------------------------------------
        v537 |      3,470    8.884726     .953501          1          9
        v538 |      3,470    8.859366    1.051481          1          9
        v539 |      3,470    8.857061    1.059909          1          9
        v540 |      3,470    8.840922    1.116994          1          9
        v541 |      3,470    8.843228    1.109034          1          9
-------------+---------------------------------------------------------
        v542 |      3,470    8.840922    1.116994          1          9
        v543 |      3,470    8.850144    1.084772          1          9
        v544 |      3,470    8.859366    1.051481          1          9
        v545 |      3,470    8.870893    1.008205          1          9
        v546 |      3,470    8.891643    .9248589          1          9
-------------+---------------------------------------------------------
        v547 |      3,470    8.898559    .8952475          1          9
        v548 |      3,470    8.905476    .8645672          1          9
        v549 |      3,470    8.905476    .8645672          1          9
        v550 |      3,470    8.905476    .8645672          1          9
        v551 |      3,470    8.900865    .8851449          1          9
-------------+---------------------------------------------------------
        v552 |      3,470    8.910086    .8434625          1          9
        v553 |      3,470    8.910086    .8434625          1          9
        v554 |      3,470    8.914697      .82179          1          9
        v555 |      3,470    8.912392    .8326999          1          9
        v556 |      3,470    8.914697      .82179          1          9
-------------+---------------------------------------------------------
        v557 |      3,470    8.914697      .82179          1          9
        v558 |      3,470    8.923919    .7765507          1          9
        v559 |      3,470    8.930836    .7407351          1          9
        v560 |      3,470    8.933141    .7283908          1          9
        v561 |      3,470    8.933141    .7283908          1          9
-------------+---------------------------------------------------------
        v562 |      3,470    8.940058    .6899877          1          9
        v563 |      3,470    8.944669    .6631112          1          9
        v564 |      3,470    8.942363    .6766868          1          9
        v565 |      3,470     8.94928    .6350648          1          9
        v566 |      3,470     8.95389    .6056862          1          9
-------------+---------------------------------------------------------
        v567 |      3,470     8.95389    .6056862          1          9
        v568 |      3,470     8.95389    .6056862          1          9
        v569 |      3,470    8.960807    .5586578          1          9
        v570 |      3,470    8.970029    .4888149          1          9
        v571 |      3,470    8.967723    .5071939          1          9
-------------+---------------------------------------------------------
        v572 |      3,470    8.967723    .5071939          1          9
        v573 |      3,470    8.967723    .5071939          1          9
        v574 |      3,470    8.965418    .5249196          1          9
        v575 |      3,470    8.970029    .4888149          1          9
        v576 |      3,470     8.97464    .4497744          1          9
-------------+---------------------------------------------------------
        v577 |      3,470     8.97464    .4497744          1          9
        v578 |      3,470    8.979251    .4069538          1          9
        v579 |      3,470    8.981556    .3837352          1          9
        v580 |      3,470    8.870893    1.008205          1          9
        v581 |      3,470    8.829395    1.155907          1          9
-------------+---------------------------------------------------------
        v582 |      3,470    8.794813    1.264855          1          9
        v583 |      3,470    8.746398     1.40181          1          9
        v584 |      3,470    8.707205    1.502426          1          9
        v585 |      3,470    8.633429     1.67302          1          9
        v586 |      3,470    8.580403    1.783712          1          9
-------------+---------------------------------------------------------
        v587 |      3,470    8.548127      1.8471          1          9
        v588 |      3,470    8.534294     1.87344          1          9
        v589 |      3,470     8.51585    1.907838          1          9
        v590 |      3,470    8.497406    1.941452          1          9
        v591 |      3,470    8.488184    1.957977          1          9
-------------+---------------------------------------------------------
        v592 |      3,470     8.49049    1.953863          1          9
        v593 |      3,470    8.511239    1.916314          1          9
        v594 |      3,470    8.497406    1.941452          1          9
        v595 |      3,470    8.511239    1.916314          1          9
        v596 |      3,470    8.522767    1.895033          1          9
-------------+---------------------------------------------------------
        v597 |      3,470    8.531988    1.877784          1          9
        v598 |      3,470    8.555043    1.833749          1          9
        v599 |      3,470    8.568876    1.806672          1          9
        v600 |      3,470    8.566571     1.81122          1          9
        v601 |      3,470    8.578098    1.788333          1          9
-------------+---------------------------------------------------------
        v602 |      3,470    8.603458    1.736651          1          9
        v603 |      3,470    8.617291    1.707643          1          9
        v604 |      3,470    8.640346    1.657913          1          9
        v605 |      3,470    8.656484    1.621999          1          9
        v606 |      3,470    8.663401    1.606312          1          9
-------------+---------------------------------------------------------
        v607 |      3,470    8.665706    1.601043          1          9
        v608 |      3,470    8.670317    1.590441          1          9
        v609 |      3,470    8.677233    1.574379          1          9
        v610 |      3,470    8.691066     1.54166          1          9
        v611 |      3,470    8.700288    1.519386          1          9
-------------+---------------------------------------------------------
        v612 |      3,470     8.70951    1.496723          1          9
        v613 |      3,470    8.725648    1.456075          1          9
        v614 |      3,470    8.732565    1.438247          1          9
        v615 |      3,470    8.748703    1.395631          1          9
        v616 |      3,470     8.75562    1.376905          1          9
-------------+---------------------------------------------------------
        v617 |      3,470    8.767147    1.345037          1          9
        v618 |      3,470     8.78098    1.305635          1          9
        v619 |      3,470    8.787896    1.285425          1          9
        v620 |      3,470    8.792507    1.271753          1          9
        v621 |      3,470    8.797118    1.257915          1          9
-------------+---------------------------------------------------------
        v622 |      3,470    8.808646    1.222559          1          9
        v623 |      3,470    8.815562    1.200792          1          9
        v624 |      3,470    8.834006    1.140515          1          9
        v625 |      3,470    8.857061    1.059909          1          9
        v626 |      3,470    8.870893    1.008205          1          9
-------------+---------------------------------------------------------
        v627 |      3,470    8.880115    .9720997          1          9
        v628 |      3,470    8.898559    .8952475          1          9
        v629 |      3,470    8.907781    .8540832          1          9
        v630 |      3,470    8.919308    .7995037          1          9
        v631 |      3,470    8.935447    .7158261          1          9
-------------+---------------------------------------------------------
        v632 |      3,470    8.942363    .6766868          1          9

. 
. ** variable number of spouse
. *** common variable with other years
. local renameListSpo ///
>                                 v1 v4  v12 v13 v14 ///
>                                 v101 v102 v103 ///
>                                 v796 ///
>                                 v803 v804 v805 v806 v809 v810 ///
>                                 v852 v817 ///
>                                 v819 v820 v821 v822 v823 v824 ///
>                                 v826 v827 v828

. *** variables of working experience
. global CasSpo v989-v1041

. global FullSpo v1042-v1094

. global SelfSpo v1095-v1147

. global SideSpo v1148-v1200

. global FmwSpo v1201-v1253

. sum `renameListSpo' $CasSpo $FullSpo $SelfSpo $SideSpo $FmwSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,470    2595.789     1720.81          1       6092
          v4 |      3,470    1.268012    .4429875          1          2
         v12 |      3,470    1.831988    1.607945          1          9
         v13 |      3,470    2432.184    1780.105       1906       9999
         v14 |      3,470    11.89856    21.33468          1         99
-------------+---------------------------------------------------------
        v101 |      3,470    2.464265    9.343653          1         99
        v102 |      3,470    2.004323    1.060974          1          9
        v103 |      3,470    76.43573    29.27373          1         99
        v796 |      3,470    4.378386    2.945365          1          9
        v803 |      3,470     49.7049    40.92424          1         99
-------------+---------------------------------------------------------
        v804 |      3,470    5.155331    3.090416          1          9
        v805 |      3,470    50.81095    39.47361          1         99
        v806 |      3,470    5.693372     2.71728          1          9
        v809 |      3,470    6.251009    2.126605          1          9
        v810 |      3,470    6.123055    2.769228          1          9
-------------+---------------------------------------------------------
        v852 |      3,470    28.26369    38.83174          1         99
        v817 |      3,470    5.396542    3.079815          1          9
        v819 |      3,470    5.336023    3.220905          1          9
        v820 |      3,470    62534.58    40695.45          7      99999
        v821 |      3,470    868206.4    133408.6       1000     999999
-------------+---------------------------------------------------------
        v822 |      3,470    825620.6    228868.5        400     999999
        v823 |      3,470    86298.56    14942.36         10      99999
        v824 |      3,470    50931.44    44548.28          0      99999
        v826 |      3,470    57.85303    34.12486          1         99
        v827 |      3,470    522.2614    426.1063          1        999
-------------+---------------------------------------------------------
        v828 |      3,470    635.3354    422.7391          0        999
        v989 |      3,470    8.549856    1.234051          1          9
        v990 |      3,470    8.489914    1.394627          1          9
        v991 |      3,470    8.487608    1.400384          1          9
        v992 |      3,470     8.42536    1.546453          1          9
-------------+---------------------------------------------------------
        v993 |      3,470    8.388473     1.62571          1          9
        v994 |      3,470    8.370029    1.663617          1          9
        v995 |      3,470    8.393084    1.616062          1          9
        v996 |      3,470    8.344669    1.714047          1          9
        v997 |      3,470    8.404611    1.591626          1          9
-------------+---------------------------------------------------------
        v998 |      3,470    8.416138    1.566724          1          9
        v999 |      3,470    8.427666    1.541334          1          9
       v1000 |      3,470    8.404611    1.591626          1          9
       v1001 |      3,470    8.409222    1.581723          1          9
       v1002 |      3,470    8.395389    1.611211          1          9
-------------+---------------------------------------------------------
       v1003 |      3,470    8.367723    1.668281          1          9
       v1004 |      3,470    8.346974     1.70954          1          9
       v1005 |      3,470    8.330836    1.740783          1          9
       v1006 |      3,470    8.273199    1.846909          1          9
       v1007 |      3,470     8.27781    1.838711          1          9
-------------+---------------------------------------------------------
       v1008 |      3,470    8.268588    1.855059          1          9
       v1009 |      3,470    8.222478    1.934071          1          9
       v1010 |      3,470     8.20634    1.960717          1          9
       v1011 |      3,470     8.20634    1.960717          1          9
       v1012 |      3,470     8.20634    1.960717          1          9
-------------+---------------------------------------------------------
       v1013 |      3,470    8.185591    1.994261          1          9
       v1014 |      3,470     8.20634    1.960717          1          9
       v1015 |      3,470    8.199424    1.971986          1          9
       v1016 |      3,470    8.210951    1.953154          1          9
       v1017 |      3,470    8.238617    1.906916          1          9
-------------+---------------------------------------------------------
       v1018 |      3,470    8.266282    1.859117          1          9
       v1019 |      3,470    8.282421    1.830464          1          9
       v1020 |      3,470     8.30317    1.792739          1          9
       v1021 |      3,470    8.340058    1.723018          1          9
       v1022 |      3,470    8.367723    1.668281          1          9
-------------+---------------------------------------------------------
       v1023 |      3,470    8.411527    1.576742          1          9
       v1024 |      3,470    8.420749    1.556628          1          9
       v1025 |      3,470    8.439193    1.515431          1          9
       v1026 |      3,470    8.429971    1.536196          1          9
       v1027 |      3,470    8.462248    1.461976          1          9
-------------+---------------------------------------------------------
       v1028 |      3,470    8.489914    1.394627          1          9
       v1029 |      3,470    8.487608    1.400384          1          9
       v1030 |      3,470    8.503746     1.35949          1          9
       v1031 |      3,470    8.510663    1.341523          1          9
       v1032 |      3,470    8.432277    1.531036          1          9
-------------+---------------------------------------------------------
       v1033 |      3,470    8.462248    1.461976          1          9
       v1034 |      3,470    8.512968    1.335473          1          9
       v1035 |      3,470    8.572911    1.165599          1          9
       v1036 |      3,470    8.575216    1.158506          1          9
       v1037 |      3,470    8.598271     1.08476          1          9
-------------+---------------------------------------------------------
       v1038 |      3,470    8.628242    .9798242          1          9
       v1039 |      3,470     8.66513    .8312297          1          9
       v1040 |      3,470    8.678963    .7676743          1          9
       v1041 |      3,470    8.685879    .7337375          1          9
       v1042 |      3,470    6.760807    3.320641          1          9
-------------+---------------------------------------------------------
       v1043 |      3,470    6.209798    3.558645          1          9
       v1044 |      3,470    5.898559    3.649705          1          9
       v1045 |      3,470    5.437464     3.73317          1          9
       v1046 |      3,470    5.202305    3.753272          1          9
       v1047 |      3,470    4.798847    3.753334          1          9
-------------+---------------------------------------------------------
       v1048 |      3,470    4.844957    3.755522          1          9
       v1049 |      3,470    5.020173    3.758668          1          9
       v1050 |      3,470    5.206916    3.753021          1          9
       v1051 |      3,470    5.338329     3.74346          1          9
       v1052 |      3,470     5.49049    3.726572          1          9
-------------+---------------------------------------------------------
       v1053 |      3,470     5.61268    3.708437          1          9
       v1054 |      3,470    5.702594    3.692453          1          9
       v1055 |      3,470    5.810951    3.670172          1          9
       v1056 |      3,470    5.926225    3.642781          1          9
       v1057 |      3,470    5.967723    3.631974          1          9
-------------+---------------------------------------------------------
       v1058 |      3,470     6.04611     3.61017          1          9
       v1059 |      3,470    6.106052    3.592254          1          9
       v1060 |      3,470      6.1683    3.572488          1          9
       v1061 |      3,470    6.228242     3.55232          1          9
       v1062 |      3,470    6.292795    3.529333          1          9
-------------+---------------------------------------------------------
       v1063 |      3,470    6.336599    3.512973          1          9
       v1064 |      3,470    6.401153    3.487721          1          9
       v1065 |      3,470    6.470317    3.459124          1          9
       v1066 |      3,470    6.539481    3.428893          1          9
       v1067 |      3,470    6.601729    3.400252          1          9
-------------+---------------------------------------------------------
       v1068 |      3,470    6.673199    3.365648          1          9
       v1069 |      3,470    6.710086    3.347051          1          9
       v1070 |      3,470    6.763112    3.319417          1          9
       v1071 |      3,470    6.829971    3.283022          1          9
       v1072 |      3,470    6.910663    3.236712          1          9
-------------+---------------------------------------------------------
       v1073 |      3,470    6.975216    3.197716          1          9
       v1074 |      3,470    7.025937    3.165816          1          9
       v1075 |      3,470    7.138905    3.090592          1          9
       v1076 |      3,470    7.208069    3.041548          1          9
       v1077 |      3,470    7.297983     2.97418          1          9
-------------+---------------------------------------------------------
       v1078 |      3,470    7.367147    2.919416          1          9
       v1079 |      3,470    7.434006    2.863896          1          9
       v1080 |      3,470     7.52853     2.78077          1          9
       v1081 |      3,470    7.588473    2.725045          1          9
       v1082 |      3,470     7.67147    2.643706          1          9
-------------+---------------------------------------------------------
       v1083 |      3,470    7.777522    2.532023          1          9
       v1084 |      3,470    7.860519     2.43784          1          9
       v1085 |      3,470    8.312392    1.775637          1          9
       v1086 |      3,470     8.37464    1.654241          1          9
       v1087 |      3,470    8.466859    1.451005          1          9
-------------+---------------------------------------------------------
       v1088 |      3,470    8.519885     1.31713          1          9
       v1089 |      3,470    8.556772    1.213966          1          9
       v1090 |      3,470    8.609798    1.045749          1          9
       v1091 |      3,470    8.630548    .9712444          1          9
       v1092 |      3,470    8.658213    .8611671          1          9
-------------+---------------------------------------------------------
       v1093 |      3,470    8.667435    .8209951          1          9
       v1094 |      3,470    8.685879    .7337375          1          9
       v1095 |      3,470    8.614409    1.029695          1          9
       v1096 |      3,470    8.582133    1.136934          1          9
       v1097 |      3,470    8.565994    1.186596          1          9
-------------+---------------------------------------------------------
       v1098 |      3,470    8.510663    1.341523          1          9
       v1099 |      3,470    8.476081    1.428765          1          9
       v1100 |      3,470    8.443804    1.504921          1          9
       v1101 |      3,470    8.393084    1.616062          1          9
       v1102 |      3,470     8.37464    1.654241          1          9
-------------+---------------------------------------------------------
       v1103 |      3,470    8.342363     1.71854          1          9
       v1104 |      3,470     8.30317    1.792739          1          9
       v1105 |      3,470    8.282421    1.830464          1          9
       v1106 |      3,470    8.254755     1.87923          1          9
       v1107 |      3,470    8.227089    1.926365          1          9
-------------+---------------------------------------------------------
       v1108 |      3,470    8.185591    1.994261          1          9
       v1109 |      3,470    8.167147    2.023433          1          9
       v1110 |      3,470    8.153314    2.044929          1          9
       v1111 |      3,470    8.144092    2.059084          1          9
       v1112 |      3,470    8.141787    2.062601          1          9
-------------+---------------------------------------------------------
       v1113 |      3,470    8.160231    2.034221          1          9
       v1114 |      3,470    8.160231    2.034221          1          9
       v1115 |      3,470    8.169452    2.019818          1          9
       v1116 |      3,470    8.178674     2.00527          1          9
       v1117 |      3,470    8.169452    2.019818          1          9
-------------+---------------------------------------------------------
       v1118 |      3,470    8.160231    2.034221          1          9
       v1119 |      3,470    8.169452    2.019818          1          9
       v1120 |      3,470    8.178674     2.00527          1          9
       v1121 |      3,470    8.178674     2.00527          1          9
       v1122 |      3,470    8.174063    2.012563          1          9
-------------+---------------------------------------------------------
       v1123 |      3,470    8.176369    2.008921          1          9
       v1124 |      3,470    8.187896    1.990572          1          9
       v1125 |      3,470    8.178674     2.00527          1          9
       v1126 |      3,470    8.185591    1.994261          1          9
       v1127 |      3,470    8.190202    1.986874          1          9
-------------+---------------------------------------------------------
       v1128 |      3,470    8.190202    1.986874          1          9
       v1129 |      3,470    8.197118    1.975723          1          9
       v1130 |      3,470    8.217867    1.941735          1          9
       v1131 |      3,470    8.227089    1.926365          1          9
       v1132 |      3,470    8.240922    1.902994          1          9
-------------+---------------------------------------------------------
       v1133 |      3,470    8.261671    1.867197          1          9
       v1134 |      3,470    8.289337    1.818002          1          9
       v1135 |      3,470     8.30317    1.792739          1          9
       v1136 |      3,470    8.323919    1.753957          1          9
       v1137 |      3,470    8.330836    1.740783          1          9
-------------+---------------------------------------------------------
       v1138 |      3,470     8.35389    1.695927          1          9
       v1139 |      3,470    8.386167    1.630508          1          9
       v1140 |      3,470    8.429971    1.536196          1          9
       v1141 |      3,470    8.469164    1.445483          1          9
       v1142 |      3,470    8.499135    1.371318          1          9
-------------+---------------------------------------------------------
       v1143 |      3,470    8.529107     1.29221          1          9
       v1144 |      3,470    8.545245    1.247239          1          9
       v1145 |      3,470    8.579827    1.144174          1          9
       v1146 |      3,470    8.602882    1.069342          1          9
       v1147 |      3,470    8.621326    1.005093          1          9
-------------+---------------------------------------------------------
       v1148 |      3,470    8.725072    .4978242          1          9
       v1149 |      3,470    8.722767    .5147861          1          9
       v1150 |      3,470    8.720461    .5311966          1          9
       v1151 |      3,470     8.71585    .5625551          1          9
       v1152 |      3,470    8.711239    .5922196          1          9
-------------+---------------------------------------------------------
       v1153 |      3,470    8.708934    .6064948          1          9
       v1154 |      3,470    8.697406    .6732283          1          9
       v1155 |      3,470    8.695101    .6857729          1          9
       v1156 |      3,470    8.683573    .7452286          1          9
       v1157 |      3,470    8.674352    .7894551          1          9
-------------+---------------------------------------------------------
       v1158 |      3,470    8.672046    .8001132          1          9
       v1159 |      3,470     8.66513    .8312297          1          9
       v1160 |      3,470    8.660519    .8513112          1          9
       v1161 |      3,470    8.646686    .9087571          1          9
       v1162 |      3,470    8.648991    .8994524          1          9
-------------+---------------------------------------------------------
       v1163 |      3,470     8.64438    .9179617          1          9
       v1164 |      3,470    8.646686    .9087571          1          9
       v1165 |      3,470    8.648991    .8994524          1          9
       v1166 |      3,470    8.662824    .8413335          1          9
       v1167 |      3,470    8.662824    .8413335          1          9
-------------+---------------------------------------------------------
       v1168 |      3,470    8.655908    .8709054          1          9
       v1169 |      3,470    8.662824    .8413335          1          9
       v1170 |      3,470    8.662824    .8413335          1          9
       v1171 |      3,470    8.667435    .8209951          1          9
       v1172 |      3,470    8.674352    .7894551          1          9
-------------+---------------------------------------------------------
       v1173 |      3,470    8.688184    .7220562          1          9
       v1174 |      3,470     8.69049    .7101752          1          9
       v1175 |      3,470     8.69049    .7101752          1          9
       v1176 |      3,470    8.695101    .6857729          1          9
       v1177 |      3,470    8.692795    .6980845          1          9
-------------+---------------------------------------------------------
       v1178 |      3,470     8.69049    .7101752          1          9
       v1179 |      3,470    8.692795    .6980845          1          9
       v1180 |      3,470    8.702017    .6473856          1          9
       v1181 |      3,470    8.711239    .5922196          1          9
       v1182 |      3,470    8.713545    .5775824          1          9
-------------+---------------------------------------------------------
       v1183 |      3,470    8.718156    .5471054          1          9
       v1184 |      3,470     8.71585    .5625551          1          9
       v1185 |      3,470    8.718156    .5471054          1          9
       v1186 |      3,470    8.718156    .5471054          1          9
       v1187 |      3,470     8.71585    .5625551          1          9
-------------+---------------------------------------------------------
       v1188 |      3,470     8.71585    .5625551          1          9
       v1189 |      3,470    8.720461    .5311966          1          9
       v1190 |      3,470    8.727378    .4802526          1          9
       v1191 |      3,470    8.725072    .4978242          1          9
       v1192 |      3,470    8.722767    .5147861          1          9
-------------+---------------------------------------------------------
       v1193 |      3,470    8.722767    .5147861          1          9
       v1194 |      3,470    8.722767    .5147861          1          9
       v1195 |      3,470    8.722767    .5147861          1          9
       v1196 |      3,470    8.727378    .4802526          1          9
       v1197 |      3,470    8.727378    .4802526          1          9
-------------+---------------------------------------------------------
       v1198 |      3,470    8.727378    .4802526          1          9
       v1199 |      3,470    8.729683    .4620017          1          9
       v1200 |      3,470    8.729683    .4620017          1          9
       v1201 |      3,470    8.642075    .9270692          1          9
       v1202 |      3,470    8.614409    1.029695          1          9
-------------+---------------------------------------------------------
       v1203 |      3,470     8.59366    1.099944          1          9
       v1204 |      3,470    8.565994    1.186596          1          9
       v1205 |      3,470    8.536023    1.273156          1          9
       v1206 |      3,470    8.503746     1.35949          1          9
       v1207 |      3,470    8.457637    1.472852          1          9
-------------+---------------------------------------------------------
       v1208 |      3,470    8.420749    1.556628          1          9
       v1209 |      3,470    8.379251    1.644799          1          9
       v1210 |      3,470    8.340058    1.723018          1          9
       v1211 |      3,470    8.337752    1.727481          1          9
       v1212 |      3,470    8.335447    1.731929          1          9
-------------+---------------------------------------------------------
       v1213 |      3,470    8.333141    1.736363          1          9
       v1214 |      3,470    8.317003    1.767006          1          9
       v1215 |      3,470    8.314697    1.771328          1          9
       v1216 |      3,470    8.317003    1.767006          1          9
       v1217 |      3,470    8.314697    1.771328          1          9
-------------+---------------------------------------------------------
       v1218 |      3,470    8.326225     1.74958          1          9
       v1219 |      3,470    8.326225     1.74958          1          9
       v1220 |      3,470    8.340058    1.723018          1          9
       v1221 |      3,470    8.360807    1.682175          1          9
       v1222 |      3,470    8.376945    1.649528          1          9
-------------+---------------------------------------------------------
       v1223 |      3,470    8.388473     1.62571          1          9
       v1224 |      3,470    8.406916    1.586684          1          9
       v1225 |      3,470    8.418444    1.561686          1          9
       v1226 |      3,470    8.429971    1.536196          1          9
       v1227 |      3,470    8.432277    1.531036          1          9
-------------+---------------------------------------------------------
       v1228 |      3,470    8.448415    1.494322          1          9
       v1229 |      3,470    8.459942    1.467426          1          9
       v1230 |      3,470    8.457637    1.472852          1          9
       v1231 |      3,470    8.466859    1.451005          1          9
       v1232 |      3,470    8.476081    1.428765          1          9
-------------+---------------------------------------------------------
       v1233 |      3,470    8.478386    1.423142          1          9
       v1234 |      3,470    8.476081    1.428765          1          9
       v1235 |      3,470    8.482997    1.411816          1          9
       v1236 |      3,470    8.489914    1.394627          1          9
       v1237 |      3,470    8.499135    1.371318          1          9
-------------+---------------------------------------------------------
       v1238 |      3,470    8.519885     1.31713          1          9
       v1239 |      3,470    8.536023    1.273156          1          9
       v1240 |      3,470    8.533718    1.279543          1          9
       v1241 |      3,470    8.554467    1.220702          1          9
       v1242 |      3,470    8.565994    1.186596          1          9
-------------+---------------------------------------------------------
       v1243 |      3,470      8.5683    1.179643          1          9
       v1244 |      3,470      8.5683    1.179643          1          9
       v1245 |      3,470    8.589049    1.114901          1          9
       v1246 |      3,470    8.609798    1.045749          1          9
       v1247 |      3,470     8.61902    1.013365          1          9
-------------+---------------------------------------------------------
       v1248 |      3,470    8.623631    .9967463          1          9
       v1249 |      3,470    8.630548    .9712444          1          9
       v1250 |      3,470    8.632853    .9625826          1          9
       v1251 |      3,470    8.642075    .9270692          1          9
       v1252 |      3,470    8.648991    .8994524          1          9
-------------+---------------------------------------------------------
       v1253 |      3,470    8.662824    .8413335          1          9

. 
. ** variable list to be convert to matrix
. local matVarList `varList' dhead dearnmost $ExpList

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2010

. 
. 
. * 1. rename varname and make head dummy
. local renameList renameListPri renameListSpo

. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** rename variable of experience
.         dis " rename variable of experience "
  6.         global Resp_i `i'
  7.         global Age_t 18
  8. do "$Path\Code\Renamevar_Exp.do"
  9.         
.         if `i'==2{
 10.                 dis " replace id of spouse and drop not married "
 11.                 ** replace id (spouse)
.                 replace id = id+10000
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         sum id
 16.         
.         ** make household head dummy
.         dis " make household head dummy  "
 17.         *** Q = Are you head of household?
.         gen dhead=.
 18.         replace dhead=0 if head!=`i'
 19.         replace dhead=1 if head==`i'
 20.         label var dhead "HH head dummy"
 21.         tab head marital, sum(dhead) mean miss
 22.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 23.         replace earnmost=1 if dhead==1&earnif==2
 24.         replace dearnmost=1 if earnmost==`i'
 25.         replace dearnmost=0 if dearnmost!=1
 26.         label var dearnmost "Breadwinner dummy"
 27.         tab earnmost marital, sum(dearnmost) mean miss
 28.         
.         ** save variable as matrix
.         if `i'==1{
 29.                 local matName pri
 30.         }
 31.         else {
 32.                 local matName spo
 33.         }
 34.         mkmat `matVarList', matrix(`matName')
 35.         mat dir
 36.         
.         ** restore variable names
.         dis " restore variable names  "
 37.         rename ( `varList' ) ( ``currentRenameList'' )
 38.         drop dhead dearnmost
 39.         drop $ExpList
 40. }
 ** Rename variables of renameListPri 
 rename variable of experience 

. *******************************************************
. *Title: Renamevar_Exp
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables of working experience
. * 
. * 1. rename vars. of experience
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. * set list of variables
. ** of principal
. local casPri $CasPri

. local fullPri $FullPri

. local selfPri $SelfPri

. local sidePri $SidePri

. local fmwPri $FmwPri

. ** of spouse
. local casSpo $CasSpo

. local fullSpo $FullSpo

. local selfSpo $SelfSpo

. local sideSpo $SideSpo

. local fmwSpo $FmwSpo

. 
. * 1. rename vars. of experience
. local empStatus cas full self side fmw

. local num_m: word count `empStatus'

. local resp_i $Resp_i

. local age_t $Age_t

. 
. if `resp_i'==1{
.         local expVar casPri fullPri selfPri sidePri fmwPri
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. else {
.         local expVar casSpo fullSpo selfSpo sideSpo fmwSpo
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. sum $ExpList

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       cas18 |      3,470    8.624207    1.692911          1          9
       cas19 |      3,470     8.49049    1.953863          1          9
       cas20 |      3,470    8.455908    2.014416          1          9
       cas21 |      3,470    8.428242     2.06116          1          9
       cas22 |      3,470    8.430548    2.057319          1          9
-------------+---------------------------------------------------------
       cas23 |      3,470    8.405187     2.09904          1          9
       cas24 |      3,470    8.432853    2.053469          1          9
       cas25 |      3,470    8.425937    2.064991          1          9
       cas26 |      3,470    8.467435    1.994502          1          9
       cas27 |      3,470    8.543516    1.855933          1          9
-------------+---------------------------------------------------------
       cas28 |      3,470    8.525072     1.89074          1          9
       cas29 |      3,470    8.550432    1.842664          1          9
       cas30 |      3,470    8.545821    1.851523          1          9
       cas31 |      3,470    8.499712    1.937292          1          9
       cas32 |      3,470    8.508934    1.920533          1          9
-------------+---------------------------------------------------------
       cas33 |      3,470    8.492795    1.949737          1          9
       cas34 |      3,470    8.462824    2.002499          1          9
       cas35 |      3,470    8.423631    2.068812          1          9
       cas36 |      3,470     8.39366    2.117632          1          9
       cas37 |      3,470    8.372911    2.150536          1          9
-------------+---------------------------------------------------------
       cas38 |      3,470    8.356772    2.175648          1          9
       cas39 |      3,470    8.345245    2.193336          1          9
       cas40 |      3,470    8.319885    2.231547          1          9
       cas41 |      3,470    8.338329    2.203852          1          9
       cas42 |      3,470    8.324496     2.22467          1          9
-------------+---------------------------------------------------------
       cas43 |      3,470    8.336023    2.207341          1          9
       cas44 |      3,470    8.342939    2.196849          1          9
       cas45 |      3,470    8.359078    2.172086          1          9
       cas46 |      3,470    8.398271    2.110222          1          9
       cas47 |      3,470    8.414409    2.084001          1          9
-------------+---------------------------------------------------------
       cas48 |      3,470    8.412104    2.087775          1          9
       cas49 |      3,470    8.416715    2.080218          1          9
       cas50 |      3,470    8.435159    2.049609          1          9
       cas51 |      3,470    8.460519    2.006482          1          9
       cas52 |      3,470    8.492795    1.949737          1          9
-------------+---------------------------------------------------------
       cas53 |      3,470    8.527378    1.886434          1          9
       cas54 |      3,470     8.54121     1.86033          1          9
       cas55 |      3,470    8.566571     1.81122          1          9
       cas56 |      3,470    8.559654     1.82478          1          9
       cas57 |      3,470    8.571182    1.802109          1          9
-------------+---------------------------------------------------------
       cas58 |      3,470    8.596542    1.750934          1          9
       cas59 |      3,470    8.608069    1.727048          1          9
       cas60 |      3,470    8.610375    1.722222          1          9
       cas61 |      3,470    8.522767    1.895033          1          9
       cas62 |      3,470    8.566571     1.81122          1          9
-------------+---------------------------------------------------------
       cas63 |      3,470    8.633429     1.67302          1          9
       cas64 |      3,470    8.686455    1.552656          1          9
       cas65 |      3,470    8.725648    1.456075          1          9
       cas66 |      3,470    8.790202    1.278609          1          9
       cas67 |      3,470    8.836311    1.132734          1          9
-------------+---------------------------------------------------------
       cas68 |      3,470    8.884726     .953501          1          9
       cas69 |      3,470    8.905476    .8645672          1          9
       cas70 |      3,470    8.930836    .7407351          1          9
      full18 |      3,470    6.429395    3.736423          1          9
      full19 |      3,470    5.717003    3.935781          1          9
-------------+---------------------------------------------------------
      full20 |      3,470     5.38732    3.981778          1          9
      full21 |      3,470    4.834006     3.99713          1          9
      full22 |      3,470    4.414409    3.957474          1          9
      full23 |      3,470    3.985591    3.869792          1          9
      full24 |      3,470    4.054755     3.88727          1          9
-------------+---------------------------------------------------------
      full25 |      3,470    4.308357    3.940318          1          9
      full26 |      3,470    4.555043    3.975748          1          9
      full27 |      3,470     4.78098    3.994575          1          9
      full28 |      3,470    4.990778    4.000566          1          9
      full29 |      3,470    5.159078    3.997412          1          9
-------------+---------------------------------------------------------
      full30 |      3,470    5.299712    3.989331          1          9
      full31 |      3,470    5.456484     3.97444          1          9
      full32 |      3,470    5.530259    3.965269          1          9
      full33 |      3,470    5.634006    3.950004          1          9
      full34 |      3,470    5.721614    3.934938          1          9
-------------+---------------------------------------------------------
      full35 |      3,470    5.797695    3.920218          1          9
      full36 |      3,470    5.862248    3.906524          1          9
      full37 |      3,470    5.965994    3.882164          1          9
      full38 |      3,470    6.012104    3.870396          1          9
      full39 |      3,470    6.069741    3.854859          1          9
-------------+---------------------------------------------------------
      full40 |      3,470    6.173487    3.824545          1          9
      full41 |      3,470    6.251873    3.799602          1          9
      full42 |      3,470     6.33487    3.771236          1          9
      full43 |      3,470    6.385591    3.752892          1          9
      full44 |      3,470    6.459366    3.724815          1          9
-------------+---------------------------------------------------------
      full45 |      3,470    6.519308    3.700763          1          9
      full46 |      3,470    6.595389    3.668598          1          9
      full47 |      3,470    6.694524    3.623861          1          9
      full48 |      3,470    6.795965     3.57466          1          9
      full49 |      3,470    6.867435    3.537837          1          9
-------------+---------------------------------------------------------
      full50 |      3,470    6.959654    3.487587          1          9
      full51 |      3,470    7.074928    3.420241          1          9
      full52 |      3,470    7.137176    3.381682          1          9
      full53 |      3,470    7.234006    3.318492          1          9
      full54 |      3,470    7.319308    3.259428          1          9
-------------+---------------------------------------------------------
      full55 |      3,470    7.420749    3.184791          1          9
      full56 |      3,470    7.519885    3.106922          1          9
      full57 |      3,470    7.605187     3.03573          1          9
      full58 |      3,470    7.683573    2.966643          1          9
      full59 |      3,470    7.801153    2.855853          1          9
-------------+---------------------------------------------------------
      full60 |      3,470    7.918732    2.735537          1          9
      full61 |      3,470    8.430548    2.057319          1          9
      full62 |      3,470    8.552738    1.838213          1          9
      full63 |      3,470    8.665706    1.601043          1          9
      full64 |      3,470    8.739481    1.420162          1          9
-------------+---------------------------------------------------------
      full65 |      3,470    8.776369    1.318916          1          9
      full66 |      3,470     8.85245    1.076553          1          9
      full67 |      3,470    8.880115    .9720997          1          9
      full68 |      3,470    8.900865    .8851449          1          9
      full69 |      3,470    8.921614    .7881142          1          9
-------------+---------------------------------------------------------
      full70 |      3,470    8.940058    .6899877          1          9
      self18 |      3,470    8.850144    1.084772          1          9
      self19 |      3,470    8.817867     1.19344          1          9
      self20 |      3,470    8.790202    1.278609          1          9
      self21 |      3,470    8.744092    1.407958          1          9
-------------+---------------------------------------------------------
      self22 |      3,470     8.70951    1.496723          1          9
      self23 |      3,470    8.647262    1.642637          1          9
      self24 |      3,470    8.580403    1.783712          1          9
      self25 |      3,470    8.527378    1.886434          1          9
      self26 |      3,470    8.495101      1.9456          1          9
-------------+---------------------------------------------------------
      self27 |      3,470    8.469741    1.990488          1          9
      self28 |      3,470    8.458213    2.010454          1          9
      self29 |      3,470    8.412104    2.087775          1          9
      self30 |      3,470    8.386744    2.128679          1          9
      self31 |      3,470    8.352161    2.182748          1          9
-------------+---------------------------------------------------------
      self32 |      3,470    8.349856    2.186285          1          9
      self33 |      3,470    8.315274    2.238393          1          9
      self34 |      3,470    8.299135    2.262118          1          9
      self35 |      3,470    8.285303    2.282167          1          9
      self36 |      3,470     8.27147    2.301958          1          9
-------------+---------------------------------------------------------
      self37 |      3,470    8.280692    2.288793          1          9
      self38 |      3,470    8.278386    2.292095          1          9
      self39 |      3,470    8.280692    2.288793          1          9
      self40 |      3,470    8.278386    2.292095          1          9
      self41 |      3,470    8.289914    2.275513          1          9
-------------+---------------------------------------------------------
      self42 |      3,470    8.299135    2.262118          1          9
      self43 |      3,470     8.29683    2.265478          1          9
      self44 |      3,470    8.282997    2.285484          1          9
      self45 |      3,470    8.299135    2.262118          1          9
      self46 |      3,470    8.303746    2.255377          1          9
-------------+---------------------------------------------------------
      self47 |      3,470    8.310663    2.245209          1          9
      self48 |      3,470    8.315274    2.238393          1          9
      self49 |      3,470    8.326801    2.221219          1          9
      self50 |      3,470    8.324496     2.22467          1          9
      self51 |      3,470    8.342939    2.196849          1          9
-------------+---------------------------------------------------------
      self52 |      3,470    8.352161    2.182748          1          9
      self53 |      3,470    8.370605    2.154149          1          9
      self54 |      3,470    8.391354    2.121323          1          9
      self55 |      3,470    8.405187     2.09904          1          9
      self56 |      3,470    8.435159    2.049609          1          9
-------------+---------------------------------------------------------
      self57 |      3,470    8.467435    1.994502          1          9
      self58 |      3,470     8.49049    1.953863          1          9
      self59 |      3,470    8.513545    1.912082          1          9
      self60 |      3,470    8.531988    1.877784          1          9
      self61 |      3,470    8.555043    1.833749          1          9
-------------+---------------------------------------------------------
      self62 |      3,470    8.589625    1.765074          1          9
      self63 |      3,470    8.651873    1.632357          1          9
      self64 |      3,470     8.68415     1.55812          1          9
      self65 |      3,470    8.702594    1.513757          1          9
      self66 |      3,470    8.760231    1.364259          1          9
-------------+---------------------------------------------------------
      self67 |      3,470    8.799424    1.250932          1          9
      self68 |      3,470    8.810951    1.215351          1          9
      self69 |      3,470    8.836311    1.132734          1          9
      self70 |      3,470    8.854755    1.068266          1          9
      side18 |      3,470    8.986167    .3324204          1          9
-------------+---------------------------------------------------------
      side19 |      3,470    8.986167    .3324204          1          9
      side20 |      3,470    8.983862    .3590032          1          9
      side21 |      3,470     8.97464    .4497744          1          9
      side22 |      3,470    8.956196    .5904354          1          9
      side23 |      3,470    8.944669    .6631112          1          9
-------------+---------------------------------------------------------
      side24 |      3,470    8.933141    .7283908          1          9
      side25 |      3,470     8.92853    .7528701          1          9
      side26 |      3,470    8.912392    .8326999          1          9
      side27 |      3,470     8.90317    .8749196          1          9
      side28 |      3,470    8.884726     .953501          1          9
-------------+---------------------------------------------------------
      side29 |      3,470    8.859366    1.051481          1          9
      side30 |      3,470    8.857061    1.059909          1          9
      side31 |      3,470    8.840922    1.116994          1          9
      side32 |      3,470    8.843228    1.109034          1          9
      side33 |      3,470    8.840922    1.116994          1          9
-------------+---------------------------------------------------------
      side34 |      3,470    8.850144    1.084772          1          9
      side35 |      3,470    8.859366    1.051481          1          9
      side36 |      3,470    8.870893    1.008205          1          9
      side37 |      3,470    8.891643    .9248589          1          9
      side38 |      3,470    8.898559    .8952475          1          9
-------------+---------------------------------------------------------
      side39 |      3,470    8.905476    .8645672          1          9
      side40 |      3,470    8.905476    .8645672          1          9
      side41 |      3,470    8.905476    .8645672          1          9
      side42 |      3,470    8.900865    .8851449          1          9
      side43 |      3,470    8.910086    .8434625          1          9
-------------+---------------------------------------------------------
      side44 |      3,470    8.910086    .8434625          1          9
      side45 |      3,470    8.914697      .82179          1          9
      side46 |      3,470    8.912392    .8326999          1          9
      side47 |      3,470    8.914697      .82179          1          9
      side48 |      3,470    8.914697      .82179          1          9
-------------+---------------------------------------------------------
      side49 |      3,470    8.923919    .7765507          1          9
      side50 |      3,470    8.930836    .7407351          1          9
      side51 |      3,470    8.933141    .7283908          1          9
      side52 |      3,470    8.933141    .7283908          1          9
      side53 |      3,470    8.940058    .6899877          1          9
-------------+---------------------------------------------------------
      side54 |      3,470    8.944669    .6631112          1          9
      side55 |      3,470    8.942363    .6766868          1          9
      side56 |      3,470     8.94928    .6350648          1          9
      side57 |      3,470     8.95389    .6056862          1          9
      side58 |      3,470     8.95389    .6056862          1          9
-------------+---------------------------------------------------------
      side59 |      3,470     8.95389    .6056862          1          9
      side60 |      3,470    8.960807    .5586578          1          9
      side61 |      3,470    8.970029    .4888149          1          9
      side62 |      3,470    8.967723    .5071939          1          9
      side63 |      3,470    8.967723    .5071939          1          9
-------------+---------------------------------------------------------
      side64 |      3,470    8.967723    .5071939          1          9
      side65 |      3,470    8.965418    .5249196          1          9
      side66 |      3,470    8.970029    .4888149          1          9
      side67 |      3,470     8.97464    .4497744          1          9
      side68 |      3,470     8.97464    .4497744          1          9
-------------+---------------------------------------------------------
      side69 |      3,470    8.979251    .4069538          1          9
      side70 |      3,470    8.981556    .3837352          1          9
       fmw18 |      3,470    8.870893    1.008205          1          9
       fmw19 |      3,470    8.829395    1.155907          1          9
       fmw20 |      3,470    8.794813    1.264855          1          9
-------------+---------------------------------------------------------
       fmw21 |      3,470    8.746398     1.40181          1          9
       fmw22 |      3,470    8.707205    1.502426          1          9
       fmw23 |      3,470    8.633429     1.67302          1          9
       fmw24 |      3,470    8.580403    1.783712          1          9
       fmw25 |      3,470    8.548127      1.8471          1          9
-------------+---------------------------------------------------------
       fmw26 |      3,470    8.534294     1.87344          1          9
       fmw27 |      3,470     8.51585    1.907838          1          9
       fmw28 |      3,470    8.497406    1.941452          1          9
       fmw29 |      3,470    8.488184    1.957977          1          9
       fmw30 |      3,470     8.49049    1.953863          1          9
-------------+---------------------------------------------------------
       fmw31 |      3,470    8.511239    1.916314          1          9
       fmw32 |      3,470    8.497406    1.941452          1          9
       fmw33 |      3,470    8.511239    1.916314          1          9
       fmw34 |      3,470    8.522767    1.895033          1          9
       fmw35 |      3,470    8.531988    1.877784          1          9
-------------+---------------------------------------------------------
       fmw36 |      3,470    8.555043    1.833749          1          9
       fmw37 |      3,470    8.568876    1.806672          1          9
       fmw38 |      3,470    8.566571     1.81122          1          9
       fmw39 |      3,470    8.578098    1.788333          1          9
       fmw40 |      3,470    8.603458    1.736651          1          9
-------------+---------------------------------------------------------
       fmw41 |      3,470    8.617291    1.707643          1          9
       fmw42 |      3,470    8.640346    1.657913          1          9
       fmw43 |      3,470    8.656484    1.621999          1          9
       fmw44 |      3,470    8.663401    1.606312          1          9
       fmw45 |      3,470    8.665706    1.601043          1          9
-------------+---------------------------------------------------------
       fmw46 |      3,470    8.670317    1.590441          1          9
       fmw47 |      3,470    8.677233    1.574379          1          9
       fmw48 |      3,470    8.691066     1.54166          1          9
       fmw49 |      3,470    8.700288    1.519386          1          9
       fmw50 |      3,470     8.70951    1.496723          1          9
-------------+---------------------------------------------------------
       fmw51 |      3,470    8.725648    1.456075          1          9
       fmw52 |      3,470    8.732565    1.438247          1          9
       fmw53 |      3,470    8.748703    1.395631          1          9
       fmw54 |      3,470     8.75562    1.376905          1          9
       fmw55 |      3,470    8.767147    1.345037          1          9
-------------+---------------------------------------------------------
       fmw56 |      3,470     8.78098    1.305635          1          9
       fmw57 |      3,470    8.787896    1.285425          1          9
       fmw58 |      3,470    8.792507    1.271753          1          9
       fmw59 |      3,470    8.797118    1.257915          1          9
       fmw60 |      3,470    8.808646    1.222559          1          9
-------------+---------------------------------------------------------
       fmw61 |      3,470    8.815562    1.200792          1          9
       fmw62 |      3,470    8.834006    1.140515          1          9
       fmw63 |      3,470    8.857061    1.059909          1          9
       fmw64 |      3,470    8.870893    1.008205          1          9
       fmw65 |      3,470    8.880115    .9720997          1          9
-------------+---------------------------------------------------------
       fmw66 |      3,470    8.898559    .8952475          1          9
       fmw67 |      3,470    8.907781    .8540832          1          9
       fmw68 |      3,470    8.919308    .7995037          1          9
       fmw69 |      3,470    8.935447    .7158261          1          9
       fmw70 |      3,470    8.942363    .6766868          1          9

. 
end of do-file

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,470    2595.789     1720.81          1       6092
 make household head dummy  
(3,470 missing values generated)
(1,683 real changes made)
(1,787 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .52401575  .49032258 | .51498559
(3,470 missing values generated)
(1,558 real changes made)
(1,677 real changes made)
(1,793 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          0 |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .49094488  .46236559 |  .4832853
          pri[3470,293]
 restore variable names  
 ** Rename variables of renameListSpo 
 rename variable of experience 

. *******************************************************
. *Title: Renamevar_Exp
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables of working experience
. * 
. * 1. rename vars. of experience
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. * set list of variables
. ** of principal
. local casPri $CasPri

. local fullPri $FullPri

. local selfPri $SelfPri

. local sidePri $SidePri

. local fmwPri $FmwPri

. ** of spouse
. local casSpo $CasSpo

. local fullSpo $FullSpo

. local selfSpo $SelfSpo

. local sideSpo $SideSpo

. local fmwSpo $FmwSpo

. 
. * 1. rename vars. of experience
. local empStatus cas full self side fmw

. local num_m: word count `empStatus'

. local resp_i $Resp_i

. local age_t $Age_t

. 
. if `resp_i'==1{
.         local expVar casPri fullPri selfPri sidePri fmwPri
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. else {
.         local expVar casSpo fullSpo selfSpo sideSpo fmwSpo
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. sum $ExpList

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       cas18 |      3,470    8.549856    1.234051          1          9
       cas19 |      3,470    8.489914    1.394627          1          9
       cas20 |      3,470    8.487608    1.400384          1          9
       cas21 |      3,470     8.42536    1.546453          1          9
       cas22 |      3,470    8.388473     1.62571          1          9
-------------+---------------------------------------------------------
       cas23 |      3,470    8.370029    1.663617          1          9
       cas24 |      3,470    8.393084    1.616062          1          9
       cas25 |      3,470    8.344669    1.714047          1          9
       cas26 |      3,470    8.404611    1.591626          1          9
       cas27 |      3,470    8.416138    1.566724          1          9
-------------+---------------------------------------------------------
       cas28 |      3,470    8.427666    1.541334          1          9
       cas29 |      3,470    8.404611    1.591626          1          9
       cas30 |      3,470    8.409222    1.581723          1          9
       cas31 |      3,470    8.395389    1.611211          1          9
       cas32 |      3,470    8.367723    1.668281          1          9
-------------+---------------------------------------------------------
       cas33 |      3,470    8.346974     1.70954          1          9
       cas34 |      3,470    8.330836    1.740783          1          9
       cas35 |      3,470    8.273199    1.846909          1          9
       cas36 |      3,470     8.27781    1.838711          1          9
       cas37 |      3,470    8.268588    1.855059          1          9
-------------+---------------------------------------------------------
       cas38 |      3,470    8.222478    1.934071          1          9
       cas39 |      3,470     8.20634    1.960717          1          9
       cas40 |      3,470     8.20634    1.960717          1          9
       cas41 |      3,470     8.20634    1.960717          1          9
       cas42 |      3,470    8.185591    1.994261          1          9
-------------+---------------------------------------------------------
       cas43 |      3,470     8.20634    1.960717          1          9
       cas44 |      3,470    8.199424    1.971986          1          9
       cas45 |      3,470    8.210951    1.953154          1          9
       cas46 |      3,470    8.238617    1.906916          1          9
       cas47 |      3,470    8.266282    1.859117          1          9
-------------+---------------------------------------------------------
       cas48 |      3,470    8.282421    1.830464          1          9
       cas49 |      3,470     8.30317    1.792739          1          9
       cas50 |      3,470    8.340058    1.723018          1          9
       cas51 |      3,470    8.367723    1.668281          1          9
       cas52 |      3,470    8.411527    1.576742          1          9
-------------+---------------------------------------------------------
       cas53 |      3,470    8.420749    1.556628          1          9
       cas54 |      3,470    8.439193    1.515431          1          9
       cas55 |      3,470    8.429971    1.536196          1          9
       cas56 |      3,470    8.462248    1.461976          1          9
       cas57 |      3,470    8.489914    1.394627          1          9
-------------+---------------------------------------------------------
       cas58 |      3,470    8.487608    1.400384          1          9
       cas59 |      3,470    8.503746     1.35949          1          9
       cas60 |      3,470    8.510663    1.341523          1          9
       cas61 |      3,470    8.432277    1.531036          1          9
       cas62 |      3,470    8.462248    1.461976          1          9
-------------+---------------------------------------------------------
       cas63 |      3,470    8.512968    1.335473          1          9
       cas64 |      3,470    8.572911    1.165599          1          9
       cas65 |      3,470    8.575216    1.158506          1          9
       cas66 |      3,470    8.598271     1.08476          1          9
       cas67 |      3,470    8.628242    .9798242          1          9
-------------+---------------------------------------------------------
       cas68 |      3,470     8.66513    .8312297          1          9
       cas69 |      3,470    8.678963    .7676743          1          9
       cas70 |      3,470    8.685879    .7337375          1          9
      full18 |      3,470    6.760807    3.320641          1          9
      full19 |      3,470    6.209798    3.558645          1          9
-------------+---------------------------------------------------------
      full20 |      3,470    5.898559    3.649705          1          9
      full21 |      3,470    5.437464     3.73317          1          9
      full22 |      3,470    5.202305    3.753272          1          9
      full23 |      3,470    4.798847    3.753334          1          9
      full24 |      3,470    4.844957    3.755522          1          9
-------------+---------------------------------------------------------
      full25 |      3,470    5.020173    3.758668          1          9
      full26 |      3,470    5.206916    3.753021          1          9
      full27 |      3,470    5.338329     3.74346          1          9
      full28 |      3,470     5.49049    3.726572          1          9
      full29 |      3,470     5.61268    3.708437          1          9
-------------+---------------------------------------------------------
      full30 |      3,470    5.702594    3.692453          1          9
      full31 |      3,470    5.810951    3.670172          1          9
      full32 |      3,470    5.926225    3.642781          1          9
      full33 |      3,470    5.967723    3.631974          1          9
      full34 |      3,470     6.04611     3.61017          1          9
-------------+---------------------------------------------------------
      full35 |      3,470    6.106052    3.592254          1          9
      full36 |      3,470      6.1683    3.572488          1          9
      full37 |      3,470    6.228242     3.55232          1          9
      full38 |      3,470    6.292795    3.529333          1          9
      full39 |      3,470    6.336599    3.512973          1          9
-------------+---------------------------------------------------------
      full40 |      3,470    6.401153    3.487721          1          9
      full41 |      3,470    6.470317    3.459124          1          9
      full42 |      3,470    6.539481    3.428893          1          9
      full43 |      3,470    6.601729    3.400252          1          9
      full44 |      3,470    6.673199    3.365648          1          9
-------------+---------------------------------------------------------
      full45 |      3,470    6.710086    3.347051          1          9
      full46 |      3,470    6.763112    3.319417          1          9
      full47 |      3,470    6.829971    3.283022          1          9
      full48 |      3,470    6.910663    3.236712          1          9
      full49 |      3,470    6.975216    3.197716          1          9
-------------+---------------------------------------------------------
      full50 |      3,470    7.025937    3.165816          1          9
      full51 |      3,470    7.138905    3.090592          1          9
      full52 |      3,470    7.208069    3.041548          1          9
      full53 |      3,470    7.297983     2.97418          1          9
      full54 |      3,470    7.367147    2.919416          1          9
-------------+---------------------------------------------------------
      full55 |      3,470    7.434006    2.863896          1          9
      full56 |      3,470     7.52853     2.78077          1          9
      full57 |      3,470    7.588473    2.725045          1          9
      full58 |      3,470     7.67147    2.643706          1          9
      full59 |      3,470    7.777522    2.532023          1          9
-------------+---------------------------------------------------------
      full60 |      3,470    7.860519     2.43784          1          9
      full61 |      3,470    8.312392    1.775637          1          9
      full62 |      3,470     8.37464    1.654241          1          9
      full63 |      3,470    8.466859    1.451005          1          9
      full64 |      3,470    8.519885     1.31713          1          9
-------------+---------------------------------------------------------
      full65 |      3,470    8.556772    1.213966          1          9
      full66 |      3,470    8.609798    1.045749          1          9
      full67 |      3,470    8.630548    .9712444          1          9
      full68 |      3,470    8.658213    .8611671          1          9
      full69 |      3,470    8.667435    .8209951          1          9
-------------+---------------------------------------------------------
      full70 |      3,470    8.685879    .7337375          1          9
      self18 |      3,470    8.614409    1.029695          1          9
      self19 |      3,470    8.582133    1.136934          1          9
      self20 |      3,470    8.565994    1.186596          1          9
      self21 |      3,470    8.510663    1.341523          1          9
-------------+---------------------------------------------------------
      self22 |      3,470    8.476081    1.428765          1          9
      self23 |      3,470    8.443804    1.504921          1          9
      self24 |      3,470    8.393084    1.616062          1          9
      self25 |      3,470     8.37464    1.654241          1          9
      self26 |      3,470    8.342363     1.71854          1          9
-------------+---------------------------------------------------------
      self27 |      3,470     8.30317    1.792739          1          9
      self28 |      3,470    8.282421    1.830464          1          9
      self29 |      3,470    8.254755     1.87923          1          9
      self30 |      3,470    8.227089    1.926365          1          9
      self31 |      3,470    8.185591    1.994261          1          9
-------------+---------------------------------------------------------
      self32 |      3,470    8.167147    2.023433          1          9
      self33 |      3,470    8.153314    2.044929          1          9
      self34 |      3,470    8.144092    2.059084          1          9
      self35 |      3,470    8.141787    2.062601          1          9
      self36 |      3,470    8.160231    2.034221          1          9
-------------+---------------------------------------------------------
      self37 |      3,470    8.160231    2.034221          1          9
      self38 |      3,470    8.169452    2.019818          1          9
      self39 |      3,470    8.178674     2.00527          1          9
      self40 |      3,470    8.169452    2.019818          1          9
      self41 |      3,470    8.160231    2.034221          1          9
-------------+---------------------------------------------------------
      self42 |      3,470    8.169452    2.019818          1          9
      self43 |      3,470    8.178674     2.00527          1          9
      self44 |      3,470    8.178674     2.00527          1          9
      self45 |      3,470    8.174063    2.012563          1          9
      self46 |      3,470    8.176369    2.008921          1          9
-------------+---------------------------------------------------------
      self47 |      3,470    8.187896    1.990572          1          9
      self48 |      3,470    8.178674     2.00527          1          9
      self49 |      3,470    8.185591    1.994261          1          9
      self50 |      3,470    8.190202    1.986874          1          9
      self51 |      3,470    8.190202    1.986874          1          9
-------------+---------------------------------------------------------
      self52 |      3,470    8.197118    1.975723          1          9
      self53 |      3,470    8.217867    1.941735          1          9
      self54 |      3,470    8.227089    1.926365          1          9
      self55 |      3,470    8.240922    1.902994          1          9
      self56 |      3,470    8.261671    1.867197          1          9
-------------+---------------------------------------------------------
      self57 |      3,470    8.289337    1.818002          1          9
      self58 |      3,470     8.30317    1.792739          1          9
      self59 |      3,470    8.323919    1.753957          1          9
      self60 |      3,470    8.330836    1.740783          1          9
      self61 |      3,470     8.35389    1.695927          1          9
-------------+---------------------------------------------------------
      self62 |      3,470    8.386167    1.630508          1          9
      self63 |      3,470    8.429971    1.536196          1          9
      self64 |      3,470    8.469164    1.445483          1          9
      self65 |      3,470    8.499135    1.371318          1          9
      self66 |      3,470    8.529107     1.29221          1          9
-------------+---------------------------------------------------------
      self67 |      3,470    8.545245    1.247239          1          9
      self68 |      3,470    8.579827    1.144174          1          9
      self69 |      3,470    8.602882    1.069342          1          9
      self70 |      3,470    8.621326    1.005093          1          9
      side18 |      3,470    8.725072    .4978242          1          9
-------------+---------------------------------------------------------
      side19 |      3,470    8.722767    .5147861          1          9
      side20 |      3,470    8.720461    .5311966          1          9
      side21 |      3,470     8.71585    .5625551          1          9
      side22 |      3,470    8.711239    .5922196          1          9
      side23 |      3,470    8.708934    .6064948          1          9
-------------+---------------------------------------------------------
      side24 |      3,470    8.697406    .6732283          1          9
      side25 |      3,470    8.695101    .6857729          1          9
      side26 |      3,470    8.683573    .7452286          1          9
      side27 |      3,470    8.674352    .7894551          1          9
      side28 |      3,470    8.672046    .8001132          1          9
-------------+---------------------------------------------------------
      side29 |      3,470     8.66513    .8312297          1          9
      side30 |      3,470    8.660519    .8513112          1          9
      side31 |      3,470    8.646686    .9087571          1          9
      side32 |      3,470    8.648991    .8994524          1          9
      side33 |      3,470     8.64438    .9179617          1          9
-------------+---------------------------------------------------------
      side34 |      3,470    8.646686    .9087571          1          9
      side35 |      3,470    8.648991    .8994524          1          9
      side36 |      3,470    8.662824    .8413335          1          9
      side37 |      3,470    8.662824    .8413335          1          9
      side38 |      3,470    8.655908    .8709054          1          9
-------------+---------------------------------------------------------
      side39 |      3,470    8.662824    .8413335          1          9
      side40 |      3,470    8.662824    .8413335          1          9
      side41 |      3,470    8.667435    .8209951          1          9
      side42 |      3,470    8.674352    .7894551          1          9
      side43 |      3,470    8.688184    .7220562          1          9
-------------+---------------------------------------------------------
      side44 |      3,470     8.69049    .7101752          1          9
      side45 |      3,470     8.69049    .7101752          1          9
      side46 |      3,470    8.695101    .6857729          1          9
      side47 |      3,470    8.692795    .6980845          1          9
      side48 |      3,470     8.69049    .7101752          1          9
-------------+---------------------------------------------------------
      side49 |      3,470    8.692795    .6980845          1          9
      side50 |      3,470    8.702017    .6473856          1          9
      side51 |      3,470    8.711239    .5922196          1          9
      side52 |      3,470    8.713545    .5775824          1          9
      side53 |      3,470    8.718156    .5471054          1          9
-------------+---------------------------------------------------------
      side54 |      3,470     8.71585    .5625551          1          9
      side55 |      3,470    8.718156    .5471054          1          9
      side56 |      3,470    8.718156    .5471054          1          9
      side57 |      3,470     8.71585    .5625551          1          9
      side58 |      3,470     8.71585    .5625551          1          9
-------------+---------------------------------------------------------
      side59 |      3,470    8.720461    .5311966          1          9
      side60 |      3,470    8.727378    .4802526          1          9
      side61 |      3,470    8.725072    .4978242          1          9
      side62 |      3,470    8.722767    .5147861          1          9
      side63 |      3,470    8.722767    .5147861          1          9
-------------+---------------------------------------------------------
      side64 |      3,470    8.722767    .5147861          1          9
      side65 |      3,470    8.722767    .5147861          1          9
      side66 |      3,470    8.727378    .4802526          1          9
      side67 |      3,470    8.727378    .4802526          1          9
      side68 |      3,470    8.727378    .4802526          1          9
-------------+---------------------------------------------------------
      side69 |      3,470    8.729683    .4620017          1          9
      side70 |      3,470    8.729683    .4620017          1          9
       fmw18 |      3,470    8.642075    .9270692          1          9
       fmw19 |      3,470    8.614409    1.029695          1          9
       fmw20 |      3,470     8.59366    1.099944          1          9
-------------+---------------------------------------------------------
       fmw21 |      3,470    8.565994    1.186596          1          9
       fmw22 |      3,470    8.536023    1.273156          1          9
       fmw23 |      3,470    8.503746     1.35949          1          9
       fmw24 |      3,470    8.457637    1.472852          1          9
       fmw25 |      3,470    8.420749    1.556628          1          9
-------------+---------------------------------------------------------
       fmw26 |      3,470    8.379251    1.644799          1          9
       fmw27 |      3,470    8.340058    1.723018          1          9
       fmw28 |      3,470    8.337752    1.727481          1          9
       fmw29 |      3,470    8.335447    1.731929          1          9
       fmw30 |      3,470    8.333141    1.736363          1          9
-------------+---------------------------------------------------------
       fmw31 |      3,470    8.317003    1.767006          1          9
       fmw32 |      3,470    8.314697    1.771328          1          9
       fmw33 |      3,470    8.317003    1.767006          1          9
       fmw34 |      3,470    8.314697    1.771328          1          9
       fmw35 |      3,470    8.326225     1.74958          1          9
-------------+---------------------------------------------------------
       fmw36 |      3,470    8.326225     1.74958          1          9
       fmw37 |      3,470    8.340058    1.723018          1          9
       fmw38 |      3,470    8.360807    1.682175          1          9
       fmw39 |      3,470    8.376945    1.649528          1          9
       fmw40 |      3,470    8.388473     1.62571          1          9
-------------+---------------------------------------------------------
       fmw41 |      3,470    8.406916    1.586684          1          9
       fmw42 |      3,470    8.418444    1.561686          1          9
       fmw43 |      3,470    8.429971    1.536196          1          9
       fmw44 |      3,470    8.432277    1.531036          1          9
       fmw45 |      3,470    8.448415    1.494322          1          9
-------------+---------------------------------------------------------
       fmw46 |      3,470    8.459942    1.467426          1          9
       fmw47 |      3,470    8.457637    1.472852          1          9
       fmw48 |      3,470    8.466859    1.451005          1          9
       fmw49 |      3,470    8.476081    1.428765          1          9
       fmw50 |      3,470    8.478386    1.423142          1          9
-------------+---------------------------------------------------------
       fmw51 |      3,470    8.476081    1.428765          1          9
       fmw52 |      3,470    8.482997    1.411816          1          9
       fmw53 |      3,470    8.489914    1.394627          1          9
       fmw54 |      3,470    8.499135    1.371318          1          9
       fmw55 |      3,470    8.519885     1.31713          1          9
-------------+---------------------------------------------------------
       fmw56 |      3,470    8.536023    1.273156          1          9
       fmw57 |      3,470    8.533718    1.279543          1          9
       fmw58 |      3,470    8.554467    1.220702          1          9
       fmw59 |      3,470    8.565994    1.186596          1          9
       fmw60 |      3,470      8.5683    1.179643          1          9
-------------+---------------------------------------------------------
       fmw61 |      3,470      8.5683    1.179643          1          9
       fmw62 |      3,470    8.589049    1.114901          1          9
       fmw63 |      3,470    8.609798    1.045749          1          9
       fmw64 |      3,470     8.61902    1.013365          1          9
       fmw65 |      3,470    8.623631    .9967463          1          9
-------------+---------------------------------------------------------
       fmw66 |      3,470    8.630548    .9712444          1          9
       fmw67 |      3,470    8.632853    .9625826          1          9
       fmw68 |      3,470    8.642075    .9270692          1          9
       fmw69 |      3,470    8.648991    .8994524          1          9
       fmw70 |      3,470    8.662824    .8413335          1          9

. 
end of do-file
 replace id of spouse and drop not married 
(3,470 real changes made)
(930 observations deleted)
  2,540

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,540    11814.66    1247.587      10001      16092
 make household head dummy  
(2,540 missing values generated)
(1,456 real changes made)
(1,084 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .42677165 | .42677165
(2,540 missing values generated)
(943 real changes made)
(73 real changes made)
(2,467 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .02874016 | .02874016
          spo[2540,293]
          pri[3470,293]
 restore variable names  

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[6010,293]
          spo[2540,293]
          pri[3470,293]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 6010
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 6,010

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2010.dta saved

. mat drop _all

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,978       49.55       49.55
          2 |      3,032       50.45      100.00
------------+-----------------------------------
      Total |      6,010      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      6,010        2010           0       2010       2010

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2010m1

. disp %tm r(max)
 2010m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 2 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 4 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      6,008     1957.31    15.28252       1917       1989

. gen bym=ym(byear, bmonth)
(4 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1917m9

. disp %tm r(max)
 1989m3

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(4 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           22             20
 5%           26             21
10%           31             21       Obs               6,006
25%           39             21       Sum of Wgt.       6,006

50%           52                      Mean            51.7962
                        Largest       Std. Dev.      15.29614
75%           64             87
90%           72             88       Variance       233.9718
95%           75             89       Skewness      -.0904217
99%           81             92       Kurtosis       2.044687

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
 recode missing value (9) to 0 for each employment status 
.         qui forvalues status_j = 1/`num_m'{
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
.         qui forvalues x=`age_t'/65{
.         sum we*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        we18 |      6,010    .4033278    .4906063          0          1
        we19 |      6,010    .5163062    .4997756          0          1
        we20 |      6,010    .5730449    .4946768          0          1
        we21 |      6,010     .666223    .4716004          0          1
        we22 |      6,010    .7252912    .4464046          0          1
-------------+---------------------------------------------------------
        we23 |      6,010    .8039933    .3970066          0          1
        we24 |      6,010    .8084859    .3935254          0          1
        we25 |      6,010    .7921797    .4057812          0          1
        we26 |      6,010    .7655574    .4236852          0          1
        we27 |      6,010     .743594    .4366849          0          1
-------------+---------------------------------------------------------
        we28 |      6,010    .7236273    .4472406          0          1
        we29 |      6,010    .7123128    .4527222          0          1
        we30 |      6,010    .6993344    .4585856          0          1
        we31 |      6,010    .6916805    .4618377          0          1
        we32 |      6,010    .6816972    .4658565          0          1
-------------+---------------------------------------------------------
        we33 |      6,010    .6750416    .4683983          0          1
        we34 |      6,010    .6678869    .4710105          0          1
        we35 |      6,010    .6637271    .4724728          0          1
        we36 |      6,010    .6530782    .4760302          0          1
        we37 |      6,010    .6399334    .4800593          0          1
-------------+---------------------------------------------------------
        we38 |      6,010    .6334443    .4819038          0          1
        we39 |      6,010    .6252912    .4840879          0          1
        we40 |      6,010    .6131448    .4870706          0          1
        we41 |      6,010    .5988353     .490175          0          1
        we42 |      6,010    .5861897    .4925563          0          1
-------------+---------------------------------------------------------
        we43 |      6,010    .5720466    .4948232          0          1
        we44 |      6,010    .5612313    .4962779          0          1
        we45 |      6,010    .5502496      .49751          0          1
        we46 |      6,010    .5344426    .4988538          0          1
        we47 |      6,010    .5173045     .499742          0          1
-------------+---------------------------------------------------------
        we48 |      6,010    .5014975    .5000394          0          1
        we49 |      6,010    .4863561    .4998554          0          1
        we50 |      6,010    .4703827    .4991636          0          1
        we51 |      6,010    .4469218    .4972161          0          1
        we52 |      6,010    .4292845    .4950152          0          1
-------------+---------------------------------------------------------
        we53 |      6,010    .4079867    .4915015          0          1
        we54 |      6,010    .3908486    .4879811          0          1
        we55 |      6,010    .3732113    .4836978          0          1
        we56 |      6,010    .3515807    .4775036          0          1
        we57 |      6,010    .3331115    .4713652          0          1
-------------+---------------------------------------------------------
        we58 |      6,010    .3153078     .464677          0          1
        we59 |      6,010     .293178    .4552572          0          1
        we60 |      6,010    .2738769    .4459837          0          1
        we61 |      6,010    .2129784    .4094466          0          1
        we62 |      6,010    .1873544    .3902282          0          1
-------------+---------------------------------------------------------
        we63 |      6,010     .153411    .3604132          0          1
        we64 |      6,010    .1296173    .3359099          0          1
        we65 |      6,010    .1166389    .3210163          0          1
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de

                           workexp
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            2              0
10%            5              0       Obs               6,010
25%           13              0       Sum of Wgt.       6,010

50%           25                      Mean           25.27205
                        Largest       Std. Dev.      14.58973
75%           39             48
90%           45             48       Variance       212.8601
95%           47             48       Skewness      -.0408142
99%           48             48       Kurtosis       1.747317
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
.         sum workexp
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(6,010 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2010.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2011

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2011

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/JHPS2011.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(684 vars, 3,160 obs)

. count
  3,160

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistJHPS2011
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in JHPS 2011
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v101 v102 v103 ///
>                                 v169 ///
>                                 v176 v177 v178 v179 v182 v183 ///
>                                 v219 v190 ///
>                                 v192 v193 v194 v195 v196 v197 ///
>                                 v199 v200 v201

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,160    2575.194    1712.441          1       6092
          v4 |      3,160    1.260443    .4389458          1          2
          v5 |      3,160    1.508861    .5000006          1          2
          v6 |      3,160    1958.572    15.80015       1917       1989
          v7 |      3,160    6.319937    3.571791          1         12
-------------+---------------------------------------------------------
        v101 |      3,160    2.628481    10.22504          1         99
        v102 |      3,160    1.948418     .839548          1          9
        v103 |      3,160     76.7288    28.97126          1         99
        v169 |      3,160     2.82943    2.210443          1          9
        v176 |      3,160    33.00823    38.63817          1         99
-------------+---------------------------------------------------------
        v177 |      3,160    3.893671    2.902569          1          9
        v178 |      3,160    34.62342    36.88634          1         99
        v179 |      3,160    4.783228    2.655157          1          9
        v182 |      3,160        5.55    2.038883          1          9
        v183 |      3,160    5.249051    2.954386          1          9
-------------+---------------------------------------------------------
        v219 |      3,160    5.097152    12.97873          1         99
        v190 |      3,160     4.25538    3.129418          1          9
        v192 |      3,160    4.048418    3.149418          1          9
        v193 |      3,160    50048.35    44113.61          5      99999
        v194 |      3,160    859701.8    157665.7       3000     999999
-------------+---------------------------------------------------------
        v195 |      3,160    766693.3    305994.6        140     999999
        v196 |      3,160    85827.11    16222.34         20      99999
        v197 |      3,160    31568.52    43114.54          0      99999
        v199 |      3,160    42.68987     32.5529          1         99
        v200 |      3,160    335.5297    410.2057          1        999
-------------+---------------------------------------------------------
        v201 |      3,160    491.0161     466.504          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v12 v13 v14 ///
>                                 v101 v102 v103 ///
>                                 v382 ///
>                                 v389 v390 v391 v392 v395 v396 ///
>                                 v432 v403 ///
>                                 v405 v406 v407 v408 v409 v410 ///
>                                 v412 v413 v414

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,160    2575.194    1712.441          1       6092
          v4 |      3,160    1.260443    .4389458          1          2
         v12 |      3,160    1.835127    1.595052          1          8
         v13 |      3,160    2398.885    1710.516       1882       9999
         v14 |      3,160    11.68608    20.80408          1         99
-------------+---------------------------------------------------------
        v101 |      3,160    2.628481    10.22504          1         99
        v102 |      3,160    1.948418     .839548          1          9
        v103 |      3,160     76.7288    28.97126          1         99
        v382 |      3,160    4.417405    2.973154          1          9
        v389 |      3,160    50.07911    40.84535          1         99
-------------+---------------------------------------------------------
        v390 |      3,160    5.174684    3.072181          1          9
        v391 |      3,160    51.03228    39.44458          1         99
        v392 |      3,160    5.748101    2.684384          1          9
        v395 |      3,160    6.267405    2.104055          1          9
        v396 |      3,160    6.158228    2.744178          1          9
-------------+---------------------------------------------------------
        v432 |      3,160    28.23766    38.85176          1         99
        v403 |      3,160    5.386709    3.094453          1          9
        v405 |      3,160    5.337975     3.22625          1          9
        v406 |      3,160    62137.67    40832.75          7      99999
        v407 |      3,160    867042.3    137407.4       2400     999999
-------------+---------------------------------------------------------
        v408 |      3,160    826261.9    227458.7        600     999999
        v409 |      3,160    86723.26    13730.14          1      99999
        v410 |      3,160       50772    44494.76          0      99999
        v412 |      3,160    57.39146    34.14617          1         99
        v413 |      3,160    516.2924    425.7051          1        999
-------------+---------------------------------------------------------
        v414 |      3,160    608.2329    429.7977          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2011

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,160    2575.194    1712.441          1       6092
 make household head dummy  
(3,160 missing values generated)
(1,507 real changes made)
(1,653 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .53615747  .48602673 | .52310127
(3,160 missing values generated)
(1,473 real changes made)
(1,600 real changes made)
(1,560 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          0 |         0
         8 |         0          . |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .50834403  .50060753 | .50632911
          pri[3160,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,160    2575.194    1712.441          1       6092
(3,160 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,160    12575.19    1712.441      10001      16092
(823 observations deleted)
  2,337
 make household head dummy  
(2,337 missing values generated)
(1,366 real changes made)
(971 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .41548994 | .41548994
(2,337 missing values generated)
(849 real changes made)
(61 real changes made)
(2,276 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
         8 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .02610184 | .02610184
          spo[2337,28]
          pri[3160,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[5497,28]
          spo[2337,28]
          pri[3160,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 5497
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 5,497

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2011.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,711       49.32       49.32
          2 |      2,786       50.68      100.00
------------+-----------------------------------
      Total |      5,497      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      5,497        2011           0       2011       2011

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2011m1

. disp %tm r(max)
 2011m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 1 missing value generated

. mvdecode bmonth, mv(99)
      bmonth: 3 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      5,496    1957.619     15.1358       1917       1989

. gen bym=ym(byear, bmonth)
(3 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1917m9

. disp %tm r(max)
 1989m3

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(3 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             21
 5%           27             21
10%           32             22       Obs               5,494
25%           40             22       Sum of Wgt.       5,494

50%           53                      Mean            52.4878
                        Largest       Std. Dev.      15.15061
75%           65             88
90%           72             89       Variance        229.541
95%           75             90       Skewness      -.0710405
99%           82             93       Kurtosis       2.033342

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(5,497 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(5,497 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2011.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2012

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2012

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/JHPS2012.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(762 vars, 2,821 obs)

. count
  2,821

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistJHPS2012
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in JHPS 2012
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v101 v102 v103 ///
>                                 v190 ///
>                                 v197 v198 v199 v200 v203 v204 ///
>                                 v240 v211 ///
>                                 v213 v214 v215 v216 v217 v218 ///
>                                 v220 v221 v222

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,821    2574.254    1716.107          1       6092
          v4 |      2,821    1.261964     .439781          1          2
          v5 |      2,821    1.508685    .5000132          1          2
          v6 |      2,821    1958.847    15.62772       1917       1989
          v7 |      2,821    6.315491    3.593099          1         12
-------------+---------------------------------------------------------
        v101 |      2,821    3.026232    11.96561          1         99
        v102 |      2,821    1.960652    .8901814          1          9
        v103 |      2,821    76.63594    29.05627          1         99
        v190 |      2,821    2.857852    2.230033          1          9
        v197 |      2,821    33.36193    38.87988          1         99
-------------+---------------------------------------------------------
        v198 |      2,821    3.963134     2.93947          1          9
        v199 |      2,821    34.99114     37.0458          1         99
        v200 |      2,821    4.797235    2.664184          1          9
        v203 |      2,821    5.604396    2.031185          1          9
        v204 |      2,821    5.282878     2.93513          1          9
-------------+---------------------------------------------------------
        v240 |      2,821    5.038993    12.99525          1         99
        v211 |      2,821    4.225097    3.109358          1          9
        v213 |      2,821    4.086849    3.147876          1          9
        v214 |      2,821    50351.17    44039.04          4      99999
        v215 |      2,821    861794.6    152152.1       3000     999999
-------------+---------------------------------------------------------
        v216 |      2,821      761571    311494.7        100     999999
        v217 |      2,821    85987.82    15804.24         10      99999
        v218 |      2,821    31663.27    43097.27          0      99999
        v220 |      2,821    42.81106    32.61396          2         99
        v221 |      2,821    334.0418    409.4387          1        999
-------------+---------------------------------------------------------
        v222 |      2,821    485.9323    465.8631          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v12 v13 v14 ///
>                                 v101 v102 v103 ///
>                                 v420 ///
>                                 v427 v428 v429 v430 v433 v434 ///
>                                 v470 v441 ///
>                                 v443 v444 v445 v446 v447 v448 ///
>                                 v450 v451 v452

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,821    2574.254    1716.107          1       6092
          v4 |      2,821    1.261964     .439781          1          2
         v12 |      2,821    1.888692    1.676184          1          8
         v13 |      2,821    2415.377    1726.888       1914       9999
         v14 |      2,821    11.75115    20.75232          1         99
-------------+---------------------------------------------------------
        v101 |      2,821    3.026232    11.96561          1         99
        v102 |      2,821    1.960652    .8901814          1          9
        v103 |      2,821    76.63594    29.05627          1         99
        v420 |      2,821    4.366891    2.953737          1          9
        v427 |      2,821    49.20773    40.93491          1         99
-------------+---------------------------------------------------------
        v428 |      2,820    5.135816     3.08695          1          9
        v429 |      2,820    50.16028    39.48009          1         99
        v430 |      2,821    5.671748     2.69673          1          9
        v433 |      2,821    6.284296    2.068336          1          9
        v434 |      2,821      6.1581    2.728071          1          9
-------------+---------------------------------------------------------
        v470 |      2,821    27.45941    38.41492          1         99
        v441 |      2,821    5.355548    3.069548          1          9
        v443 |      2,821    5.254874    3.230053          1          9
        v444 |      2,821    61581.73    41079.71          8      99999
        v445 |      2,821    867585.1    135917.3       1000     999999
-------------+---------------------------------------------------------
        v446 |      2,821      817476    241599.9        300     999999
        v447 |      2,821    86953.36    12965.19         12      99999
        v448 |      2,821    48773.12    44584.03          0      99999
        v450 |      2,821    56.75151    34.37137          2         99
        v451 |      2,821    505.9287    427.0789          2        999
-------------+---------------------------------------------------------
        v452 |      2,821     609.843    430.3992          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2012

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,821    2574.254    1716.107          1       6092
 make household head dummy  
(2,821 missing values generated)
(1,307 real changes made)
(1,514 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .53842459  .53179973 | .53668912
(2,821 missing values generated)
(1,329 real changes made)
(1,423 real changes made)
(1,398 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         .          0 |         0
         8 |         0          . |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .49759846  .52368065 | .50443105
          pri[2821,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,821    2574.254    1716.107          1       6092
(2,821 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,821    12574.25    1716.107      10001      16092
(739 observations deleted)
  2,082
 make household head dummy  
(2,082 missing values generated)
(1,223 real changes made)
(859 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .41258405 | .41258405
(2,082 missing values generated)
(768 real changes made)
(66 real changes made)
(2,016 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         8 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .03170029 | .03170029
          spo[2082,28]
          pri[2821,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[4903,28]
          spo[2082,28]
          pri[2821,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 4903
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 4,903

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2012.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,409       49.13       49.13
          2 |      2,494       50.87      100.00
------------+-----------------------------------
      Total |      4,903      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      4,903        2012           0       2012       2012

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2012m1

. disp %tm r(max)
 2012m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)

. mvdecode bmonth, mv(99)
      bmonth: 1 missing value generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      4,903    1958.064    14.99057       1917       1991

. gen bym=ym(byear, bmonth)
(1 missing value generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1917m9

. disp %tm r(max)
 1991m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(1 missing value generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           24             21
 5%           29             22
10%           33             22       Obs               4,902
25%           41             23       Sum of Wgt.       4,902

50%           53                      Mean           53.04896
                        Largest       Std. Dev.      15.00984
75%           65             89
90%           72             90       Variance       225.2953
95%           76             91       Skewness      -.0529657
99%           82             94       Kurtosis       2.012269

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(4,903 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(4,903 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2012.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2013

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2013

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/JHPS2013.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(803 vars, 2,581 obs)

. count
  2,581

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistJHPS2013
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in JHPS 2013
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v101 v102 v103 ///
>                                 v184 ///
>                                 v191 v192 v193 v194 v197 v198 ///
>                                 v234 v205 ///
>                                 v207 v208 v209 v210 v211 v212 ///
>                                 v214 v215 v216

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,581    2542.271    1711.295          2       6092
          v4 |      2,581    1.256877    .4369957          1          2
          v5 |      2,581    1.507168    .5000455          1          2
          v6 |      2,581    1958.892    15.45275       1920       1989
          v7 |      2,581    6.319644    3.607233          1         12
-------------+---------------------------------------------------------
        v101 |      2,581     2.96358     11.7638          1         99
        v102 |      2,581    1.967842    .9014052          1          9
        v103 |      2,581     76.9659    28.70568          1         99
        v184 |      2,581    2.869043     2.25486          1          9
        v191 |      2,581    32.77024    38.43958          1         99
-------------+---------------------------------------------------------
        v192 |      2,581    3.964742    2.909207          1          9
        v193 |      2,581    35.14684    37.02784          1         99
        v194 |      2,581    4.790004    2.648547          1          9
        v197 |      2,581    5.623014    2.024673          1          9
        v198 |      2,581    5.264239    2.949694          1          9
-------------+---------------------------------------------------------
        v234 |      2,581    4.180163    9.143118          1         99
        v205 |      2,581    4.272375     3.12129          1          9
        v207 |      2,581    4.106548    3.166301          1          9
        v208 |      2,581    50511.07     44075.2          6      99999
        v209 |      2,581    863419.4    147795.2        350     999999
-------------+---------------------------------------------------------
        v210 |      2,581    769556.6    302975.9        250     999999
        v211 |      2,581    85967.62    15886.11         10      99999
        v212 |      2,581    32060.64     43150.2          0      99999
        v214 |      2,581    43.87369    32.96877          2         99
        v215 |      2,581    339.0194     410.469          1        999
-------------+---------------------------------------------------------
        v216 |      2,581    486.8861    464.8822          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v12 v13 v14 ///
>                                 v101 v102 v103 ///
>                                 v449 ///
>                                 v456 v457 v458 v459 v462 v463 ///
>                                 v499 v470 ///
>                                 v472 v473 v474 v475 v476 v477 ///
>                                 v479 v480 v481

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,581    2542.271    1711.295          2       6092
          v4 |      2,581    1.256877    .4369957          1          2
         v12 |      2,581    1.918636    1.709857          1          8
         v13 |      2,581    2433.591    1755.439       1914       9999
         v14 |      2,581    11.99419    21.09455          1         99
-------------+---------------------------------------------------------
        v101 |      2,581     2.96358     11.7638          1         99
        v102 |      2,581    1.967842    .9014052          1          9
        v103 |      2,581     76.9659    28.70568          1         99
        v449 |      2,581    4.321968    2.937557          1          9
        v456 |      2,581     48.1267    40.93005          1         99
-------------+---------------------------------------------------------
        v457 |      2,581    5.073227    3.071446          1          9
        v458 |      2,581    49.55095    39.42038          1         99
        v459 |      2,581    5.632701    2.692928          1          9
        v462 |      2,581    6.232468    2.063763          1          9
        v463 |      2,581    6.090663     2.73371          1          9
-------------+---------------------------------------------------------
        v499 |      2,581    26.17241    37.63505          1         99
        v470 |      2,581    5.303371    3.089835          1          9
        v472 |      2,581    5.175901    3.236429          1          9
        v473 |      2,581    60984.63     41355.7          4      99999
        v474 |      2,581    871021.4    124710.1       2000     999999
-------------+---------------------------------------------------------
        v475 |      2,581    813027.4    248601.6        600     999999
        v476 |      2,581    87170.19    12331.65         10      99999
        v477 |      2,581    48368.95    44641.19          0      99999
        v479 |      2,581    56.44634    34.30318          1         99
        v480 |      2,581    503.2577    427.7929          1        999
-------------+---------------------------------------------------------
        v481 |      2,581    603.0632    432.9186          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2013

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,581    2542.271    1711.295          2       6092
 make household head dummy  
(2,581 missing values generated)
(1,190 real changes made)
(1,391 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total |  .5286757  .56862745 |  .5389384
(2,581 missing values generated)
(1,246 real changes made)
(1,345 real changes made)
(1,236 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
         8 |         0          . |         0
         9 |         0          . |         0
        88 |         0          0 |         0
        99 |         .          0 |         0
-----------+----------------------+----------
     Total | .50364964  .57164404 | .52111585
          pri[2581,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,581    2542.271    1711.295          2       6092
(2,581 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,581    12542.27    1711.295      10002      16092
(663 observations deleted)
  1,918
 make household head dummy  
(1,918 missing values generated)
(1,103 real changes made)
(815 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .42492179 | .42492179
(1,918 missing values generated)
(724 real changes made)
(46 real changes made)
(1,872 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
         8 |         0 |         0
         9 |         0 |         0
        88 |         0 |         0
-----------+-----------+----------
     Total | .02398332 | .02398332
          spo[1918,28]
          pri[2581,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[4499,28]
          spo[1918,28]
          pri[2581,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 4499
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 4,499

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2013.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,205       49.01       49.01
          2 |      2,294       50.99      100.00
------------+-----------------------------------
      Total |      4,499      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      4,499        2013           0       2013       2013

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2013m1

. disp %tm r(max)
 2013m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)

. mvdecode bmonth, mv(99)
      bmonth: 1 missing value generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      4,499     1958.31    14.84836       1920       1991

. gen bym=ym(byear, bmonth)
(1 missing value generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
1920m10

. disp %tm r(max)
 1991m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(1 missing value generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           25             22
 5%           30             23
10%           34             23       Obs               4,498
25%           42             23       Sum of Wgt.       4,498

50%           54                      Mean           53.80124
                        Largest       Std. Dev.       14.8663
75%           66             89
90%           73             90       Variance        221.007
95%           76             90       Skewness      -.0560532
99%           82             92       Kurtosis       2.005208

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(4,499 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(4,499 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2013.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2014

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2014

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/JHPS2014.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(957 vars, 2,358 obs)

. count
  2,358

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistJHPS2014
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in JHPS 2014
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v101 v102 v103 ///
>                                 v220 ///
>                                 v227 v228 v229 v230 v233 v234 ///
>                                 v265 v242 ///
>                                 v244 v245 v246 v247 v248 v249 ///
>                                 v251 v252 v253

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,358    2537.068    1714.314          2       6092
          v4 |      2,358     1.24894    .4324906          1          2
          v5 |      2,358    1.508058    .5000411          1          2
          v6 |      2,358    1959.008    15.29159       1922       1989
          v7 |      2,358    6.334182    3.611293          1         12
-------------+---------------------------------------------------------
        v101 |      2,358    3.032655    12.13886          1         99
        v102 |      2,358    1.976251    .9115927          1          9
        v103 |      2,358    77.36726     28.2516          1         99
        v220 |      2,358    2.886768    2.293742          1          9
        v227 |      2,358    32.27396    38.26545          1         99
-------------+---------------------------------------------------------
        v228 |      2,358    3.944869    2.898424          1          9
        v229 |      2,358    34.47286    36.68282          1         99
        v230 |      2,358    4.737489    2.630917          1          9
        v233 |      2,358     5.59754    1.990545          1          9
        v234 |      2,358    5.231976    2.920101          1          9
-------------+---------------------------------------------------------
        v265 |      2,358    5.141221    13.16412          1         99
        v242 |      2,358    4.301103    3.114572          1          9
        v244 |      2,358    4.187447    3.153891          1          9
        v245 |      2,358     51562.1    43817.48         10      99999
        v246 |      2,358    858742.9    160140.7       1000     999999
-------------+---------------------------------------------------------
        v247 |      2,358    763211.4    309728.8        400     999999
        v248 |      2,358    85495.29    17067.38          0      99999
        v249 |      2,358    31203.02    42847.68          0      99999
        v251 |      2,358    43.28032    33.05088          1         99
        v252 |      2,358    342.2786    412.9681          1        999
-------------+---------------------------------------------------------
        v253 |      2,358    486.1213    465.6272          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v12 v13 v14 ///
>                                 v101 v102 v103 ///
>                                 v498 ///
>                                 v505 v506 v507 v508 v511 v512 ///
>                                 v543 v520 ///
>                                 v522 v523 v524 v525 v526 v527 ///
>                                 v529 v530 v531

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,358    2537.068    1714.314          2       6092
          v4 |      2,358     1.24894    .4324906          1          2
         v12 |      2,358    1.924088    1.714375          1          8
         v13 |      2,358    2434.598    1755.236       1914       9999
         v14 |      2,358    11.93893    21.04285          1         99
-------------+---------------------------------------------------------
        v101 |      2,358    3.032655    12.13886          1         99
        v102 |      2,358    1.976251    .9115927          1          9
        v103 |      2,358    77.36726     28.2516          1         99
        v498 |      2,358    4.279898     2.94478          1          9
        v505 |      2,358    47.82909    40.97295          1         99
-------------+---------------------------------------------------------
        v506 |      2,358    5.050891    3.063457          1          9
        v507 |      2,358    49.42918    39.39851          1         99
        v508 |      2,358    5.666243    2.671074          1          9
        v511 |      2,358    6.249364    2.026278          1          9
        v512 |      2,358    6.048346    2.747042          1          9
-------------+---------------------------------------------------------
        v543 |      2,358     26.5793    38.02982          1         99
        v520 |      2,358    5.290076    3.110167          1          9
        v522 |      2,358    5.201018    3.223713          1          9
        v523 |      2,358    60641.98     41389.1          4      99999
        v524 |      2,358    873623.2    114778.6       4000     888888
-------------+---------------------------------------------------------
        v525 |      2,358    804630.3    260462.2        650     999999
        v526 |      2,358    86791.54    13477.35          0      99999
        v527 |      2,358    48022.46    44685.56          0      99999
        v529 |      2,358    56.56785    34.51625          1         99
        v530 |      2,358    503.2214    429.1478          1        999
-------------+---------------------------------------------------------
        v531 |      2,358    609.4309    432.1034          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is JHPS2014

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,358    2537.068    1714.314          2       6092
 make household head dummy  
(2,358 missing values generated)
(1,053 real changes made)
(1,305 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          . |         0
         6 |         0          0 |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total |  .5352908  .60817717 | .55343511
(2,358 missing values generated)
(1,154 real changes made)
(1,234 real changes made)
(1,124 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          . |         0
         7 |         0          . |         0
        88 |         0          0 |         0
        99 |         0          . |         0
-----------+----------------------+----------
     Total | .50818746  .56899489 | .52332485
          pri[2358,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,358    2537.068    1714.314          2       6092
(2,358 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,358    12537.07    1714.314      10002      16092
(587 observations deleted)
  1,771
 make household head dummy  
(1,771 missing values generated)
(1,026 real changes made)
(745 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .42066629 | .42066629
(1,771 missing values generated)
(662 real changes made)
(42 real changes made)
(1,729 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .02371542 | .02371542
          spo[1771,28]
          pri[2358,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[4129,28]
          spo[1771,28]
          pri[2358,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 4129
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 4,129

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2014.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,020       48.92       48.92
          2 |      2,109       51.08      100.00
------------+-----------------------------------
      Total |      4,129      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      4,129        2014           0       2014       2014

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2014m1

. disp %tm r(max)
 2014m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)

. mvdecode bmonth, mv(99)
      bmonth: 1 missing value generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      4,129    1958.542    14.77918       1922       1991

. gen bym=ym(byear, bmonth)
(1 missing value generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
1922m11

. disp %tm r(max)
 1991m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(1 missing value generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           26             23
 5%           30             24
10%           34             24       Obs               4,128
25%           42             24       Sum of Wgt.       4,128

50%           55                      Mean           54.57049
                        Largest       Std. Dev.      14.80011
75%           67             88
90%           74             88       Variance       219.0432
95%           77             90       Skewness      -.0558538
99%           82             91       Kurtosis       1.983682

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(4,129 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(4,129 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/JHPS2014.dta saved

. 
. *}
. 
end of do-file
Current data: KHPS, year list: KHPSyear, number of year: 11 
Current survey year: 2004

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2004

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2004.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(1,981 vars, 4,005 obs)

. count
  4,005

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2004
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in KHPS 2004
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. *** common variable with other years
. local varList ///
>                                 id marital sex byear bmonth ///
>                                 earnmost ///
>                                 edbg workstatus ///
>                                 occ owner ind size employed regular ///
>                                 empsinceyear empsincemonth union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. *** variables of working experience
. global ExpList ///
>                                 cas* full* self* side* fmw*     

. disp "`varList'" "$ExpList"
id marital sex byear bmonth                                 earnmost             
>                     edbg workstatus                                 occ owner i
> nd size employed regular                                 empsinceyear empsincem
> onth union                                 paymethod monthlypaid dailypaid hour
> lypaid yearlypaid bonus                                 workdaypermonth workhou
> rperweek overworkperweekcas* full* self* side* fmw*

. 
. ** variable number of principal
. *** common variable with other years
. local renameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v76 ///
>                                 v106 v170 ///
>                                 v228 v215 v216 v217 v218 v219 ///
>                                 v238 v239 v240 ///
>                                 v244 v245 v246 v247 v248 v249 ///
>                                 v262 v263 v264

. *** variables of working experience
. global CasPri v419-v469

. global FullPri v470-v520

. global SelfPri v521-v571

. global SidePri v572-v622

. global FmwPri v623-v673

. sum `renameListPri' $CasPri $FullPri $SelfPri $SidePri $FmwPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      4,005        2003    1156.288          1       4005
          v4 |      4,005    1.271161    .4446145          1          2
          v5 |      4,005    1.500624     .500062          1          2
          v6 |      4,005    1957.568    13.70913       1934       1984
          v7 |      4,005    6.233208    3.524787          1         12
-------------+---------------------------------------------------------
         v76 |      4,005    2.299126    8.432604          1         99
        v106 |      4,005    2.906367    4.971595          1         99
        v170 |      4,005    2.585518    2.112706          1          9
        v228 |      4,005    29.89089    37.39524          1         99
        v215 |      4,005    3.734332     2.89654          1          9
-------------+---------------------------------------------------------
        v216 |      4,005    32.64994    36.68099          1         99
        v217 |      4,005    29.23795    37.57957          1         99
        v218 |      4,005    5.342821    2.084761          1          9
        v219 |      4,005    5.138077    3.012322          1          9
        v238 |      4,005    4161.134    3262.752       1949       9999
-------------+---------------------------------------------------------
        v239 |      4,005    31.13084    39.08872          0         99
        v240 |      4,005    4.049438    2.964922          1          9
        v244 |      4,005      4.0799    3.250161          1          9
        v245 |      4,005    49893.25    44262.71         10      99999
        v246 |      4,005    854667.1    170158.5        705     999999
-------------+---------------------------------------------------------
        v247 |      4,005    796015.1    272236.7        220     999999
        v248 |      4,005    85619.79    16803.49         10      99999
        v249 |      4,005    39762.63    46175.01          0      99999
        v262 |      4,005    42.85468    32.73077          1         99
        v263 |      4,005    334.8087     412.535          1        999
-------------+---------------------------------------------------------
        v264 |      4,005     526.168    469.9508          0        999
        v419 |      4,005    8.578527     1.78744          1          9
        v420 |      4,005    8.482647    1.967775          1          9
        v421 |      4,005    8.434707    2.050327          1          9
        v422 |      4,005    8.444694    2.033498          1          9
-------------+---------------------------------------------------------
        v423 |      4,005    8.444694    2.033498          1          9
        v424 |      4,005    8.430712    2.057006          1          9
        v425 |      4,005    8.460674    2.006175          1          9
        v426 |      4,005    8.488639    1.957129          1          9
        v427 |      4,005    8.484644    1.964235          1          9
-------------+---------------------------------------------------------
        v428 |      4,005    8.500624    1.935605          1          9
        v429 |      4,005    8.540574    1.861504          1          9
        v430 |      4,005    8.556554    1.830781          1          9
        v431 |      4,005    8.620474    1.700849          1          9
        v432 |      4,005    8.610487    1.721954          1          9
-------------+---------------------------------------------------------
        v433 |      4,005    8.580524    1.783435          1          9
        v434 |      4,005    8.566542    1.811242          1          9
        v435 |      4,005    8.562547    1.819089          1          9
        v436 |      4,005    8.570537    1.803352          1          9
        v437 |      4,005    8.540574    1.861504          1          9
-------------+---------------------------------------------------------
        v438 |      4,005    8.536579    1.869085          1          9
        v439 |      4,005    8.514607    1.910092          1          9
        v440 |      4,005    8.494632    1.946406          1          9
        v441 |      4,005    8.442697    2.036879          1          9
        v442 |      4,005    8.440699    2.040252          1          9
-------------+---------------------------------------------------------
        v443 |      4,005    8.428714    2.060335          1          9
        v444 |      4,005    8.440699    2.040252          1          9
        v445 |      4,005    8.472659    1.985352          1          9
        v446 |      4,005    8.470662    1.988843          1          9
        v447 |      4,005    8.478652    1.974831          1          9
-------------+---------------------------------------------------------
        v448 |      4,005    8.496629    1.942814          1          9
        v449 |      4,005    8.522597    1.895312          1          9
        v450 |      4,005    8.544569    1.853884          1          9
        v451 |      4,005    8.568539    1.807303          1          9
        v452 |      4,005    8.604494    1.734466          1          9
-------------+---------------------------------------------------------
        v453 |      4,005    8.642447    1.653258          1          9
        v454 |      4,005    8.678402    1.571616          1          9
        v455 |      4,005    8.702372     1.51427          1          9
        v456 |      4,005    8.732335    1.438817          1          9
        v457 |      4,005    8.772285     1.33053          1          9
-------------+---------------------------------------------------------
        v458 |      4,005    8.810237    1.217564          1          9
        v459 |      4,005    8.818227    1.192265          1          9
        v460 |      4,005     8.83221    1.146515          1          9
        v461 |      4,005    8.846192    1.098684          1          9
        v462 |      4,005    8.852185     1.07748          1          9
-------------+---------------------------------------------------------
        v463 |      4,005     8.87216    1.003309          1          9
        v464 |      4,005    8.886142     .947693          1          9
        v465 |      4,005     8.90412    .8706535          1          9
        v466 |      4,005    8.934082    .7232747          1          9
        v467 |      4,005    8.954057    .6045834          1          9
-------------+---------------------------------------------------------
        v468 |      4,005     8.96005    .5639893          1          9
        v469 |      4,005    8.974032    .4551019          1          9
        v470 |      4,005     6.04769    3.860838          1          9
        v471 |      4,005    5.456429     3.97437          1          9
        v472 |      4,005    5.120849    3.998673          1          9
-------------+---------------------------------------------------------
        v473 |      4,005    4.615481    3.981972          1          9
        v474 |      4,005     4.38377    3.952741          1          9
        v475 |      4,005    4.036205    3.882636          1          9
        v476 |      4,005     4.16804    3.913012          1          9
        v477 |      4,005      4.4397    3.961058          1          9
-------------+---------------------------------------------------------
        v478 |      4,005    4.699376    3.989185          1          9
        v479 |      4,005    4.959051     4.00029          1          9
        v480 |      4,005    5.250687    3.992635          1          9
        v481 |      4,005    5.428464    3.977483          1          9
        v482 |      4,005    5.530337    3.965182          1          9
-------------+---------------------------------------------------------
        v483 |      4,005    5.706117    3.937673          1          9
        v484 |      4,005    5.829963    3.913437          1          9
        v485 |      4,005    5.947815    3.886569          1          9
        v486 |      4,005    6.019725     3.86832          1          9
        v487 |      4,005    6.089638    3.849206          1          9
-------------+---------------------------------------------------------
        v488 |      4,005    6.203496    3.815132          1          9
        v489 |      4,005    6.281398    3.789671          1          9
        v490 |      4,005    6.339326    3.769583          1          9
        v491 |      4,005    6.403246    3.746252          1          9
        v492 |      4,005    6.469164    3.720889          1          9
-------------+---------------------------------------------------------
        v493 |      4,005    6.599001    3.666954          1          9
        v494 |      4,005    6.662921    3.638406          1          9
        v495 |      4,005    6.726841      3.6085          1          9
        v496 |      4,005    6.812734    3.566114          1          9
        v497 |      4,005    6.874657    3.533947          1          9
-------------+---------------------------------------------------------
        v498 |      4,005    6.988514    3.471141          1          9
        v499 |      4,005    7.068414    3.424119          1          9
        v500 |      4,005    7.174282    3.357873          1          9
        v501 |      4,005    7.258177    3.302023          1          9
        v502 |      4,005     7.32809    3.253097          1          9
-------------+---------------------------------------------------------
        v503 |      4,005    7.459925    3.154561          1          9
        v504 |      4,005    7.545818    3.085642          1          9
        v505 |      4,005     7.64769    2.998663          1          9
        v506 |      4,005    7.717603    2.935436          1          9
        v507 |      4,005    7.857428    2.799475          1          9
-------------+---------------------------------------------------------
        v508 |      4,005    7.983271    2.664933          1          9
        v509 |      4,005    8.085144    2.546273          1          9
        v510 |      4,005    8.167041    2.443633          1          9
        v511 |      4,005    8.278901    2.291313          1          9
        v512 |      4,005    8.344819    2.193943          1          9
-------------+---------------------------------------------------------
        v513 |      4,005    8.670412    1.590191          1          9
        v514 |      4,005    8.732335    1.438817          1          9
        v515 |      4,005     8.80824    1.223799          1          9
        v516 |      4,005    8.862172    1.041103          1          9
        v517 |      4,005    8.892135    .9227671          1          9
-------------+---------------------------------------------------------
        v518 |      4,005     8.93608    .7123214          1          9
        v519 |      4,005     8.96005    .5639893          1          9
        v520 |      4,005    8.974032    .4551019          1          9
        v521 |      4,005    8.802247    1.242297          1          9
        v522 |      4,005    8.754307    1.380454          1          9
-------------+---------------------------------------------------------
        v523 |      4,005    8.718352    1.474585          1          9
        v524 |      4,005    8.668414    1.594795          1          9
        v525 |      4,005    8.614482     1.71355          1          9
        v526 |      4,005    8.538577      1.8653          1          9
        v527 |      4,005    8.482647    1.967775          1          9
-------------+---------------------------------------------------------
        v528 |      4,005    8.436704    2.046976          1          9
        v529 |      4,005    8.390762     2.12223          1          9
        v530 |      4,005    8.364794    2.163176          1          9
        v531 |      4,005    8.336829     2.20608          1          9
        v532 |      4,005    8.304869    2.253688          1          9
-------------+---------------------------------------------------------
        v533 |      4,005    8.274906    2.297021          1          9
        v534 |      4,005    8.244944    2.339168          1          9
        v535 |      4,005    8.244944    2.339168          1          9
        v536 |      4,005    8.242946    2.341937          1          9
        v537 |      4,005    8.234956    2.352964          1          9
-------------+---------------------------------------------------------
        v538 |      4,005    8.234956    2.352964          1          9
        v539 |      4,005    8.238951     2.34746          1          9
        v540 |      4,005    8.242946    2.341937          1          9
        v541 |      4,005    8.258926    2.319643          1          9
        v542 |      4,005    8.264919    2.311199          1          9
-------------+---------------------------------------------------------
        v543 |      4,005    8.268914    2.305543          1          9
        v544 |      4,005    8.278901    2.291313          1          9
        v545 |      4,005    8.280899    2.288451          1          9
        v546 |      4,005    8.286891    2.279834          1          9
        v547 |      4,005    8.302871    2.256615          1          9
-------------+---------------------------------------------------------
        v548 |      4,005    8.310861    2.244873          1          9
        v549 |      4,005    8.338826    2.203055          1          9
        v550 |      4,005    8.358801    2.172471          1          9
        v551 |      4,005    8.374782    2.147557          1          9
        v552 |      4,005    8.380774    2.138109          1          9
-------------+---------------------------------------------------------
        v553 |      4,005    8.400749    2.106185          1          9
        v554 |      4,005    8.428714    2.060335          1          9
        v555 |      4,005    8.468664    1.992325          1          9
        v556 |      4,005    8.494632    1.946406          1          9
        v557 |      4,005    8.542572    1.857699          1          9
-------------+---------------------------------------------------------
        v558 |      4,005    8.558552    1.826894          1          9
        v559 |      4,005    8.604494    1.734466          1          9
        v560 |      4,005    8.656429    1.622091          1          9
        v561 |      4,005    8.690387    1.543256          1          9
        v562 |      4,005    8.706367    1.504463          1          9
-------------+---------------------------------------------------------
        v563 |      4,005    8.716355    1.479613          1          9
        v564 |      4,005    8.764295    1.352976          1          9
        v565 |      4,005    8.802247    1.242297          1          9
        v566 |      4,005    8.826217    1.166362          1          9
        v567 |      4,005    8.860175    1.048487          1          9
-------------+---------------------------------------------------------
        v568 |      4,005    8.890137    .9311542          1          9
        v569 |      4,005    8.914107    .8245807          1          9
        v570 |      4,005     8.92809    .7551505          1          9
        v571 |      4,005    8.954057    .6045834          1          9
        v572 |      4,005    8.988015    .3094518          1          9
-------------+---------------------------------------------------------
        v573 |      4,005     8.98402    .3572348          1          9
        v574 |      4,005    8.978027    .4187377          1          9
        v575 |      4,005    8.972035    .4722224          1          9
        v576 |      4,005    8.966042    .5201681          1          9
        v577 |      4,005    8.950062    .6301635          1          9
-------------+---------------------------------------------------------
        v578 |      4,005     8.92809    .7551505          1          9
        v579 |      4,005    8.914107    .8245807          1          9
        v580 |      4,005    8.874157    .9955665          1          9
        v581 |      4,005    8.886142     .947693          1          9
        v582 |      4,005    8.874157    .9955665          1          9
-------------+---------------------------------------------------------
        v583 |      4,005    8.858177    1.055816          1          9
        v584 |      4,005    8.838202    1.126286          1          9
        v585 |      4,005    8.850187    1.084598          1          9
        v586 |      4,005    8.830212    1.153172          1          9
        v587 |      4,005    8.820225    1.185847          1          9
-------------+---------------------------------------------------------
        v588 |      4,005    8.834207    1.139815          1          9
        v589 |      4,005      8.8402    1.119455          1          9
        v590 |      4,005    8.830212    1.153172          1          9
        v591 |      4,005    8.850187    1.084598          1          9
        v592 |      4,005    8.862172    1.041103          1          9
-------------+---------------------------------------------------------
        v593 |      4,005     8.88015    .9719431          1          9
        v594 |      4,005    8.890137    .9311542          1          9
        v595 |      4,005    8.908115    .8525372          1          9
        v596 |      4,005    8.910112    .8433261          1          9
        v597 |      4,005    8.902122    .8795649          1          9
-------------+---------------------------------------------------------
        v598 |      4,005     8.90412    .8706535          1          9
        v599 |      4,005    8.906117    .8616453          1          9
        v600 |      4,005    8.914107    .8245807          1          9
        v601 |      4,005     8.91211    .8340085          1          9
        v602 |      4,005    8.918102    .8053793          1          9
-------------+---------------------------------------------------------
        v603 |      4,005    8.930087    .7446822          1          9
        v604 |      4,005    8.924095    .7756478          1          9
        v605 |      4,005    8.930087    .7446822          1          9
        v606 |      4,005    8.940075    .6898758          1          9
        v607 |      4,005    8.942072    .6783657          1          9
-------------+---------------------------------------------------------
        v608 |      4,005     8.95206    .6175092          1          9
        v609 |      4,005    8.958052    .5778445          1          9
        v610 |      4,005    8.958052    .5778445          1          9
        v611 |      4,005    8.962047    .5497777          1          9
        v612 |      4,005    8.966042    .5201681          1          9
-------------+---------------------------------------------------------
        v613 |      4,005    8.966042    .5201681          1          9
        v614 |      4,005    8.972035    .4722224          1          9
        v615 |      4,005     8.98402    .3572348          1          9
        v616 |      4,005     8.98402    .3572348          1          9
        v617 |      4,005     8.99201    .2527295          1          9
-------------+---------------------------------------------------------
        v618 |      4,005    8.994007    .2188975          1          9
        v619 |      4,005    8.994007    .2188975          1          9
        v620 |      4,005    8.998002    .1264121          1          9
        v621 |      4,005    8.998002    .1264121          1          9
        v622 |      4,005           9           0          9          9
-------------+---------------------------------------------------------
        v623 |      4,005    8.852185     1.07748          1          9
        v624 |      4,005     8.83221    1.146515          1          9
        v625 |      4,005    8.794257    1.266496          1          9
        v626 |      4,005     8.74432    1.407326          1          9
        v627 |      4,005    8.702372     1.51427          1          9
-------------+---------------------------------------------------------
        v628 |      4,005    8.656429    1.622091          1          9
        v629 |      4,005    8.602497    1.738612          1          9
        v630 |      4,005    8.578527     1.78744          1          9
        v631 |      4,005    8.554557    1.834657          1          9
        v632 |      4,005    8.528589     1.88413          1          9
-------------+---------------------------------------------------------
        v633 |      4,005    8.532584    1.876627          1          9
        v634 |      4,005    8.536579    1.869085          1          9
        v635 |      4,005    8.538577      1.8653          1          9
        v636 |      4,005    8.548564    1.846224          1          9
        v637 |      4,005    8.576529    1.791435          1          9
-------------+---------------------------------------------------------
        v638 |      4,005    8.594507    1.755075          1          9
        v639 |      4,005    8.598502    1.746868          1          9
        v640 |      4,005    8.608489    1.726137          1          9
        v641 |      4,005    8.616479    1.709329          1          9
        v642 |      4,005    8.632459    1.675094          1          9
-------------+---------------------------------------------------------
        v643 |      4,005    8.642447    1.653258          1          9
        v644 |      4,005    8.666417    1.599383          1          9
        v645 |      4,005    8.686392    1.552777          1          9
        v646 |      4,005     8.70437    1.509376          1          9
        v647 |      4,005    8.726342    1.454271          1          9
-------------+---------------------------------------------------------
        v648 |      4,005    8.732335    1.438817          1          9
        v649 |      4,005    8.742322     1.41263          1          9
        v650 |      4,005    8.742322     1.41263          1          9
        v651 |      4,005     8.75231    1.385876          1          9
        v652 |      4,005      8.7603    1.364042          1          9
-------------+---------------------------------------------------------
        v653 |      4,005    8.766292    1.347404          1          9
        v654 |      4,005     8.77628    1.319146          1          9
        v655 |      4,005    8.782272     1.30186          1          9
        v656 |      4,005     8.79226    1.272466          1          9
        v657 |      4,005    8.802247    1.242297          1          9
-------------+---------------------------------------------------------
        v658 |      4,005    8.820225    1.185847          1          9
        v659 |      4,005    8.836205    1.133073          1          9
        v660 |      4,005    8.862172    1.041103          1          9
        v661 |      4,005    8.866167    1.026164          1          9
        v662 |      4,005     8.88814    .9394621          1          9
-------------+---------------------------------------------------------
        v663 |      4,005    8.894132    .9142987          1          9
        v664 |      4,005    8.902122    .8795649          1          9
        v665 |      4,005    8.902122    .8795649          1          9
        v666 |      4,005    8.910112    .8433261          1          9
        v667 |      4,005     8.92809    .7551505          1          9
-------------+---------------------------------------------------------
        v668 |      4,005     8.94407     .666651          1          9
        v669 |      4,005     8.95206    .6175092          1          9
        v670 |      4,005    8.966042    .5201681          1          9
        v671 |      4,005    8.978027    .4187377          1          9
        v672 |      4,005    8.982022    .3788573          1          9
-------------+---------------------------------------------------------
        v673 |      4,005    8.986017    .3342044          1          9

. 
. ** variable number of spouse
. *** common variable with other years
. gen relno=.
(4,005 missing values generated)

. gen dsex=.
(4,005 missing values generated)

. gen bYear=.
(4,005 missing values generated)

. gen bMonth=.
(4,005 missing values generated)

. local renameListSpo ///
>                                 v1 v4 dsex bYear bMonth ///
>                                 v76 ///
>                                 v803 v867 ///
>                                 v925 v912 v913 v914 v915 v916 ///
>                                 v935 v936 v937 ///
>                                 v941 v942 v943 v944 v945 v946 ///
>                                 v959 v960 v961

. *** variables of working experience
. global CasSpo v1116-v1166

. global FullSpo v1167-v1217

. global SelfSpo v1218-v1268

. global SideSpo v1269-v1319

. global FmwSpo v1320-v1370

. sum `renameListSpo' $CasSpo $FullSpo $SelfSpo $SideSpo $FmwSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      4,005        2003    1156.288          1       4005
          v4 |      4,005    1.271161    .4446145          1          2
        dsex |          0
       bYear |          0
      bMonth |          0
-------------+---------------------------------------------------------
         v76 |      4,005    2.299126    8.432604          1         99
        v803 |      4,005    26.22821    38.24656          1         99
        v867 |      4,005    4.171536    2.998633          1          9
        v925 |      4,005     47.0392    41.12663          1         99
        v912 |      4,005    4.987516    3.138152          1          9
-------------+---------------------------------------------------------
        v913 |      4,005     49.0779    39.98146          1         99
        v914 |      4,005    46.48789    41.48199          1         99
        v915 |      4,005    6.090886    2.183681          1          9
        v916 |      4,005    6.026717    2.825872          1          9
        v935 |      4,005     5561.24    3490.977       1949       9999
-------------+---------------------------------------------------------
        v936 |      4,005    47.92659    41.92635          0         99
        v937 |      4,005    5.234707    3.045172          1          9
        v941 |      4,005     5.23995    3.275648          1          9
        v942 |      4,005     61960.5     41061.8          3      99999
        v943 |      4,005    863351.2    148107.2        320     999999
-------------+---------------------------------------------------------
        v944 |      4,005    829172.5    222717.2        450     999999
        v945 |      4,005    86504.69    14395.64         30      99999
        v946 |      4,005    56123.87    44589.83          0      99999
        v959 |      4,005    56.14082    34.45823          1         99
        v960 |      4,005    502.2335     429.294          1        999
-------------+---------------------------------------------------------
        v961 |      4,005    643.9373    424.4337          0        999
       v1116 |      4,005    8.511111    1.332071          1          9
       v1117 |      4,005    8.463171    1.452186          1          9
       v1118 |      4,005    8.465169    1.447412          1          9
       v1119 |      4,005    8.437203    1.512639          1          9
-------------+---------------------------------------------------------
       v1120 |      4,005    8.429213    1.530671          1          9
       v1121 |      4,005    8.387266    1.621406          1          9
       v1122 |      4,005    8.391261    1.613032          1          9
       v1123 |      4,005    8.429213    1.530671          1          9
       v1124 |      4,005    8.437203    1.512639          1          9
-------------+---------------------------------------------------------
       v1125 |      4,005    8.445194    1.494347          1          9
       v1126 |      4,005    8.455181    1.471101          1          9
       v1127 |      4,005    8.445194    1.494347          1          9
       v1128 |      4,005    8.427216    1.535139          1          9
       v1129 |      4,005    8.433208    1.521687          1          9
-------------+---------------------------------------------------------
       v1130 |      4,005    8.423221    1.544029          1          9
       v1131 |      4,005    8.415231    1.561627          1          9
       v1132 |      4,005    8.401248    1.591859          1          9
       v1133 |      4,005    8.395256    1.604604          1          9
       v1134 |      4,005    8.403246    1.587583          1          9
-------------+---------------------------------------------------------
       v1135 |      4,005    8.379276    1.637998          1          9
       v1136 |      4,005    8.353308    1.690535          1          9
       v1137 |      4,005    8.357303    1.682585          1          9
       v1138 |      4,005    8.371286    1.654384          1          9
       v1139 |      4,005    8.355306    1.686566          1          9
-------------+---------------------------------------------------------
       v1140 |      4,005    8.355306    1.686566          1          9
       v1141 |      4,005    8.353308    1.690535          1          9
       v1142 |      4,005    8.365293    1.666543          1          9
       v1143 |      4,005    8.359301    1.678593          1          9
       v1144 |      4,005    8.365293    1.666543          1          9
-------------+---------------------------------------------------------
       v1145 |      4,005    8.387266    1.621406          1          9
       v1146 |      4,005    8.399251    1.596121          1          9
       v1147 |      4,005    8.407241    1.578988          1          9
       v1148 |      4,005    8.447191    1.489732          1          9
       v1149 |      4,005    8.461174    1.456942          1          9
-------------+---------------------------------------------------------
       v1150 |      4,005    8.477154    1.418372          1          9
       v1151 |      4,005    8.509114    1.337326          1          9
       v1152 |      4,005    8.547066    1.233116          1          9
       v1153 |      4,005    8.553059    1.215737          1          9
       v1154 |      4,005    8.577029    1.143269          1          9
-------------+---------------------------------------------------------
       v1155 |      4,005    8.587016    1.111529          1          9
       v1156 |      4,005    8.599001    1.072077          1          9
       v1157 |      4,005    8.624969    .9806702          1          9
       v1158 |      4,005    8.630961     .958239          1          9
       v1159 |      4,005    8.622971     .988026          1          9
-------------+---------------------------------------------------------
       v1160 |      4,005    8.628964    .9657781          1          9
       v1161 |      4,005    8.648939    .8873075          1          9
       v1162 |      4,005    8.662921     .827678          1          9
       v1163 |      4,005    8.684894    .7235748          1          9
       v1164 |      4,005    8.688889    .7029188          1          9
-------------+---------------------------------------------------------
       v1165 |      4,005    8.694881    .6706985          1          9
       v1166 |      4,005    8.700874    .6367937          1          9
       v1167 |      4,005    6.627466    3.384684          1          9
       v1168 |      4,005    6.094132    3.592766          1          9
       v1169 |      4,005    5.842447    3.659986          1          9
-------------+---------------------------------------------------------
       v1170 |      4,005    5.480899    3.724792          1          9
       v1171 |      4,005    5.299126    3.743781          1          9
       v1172 |      4,005    4.969538    3.755591          1          9
       v1173 |      4,005    5.097378    3.754452          1          9
       v1174 |      4,005    5.255181    3.747034          1          9
-------------+---------------------------------------------------------
       v1175 |      4,005    5.456929    3.727809          1          9
       v1176 |      4,005    5.606742    3.706368          1          9
       v1177 |      4,005    5.730587    3.683952          1          9
       v1178 |      4,005    5.874407    3.652481          1          9
       v1179 |      4,005    5.986267    3.623869          1          9
-------------+---------------------------------------------------------
       v1180 |      4,005    6.108115    3.588477          1          9
       v1181 |      4,005    6.148065    3.575893          1          9
       v1182 |      4,005    6.221973     3.55131          1          9
       v1183 |      4,005     6.28789    3.527934          1          9
       v1184 |      4,005     6.33583    3.510058          1          9
-------------+---------------------------------------------------------
       v1185 |      4,005    6.397753    3.485856          1          9
       v1186 |      4,005    6.469663    3.456146          1          9
       v1187 |      4,005    6.525593    3.431819          1          9
       v1188 |      4,005    6.595506    3.399871          1          9
       v1189 |      4,005    6.667416    3.365178          1          9
-------------+---------------------------------------------------------
       v1190 |      4,005    6.755306     3.32017          1          9
       v1191 |      4,005    6.827216    3.281134          1          9
       v1192 |      4,005    6.903121    3.237687          1          9
       v1193 |      4,005    6.937079    3.217481          1          9
       v1194 |      4,005    6.999001     3.17937          1          9
-------------+---------------------------------------------------------
       v1195 |      4,005    7.076904    3.129023          1          9
       v1196 |      4,005    7.132834    3.091161          1          9
       v1197 |      4,005    7.202747    3.041725          1          9
       v1198 |      4,005    7.276654    2.986795          1          9
       v1199 |      4,005    7.354557     2.92576          1          9
-------------+---------------------------------------------------------
       v1200 |      4,005    7.456429    2.840747          1          9
       v1201 |      4,005     7.51236    2.791392          1          9
       v1202 |      4,005    7.628215    2.682565          1          9
       v1203 |      4,005    7.692135    2.618395          1          9
       v1204 |      4,005    7.805993    2.495964          1          9
-------------+---------------------------------------------------------
       v1205 |      4,005    7.909863    2.374022          1          9
       v1206 |      4,005    7.981773    2.283025          1          9
       v1207 |      4,005    8.043695    2.199773          1          9
       v1208 |      4,005     8.10362    2.114363          1          9
       v1209 |      4,005    8.159551    2.029813          1          9
-------------+---------------------------------------------------------
       v1210 |      4,005    8.425218    1.539592          1          9
       v1211 |      4,005    8.479151    1.413464          1          9
       v1212 |      4,005    8.531086    1.278167          1          9
       v1213 |      4,005    8.593009    1.091998          1          9
       v1214 |      4,005    8.614981    1.016878          1          9
-------------+---------------------------------------------------------
       v1215 |      4,005    8.674906    .7727127          1          9
       v1216 |      4,005    8.692884    .6816137          1          9
       v1217 |      4,005    8.698876    .6482985          1          9
       v1218 |      4,005    8.563046    1.186139          1          9
       v1219 |      4,005    8.535081    1.267073          1          9
-------------+---------------------------------------------------------
       v1220 |      4,005    8.497129    1.368368          1          9
       v1221 |      4,005    8.441199    1.503526          1          9
       v1222 |      4,005    8.391261    1.613032          1          9
       v1223 |      4,005    8.347316    1.702373          1          9
       v1224 |      4,005    8.319351     1.75629          1          9
-------------+---------------------------------------------------------
       v1225 |      4,005    8.281398    1.826234          1          9
       v1226 |      4,005    8.261423    1.861681          1          9
       v1227 |      4,005    8.239451    1.899667          1          9
       v1228 |      4,005    8.215481    1.939973          1          9
       v1229 |      4,005    8.197503    1.969471          1          9
-------------+---------------------------------------------------------
       v1230 |      4,005    8.181523    1.995189          1          9
       v1231 |      4,005    8.177528    2.001546          1          9
       v1232 |      4,005    8.167541    2.017319          1          9
       v1233 |      4,005    8.167541    2.017319          1          9
       v1234 |      4,005    8.153558    2.039113          1          9
-------------+---------------------------------------------------------
       v1235 |      4,005    8.155556     2.03602          1          9
       v1236 |      4,005    8.147566    2.048353          1          9
       v1237 |      4,005    8.147566    2.048353          1          9
       v1238 |      4,005    8.139576    2.060582          1          9
       v1239 |      4,005    8.141573    2.057535          1          9
-------------+---------------------------------------------------------
       v1240 |      4,005    8.137578    2.063623          1          9
       v1241 |      4,005    8.131586    2.072708          1          9
       v1242 |      4,005    8.129588    2.075723          1          9
       v1243 |      4,005    8.137578    2.063623          1          9
       v1244 |      4,005    8.153558    2.039113          1          9
-------------+---------------------------------------------------------
       v1245 |      4,005    8.157553     2.03292          1          9
       v1246 |      4,005    8.203496    1.959706          1          9
       v1247 |      4,005    8.207491    1.953159          1          9
       v1248 |      4,005    8.227466    1.919963          1          9
       v1249 |      4,005    8.239451    1.899667          1          9
-------------+---------------------------------------------------------
       v1250 |      4,005    8.267416    1.851141          1          9
       v1251 |      4,005    8.303371    1.786172          1          9
       v1252 |      4,005    8.311361    1.771312          1          9
       v1253 |      4,005    8.327341    1.741101          1          9
       v1254 |      4,005    8.357303    1.682585          1          9
-------------+---------------------------------------------------------
       v1255 |      4,005    8.395256    1.604604          1          9
       v1256 |      4,005    8.419226    1.552858          1          9
       v1257 |      4,005    8.443196    1.498945          1          9
       v1258 |      4,005    8.465169    1.447412          1          9
       v1259 |      4,005    8.465169    1.447412          1          9
-------------+---------------------------------------------------------
       v1260 |      4,005    8.479151    1.413464          1          9
       v1261 |      4,005    8.521099    1.305436          1          9
       v1262 |      4,005    8.551061     1.22156          1          9
       v1263 |      4,005    8.577029    1.143269          1          9
       v1264 |      4,005    8.591011     1.09855          1          9
-------------+---------------------------------------------------------
       v1265 |      4,005    8.602996     1.05857          1          9
       v1266 |      4,005    8.616979    1.009748          1          9
       v1267 |      4,005    8.642946    .9116042          1          9
       v1268 |      4,005    8.664919    .8187856          1          9
       v1269 |      4,005    8.714856    .5493539          1          9
-------------+---------------------------------------------------------
       v1270 |      4,005    8.710861    .5757282          1          9
       v1271 |      4,005    8.706866    .6009195          1          9
       v1272 |      4,005    8.698876    .6482985          1          9
       v1273 |      4,005    8.692884    .6816137          1          9
       v1274 |      4,005    8.676904    .7631487          1          9
-------------+---------------------------------------------------------
       v1275 |      4,005    8.662921     .827678          1          9
       v1276 |      4,005    8.650936    .8790503          1          9
       v1277 |      4,005    8.646941    .8954842          1          9
       v1278 |      4,005    8.644944    .9035824          1          9
       v1279 |      4,005    8.640949    .9195518          1          9
-------------+---------------------------------------------------------
       v1280 |      4,005    8.634956    .9429673          1          9
       v1281 |      4,005    8.628964    .9657781          1          9
       v1282 |      4,005    8.620974    .9953235          1          9
       v1283 |      4,005    8.620974    .9953235          1          9
       v1284 |      4,005    8.624969    .9806702          1          9
-------------+---------------------------------------------------------
       v1285 |      4,005    8.628964    .9657781          1          9
       v1286 |      4,005    8.622971     .988026          1          9
       v1287 |      4,005    8.622971     .988026          1          9
       v1288 |      4,005    8.628964    .9657781          1          9
       v1289 |      4,005    8.634956    .9429673          1          9
-------------+---------------------------------------------------------
       v1290 |      4,005    8.634956    .9429673          1          9
       v1291 |      4,005    8.634956    .9429673          1          9
       v1292 |      4,005    8.640949    .9195518          1          9
       v1293 |      4,005    8.640949    .9195518          1          9
       v1294 |      4,005    8.642946    .9116042          1          9
-------------+---------------------------------------------------------
       v1295 |      4,005    8.652934    .8707103          1          9
       v1296 |      4,005    8.658926    .8451681          1          9
       v1297 |      4,005    8.662921     .827678          1          9
       v1298 |      4,005    8.662921     .827678          1          9
       v1299 |      4,005    8.664919    .8187856          1          9
-------------+---------------------------------------------------------
       v1300 |      4,005    8.674906    .7727127          1          9
       v1301 |      4,005    8.674906    .7727127          1          9
       v1302 |      4,005    8.678901    .7534581          1          9
       v1303 |      4,005    8.682896    .7336766          1          9
       v1304 |      4,005    8.684894    .7235748          1          9
-------------+---------------------------------------------------------
       v1305 |      4,005    8.692884    .6816137          1          9
       v1306 |      4,005    8.696879    .6595966          1          9
       v1307 |      4,005    8.698876    .6482985          1          9
       v1308 |      4,005    8.702871    .6250708          1          9
       v1309 |      4,005    8.704869    .6131173          1          9
-------------+---------------------------------------------------------
       v1310 |      4,005    8.710861    .5757282          1          9
       v1311 |      4,005    8.716854    .5356689          1          9
       v1312 |      4,005    8.716854    .5356689          1          9
       v1313 |      4,005    8.718851    .5216173          1          9
       v1314 |      4,005    8.720849    .5071687          1          9
-------------+---------------------------------------------------------
       v1315 |      4,005    8.722846    .4922881          1          9
       v1316 |      4,005    8.722846    .4922881          1          9
       v1317 |      4,005    8.726841    .4610624          1          9
       v1318 |      4,005    8.726841    .4610624          1          9
       v1319 |      4,005    8.728839    .4446145          8          9
-------------+---------------------------------------------------------
       v1320 |      4,005    8.636954    .9352315          1          9
       v1321 |      4,005    8.616979    1.009748          1          9
       v1322 |      4,005    8.597004    1.078762          1          9
       v1323 |      4,005    8.561049    1.192124          1          9
       v1324 |      4,005    8.541074    1.250224          1          9
-------------+---------------------------------------------------------
       v1325 |      4,005    8.511111    1.332071          1          9
       v1326 |      4,005    8.463171    1.452186          1          9
       v1327 |      4,005    8.443196    1.498945          1          9
       v1328 |      4,005    8.419226    1.552858          1          9
       v1329 |      4,005    8.419226    1.552858          1          9
-------------+---------------------------------------------------------
       v1330 |      4,005    8.401248    1.591859          1          9
       v1331 |      4,005    8.387266    1.621406          1          9
       v1332 |      4,005    8.387266    1.621406          1          9
       v1333 |      4,005    8.385268    1.625574          1          9
       v1334 |      4,005    8.383271    1.629728          1          9
-------------+---------------------------------------------------------
       v1335 |      4,005    8.385268    1.625574          1          9
       v1336 |      4,005    8.389263    1.617226          1          9
       v1337 |      4,005    8.401248    1.591859          1          9
       v1338 |      4,005    8.415231    1.561627          1          9
       v1339 |      4,005    8.423221    1.544029          1          9
-------------+---------------------------------------------------------
       v1340 |      4,005    8.437203    1.512639          1          9
       v1341 |      4,005    8.449189      1.4851          1          9
       v1342 |      4,005    8.451186    1.480451          1          9
       v1343 |      4,005    8.461174    1.456942          1          9
       v1344 |      4,005    8.467166     1.44262          1          9
-------------+---------------------------------------------------------
       v1345 |      4,005    8.479151    1.413464          1          9
       v1346 |      4,005    8.495131    1.373464          1          9
       v1347 |      4,005    8.515106    1.321491          1          9
       v1348 |      4,005    8.513109    1.326793          1          9
       v1349 |      4,005    8.521099    1.305436          1          9
-------------+---------------------------------------------------------
       v1350 |      4,005    8.531086    1.278167          1          9
       v1351 |      4,005    8.533084    1.272634          1          9
       v1352 |      4,005    8.535081    1.267073          1          9
       v1353 |      4,005    8.543071    1.244551          1          9
       v1354 |      4,005    8.561049    1.192124          1          9
-------------+---------------------------------------------------------
       v1355 |      4,005    8.575031    1.149502          1          9
       v1356 |      4,005    8.589014     1.10506          1          9
       v1357 |      4,005    8.602996     1.05857          1          9
       v1358 |      4,005    8.624969    .9806702          1          9
       v1359 |      4,005    8.640949    .9195518          1          9
-------------+---------------------------------------------------------
       v1360 |      4,005    8.644944    .9035824          1          9
       v1361 |      4,005    8.648939    .8873075          1          9
       v1362 |      4,005    8.656929    .8537717          1          9
       v1363 |      4,005    8.656929    .8537717          1          9
       v1364 |      4,005    8.664919    .8187856          1          9
-------------+---------------------------------------------------------
       v1365 |      4,005    8.672909    .7821546          1          9
       v1366 |      4,005    8.684894    .7235748          1          9
       v1367 |      4,005    8.692884    .6816137          1          9
       v1368 |      4,005    8.696879    .6595966          1          9
       v1369 |      4,005    8.704869    .6131173          1          9
-------------+---------------------------------------------------------
       v1370 |      4,005    8.704869    .6131173          1          9

. 
. ** variable list to be convert to matrix
. local matVarList `varList' dhead dearnmost $ExpList

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2004

. 
. *** rename info. of spouse
. rename ( ///
>                                 v13 v14 v15 v16 ///
>                                 v20 v21 v22 v23 ///
>                                 v27 v28 v29 v30 ///
>                                 v34 v35 v36 v37 ///
>                                 v41 v42 v43 v44 ///
>                                 v48 v49 v50 v51 ///
>                                 v55 v56 v57 v58 ///
>                                 v62 v63 v64 v65 ///
>                                 v69 v70 v71 v72 ///
>                                 ) ///
>                                 ( ///
>                                 rel1no rel1sex rel1byear rel1bmonth ///
>                                 rel2no rel2sex rel2byear rel2bmonth ///
>                                 rel3no rel3sex rel3byear rel3bmonth ///
>                                 rel4no rel4sex rel4byear rel4bmonth ///
>                                 rel5no rel5sex rel5byear rel5bmonth ///
>                                 rel6no rel6sex rel6byear rel6bmonth ///
>                                 rel7no rel7sex rel7byear rel7bmonth ///
>                                 rel8no rel8sex rel8byear rel8bmonth ///
>                                 rel9no rel9sex rel9byear rel9bmonth ///
>                                 )

. qui forvalues x=1/9 {

. 
. * 1. rename varname and make head dummy
. local renameList renameListPri renameListSpo

. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** rename variable of experience
.         dis " rename variable of experience "
  6.         global Resp_i `i'
  7.         global Age_t 18
  8.         do "$Path\Code\Renamevar_Exp.do"
  9.         
.         if `i'==1 {
 10.                 dis " replace id of principle "
 11.                 ** replace id (KHPS)
.                 replace id = id+20000
 12.                 
.                 dis " make household head dummy  "
 13.                 ** make breadwinner dummy
.                 gen dearnmost=.
 14.                 replace dearnmost=1 if earnmost==1
 15.                 replace dearnmost=0 if dearnmost!=1
 16.         }
 17.         else {
 18.                 dis " replace id of spouse and drop not married "
 19.                 ** replace id (spouse)
.                 replace id = id+10000
 20.                 ** keep sample of spouse
.                 keep if marital==1
 21.                 count
 22.                 dis " make household head dummy  "
 23.                 ** make breadwinner dummy
.                 gen dearnmost=.
 24.                 replace dearnmost=1 if earnmost==relno
 25.                 replace dearnmost=0 if dearnmost==.
 26.         }
 27.         label var dearnmost "Breadwinner dummy"
 28.         tab earnmost marital, sum(dearnmost) mean miss
 29.         
.         ** make household head dummy
.         gen dhead=.
 30.         replace dhead=dearnmost
 31.         label var dhead "HH head dummy"
 32.         
.         sum id
 33.         
.         ** save variable as matrix
.         if `i'==1{
 34.                 local matName pri
 35.         }
 36.         else {
 37.                 local matName spo
 38.         }
 39.         mkmat `matVarList', matrix(`matName')
 40.         mat dir
 41.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 42.         drop dhead dearnmost
 43.         drop $ExpList
 44. }
 ** Rename variables of renameListPri 
 rename variable of experience 

. *******************************************************
. *Title: Renamevar_Exp
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables of working experience
. * 
. * 1. rename vars. of experience
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. * set list of variables
. ** of principal
. local casPri $CasPri

. local fullPri $FullPri

. local selfPri $SelfPri

. local sidePri $SidePri

. local fmwPri $FmwPri

. ** of spouse
. local casSpo $CasSpo

. local fullSpo $FullSpo

. local selfSpo $SelfSpo

. local sideSpo $SideSpo

. local fmwSpo $FmwSpo

. 
. * 1. rename vars. of experience
. local empStatus cas full self side fmw

. local num_m: word count `empStatus'

. local resp_i $Resp_i

. local age_t $Age_t

. 
. if `resp_i'==1{
.         local expVar casPri fullPri selfPri sidePri fmwPri
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. else {
.         local expVar casSpo fullSpo selfSpo sideSpo fmwSpo
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. sum $ExpList

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       cas18 |      4,005    8.578527     1.78744          1          9
       cas19 |      4,005    8.482647    1.967775          1          9
       cas20 |      4,005    8.434707    2.050327          1          9
       cas21 |      4,005    8.444694    2.033498          1          9
       cas22 |      4,005    8.444694    2.033498          1          9
-------------+---------------------------------------------------------
       cas23 |      4,005    8.430712    2.057006          1          9
       cas24 |      4,005    8.460674    2.006175          1          9
       cas25 |      4,005    8.488639    1.957129          1          9
       cas26 |      4,005    8.484644    1.964235          1          9
       cas27 |      4,005    8.500624    1.935605          1          9
-------------+---------------------------------------------------------
       cas28 |      4,005    8.540574    1.861504          1          9
       cas29 |      4,005    8.556554    1.830781          1          9
       cas30 |      4,005    8.620474    1.700849          1          9
       cas31 |      4,005    8.610487    1.721954          1          9
       cas32 |      4,005    8.580524    1.783435          1          9
-------------+---------------------------------------------------------
       cas33 |      4,005    8.566542    1.811242          1          9
       cas34 |      4,005    8.562547    1.819089          1          9
       cas35 |      4,005    8.570537    1.803352          1          9
       cas36 |      4,005    8.540574    1.861504          1          9
       cas37 |      4,005    8.536579    1.869085          1          9
-------------+---------------------------------------------------------
       cas38 |      4,005    8.514607    1.910092          1          9
       cas39 |      4,005    8.494632    1.946406          1          9
       cas40 |      4,005    8.442697    2.036879          1          9
       cas41 |      4,005    8.440699    2.040252          1          9
       cas42 |      4,005    8.428714    2.060335          1          9
-------------+---------------------------------------------------------
       cas43 |      4,005    8.440699    2.040252          1          9
       cas44 |      4,005    8.472659    1.985352          1          9
       cas45 |      4,005    8.470662    1.988843          1          9
       cas46 |      4,005    8.478652    1.974831          1          9
       cas47 |      4,005    8.496629    1.942814          1          9
-------------+---------------------------------------------------------
       cas48 |      4,005    8.522597    1.895312          1          9
       cas49 |      4,005    8.544569    1.853884          1          9
       cas50 |      4,005    8.568539    1.807303          1          9
       cas51 |      4,005    8.604494    1.734466          1          9
       cas52 |      4,005    8.642447    1.653258          1          9
-------------+---------------------------------------------------------
       cas53 |      4,005    8.678402    1.571616          1          9
       cas54 |      4,005    8.702372     1.51427          1          9
       cas55 |      4,005    8.732335    1.438817          1          9
       cas56 |      4,005    8.772285     1.33053          1          9
       cas57 |      4,005    8.810237    1.217564          1          9
-------------+---------------------------------------------------------
       cas58 |      4,005    8.818227    1.192265          1          9
       cas59 |      4,005     8.83221    1.146515          1          9
       cas60 |      4,005    8.846192    1.098684          1          9
       cas61 |      4,005    8.852185     1.07748          1          9
       cas62 |      4,005     8.87216    1.003309          1          9
-------------+---------------------------------------------------------
       cas63 |      4,005    8.886142     .947693          1          9
       cas64 |      4,005     8.90412    .8706535          1          9
       cas65 |      4,005    8.934082    .7232747          1          9
       cas66 |      4,005    8.954057    .6045834          1          9
       cas67 |      4,005     8.96005    .5639893          1          9
-------------+---------------------------------------------------------
       cas68 |      4,005    8.974032    .4551019          1          9
      full18 |      4,005     6.04769    3.860838          1          9
      full19 |      4,005    5.456429     3.97437          1          9
      full20 |      4,005    5.120849    3.998673          1          9
      full21 |      4,005    4.615481    3.981972          1          9
-------------+---------------------------------------------------------
      full22 |      4,005     4.38377    3.952741          1          9
      full23 |      4,005    4.036205    3.882636          1          9
      full24 |      4,005     4.16804    3.913012          1          9
      full25 |      4,005      4.4397    3.961058          1          9
      full26 |      4,005    4.699376    3.989185          1          9
-------------+---------------------------------------------------------
      full27 |      4,005    4.959051     4.00029          1          9
      full28 |      4,005    5.250687    3.992635          1          9
      full29 |      4,005    5.428464    3.977483          1          9
      full30 |      4,005    5.530337    3.965182          1          9
      full31 |      4,005    5.706117    3.937673          1          9
-------------+---------------------------------------------------------
      full32 |      4,005    5.829963    3.913437          1          9
      full33 |      4,005    5.947815    3.886569          1          9
      full34 |      4,005    6.019725     3.86832          1          9
      full35 |      4,005    6.089638    3.849206          1          9
      full36 |      4,005    6.203496    3.815132          1          9
-------------+---------------------------------------------------------
      full37 |      4,005    6.281398    3.789671          1          9
      full38 |      4,005    6.339326    3.769583          1          9
      full39 |      4,005    6.403246    3.746252          1          9
      full40 |      4,005    6.469164    3.720889          1          9
      full41 |      4,005    6.599001    3.666954          1          9
-------------+---------------------------------------------------------
      full42 |      4,005    6.662921    3.638406          1          9
      full43 |      4,005    6.726841      3.6085          1          9
      full44 |      4,005    6.812734    3.566114          1          9
      full45 |      4,005    6.874657    3.533947          1          9
      full46 |      4,005    6.988514    3.471141          1          9
-------------+---------------------------------------------------------
      full47 |      4,005    7.068414    3.424119          1          9
      full48 |      4,005    7.174282    3.357873          1          9
      full49 |      4,005    7.258177    3.302023          1          9
      full50 |      4,005     7.32809    3.253097          1          9
      full51 |      4,005    7.459925    3.154561          1          9
-------------+---------------------------------------------------------
      full52 |      4,005    7.545818    3.085642          1          9
      full53 |      4,005     7.64769    2.998663          1          9
      full54 |      4,005    7.717603    2.935436          1          9
      full55 |      4,005    7.857428    2.799475          1          9
      full56 |      4,005    7.983271    2.664933          1          9
-------------+---------------------------------------------------------
      full57 |      4,005    8.085144    2.546273          1          9
      full58 |      4,005    8.167041    2.443633          1          9
      full59 |      4,005    8.278901    2.291313          1          9
      full60 |      4,005    8.344819    2.193943          1          9
      full61 |      4,005    8.670412    1.590191          1          9
-------------+---------------------------------------------------------
      full62 |      4,005    8.732335    1.438817          1          9
      full63 |      4,005     8.80824    1.223799          1          9
      full64 |      4,005    8.862172    1.041103          1          9
      full65 |      4,005    8.892135    .9227671          1          9
      full66 |      4,005     8.93608    .7123214          1          9
-------------+---------------------------------------------------------
      full67 |      4,005     8.96005    .5639893          1          9
      full68 |      4,005    8.974032    .4551019          1          9
      self18 |      4,005    8.802247    1.242297          1          9
      self19 |      4,005    8.754307    1.380454          1          9
      self20 |      4,005    8.718352    1.474585          1          9
-------------+---------------------------------------------------------
      self21 |      4,005    8.668414    1.594795          1          9
      self22 |      4,005    8.614482     1.71355          1          9
      self23 |      4,005    8.538577      1.8653          1          9
      self24 |      4,005    8.482647    1.967775          1          9
      self25 |      4,005    8.436704    2.046976          1          9
-------------+---------------------------------------------------------
      self26 |      4,005    8.390762     2.12223          1          9
      self27 |      4,005    8.364794    2.163176          1          9
      self28 |      4,005    8.336829     2.20608          1          9
      self29 |      4,005    8.304869    2.253688          1          9
      self30 |      4,005    8.274906    2.297021          1          9
-------------+---------------------------------------------------------
      self31 |      4,005    8.244944    2.339168          1          9
      self32 |      4,005    8.244944    2.339168          1          9
      self33 |      4,005    8.242946    2.341937          1          9
      self34 |      4,005    8.234956    2.352964          1          9
      self35 |      4,005    8.234956    2.352964          1          9
-------------+---------------------------------------------------------
      self36 |      4,005    8.238951     2.34746          1          9
      self37 |      4,005    8.242946    2.341937          1          9
      self38 |      4,005    8.258926    2.319643          1          9
      self39 |      4,005    8.264919    2.311199          1          9
      self40 |      4,005    8.268914    2.305543          1          9
-------------+---------------------------------------------------------
      self41 |      4,005    8.278901    2.291313          1          9
      self42 |      4,005    8.280899    2.288451          1          9
      self43 |      4,005    8.286891    2.279834          1          9
      self44 |      4,005    8.302871    2.256615          1          9
      self45 |      4,005    8.310861    2.244873          1          9
-------------+---------------------------------------------------------
      self46 |      4,005    8.338826    2.203055          1          9
      self47 |      4,005    8.358801    2.172471          1          9
      self48 |      4,005    8.374782    2.147557          1          9
      self49 |      4,005    8.380774    2.138109          1          9
      self50 |      4,005    8.400749    2.106185          1          9
-------------+---------------------------------------------------------
      self51 |      4,005    8.428714    2.060335          1          9
      self52 |      4,005    8.468664    1.992325          1          9
      self53 |      4,005    8.494632    1.946406          1          9
      self54 |      4,005    8.542572    1.857699          1          9
      self55 |      4,005    8.558552    1.826894          1          9
-------------+---------------------------------------------------------
      self56 |      4,005    8.604494    1.734466          1          9
      self57 |      4,005    8.656429    1.622091          1          9
      self58 |      4,005    8.690387    1.543256          1          9
      self59 |      4,005    8.706367    1.504463          1          9
      self60 |      4,005    8.716355    1.479613          1          9
-------------+---------------------------------------------------------
      self61 |      4,005    8.764295    1.352976          1          9
      self62 |      4,005    8.802247    1.242297          1          9
      self63 |      4,005    8.826217    1.166362          1          9
      self64 |      4,005    8.860175    1.048487          1          9
      self65 |      4,005    8.890137    .9311542          1          9
-------------+---------------------------------------------------------
      self66 |      4,005    8.914107    .8245807          1          9
      self67 |      4,005     8.92809    .7551505          1          9
      self68 |      4,005    8.954057    .6045834          1          9
      side18 |      4,005    8.988015    .3094518          1          9
      side19 |      4,005     8.98402    .3572348          1          9
-------------+---------------------------------------------------------
      side20 |      4,005    8.978027    .4187377          1          9
      side21 |      4,005    8.972035    .4722224          1          9
      side22 |      4,005    8.966042    .5201681          1          9
      side23 |      4,005    8.950062    .6301635          1          9
      side24 |      4,005     8.92809    .7551505          1          9
-------------+---------------------------------------------------------
      side25 |      4,005    8.914107    .8245807          1          9
      side26 |      4,005    8.874157    .9955665          1          9
      side27 |      4,005    8.886142     .947693          1          9
      side28 |      4,005    8.874157    .9955665          1          9
      side29 |      4,005    8.858177    1.055816          1          9
-------------+---------------------------------------------------------
      side30 |      4,005    8.838202    1.126286          1          9
      side31 |      4,005    8.850187    1.084598          1          9
      side32 |      4,005    8.830212    1.153172          1          9
      side33 |      4,005    8.820225    1.185847          1          9
      side34 |      4,005    8.834207    1.139815          1          9
-------------+---------------------------------------------------------
      side35 |      4,005      8.8402    1.119455          1          9
      side36 |      4,005    8.830212    1.153172          1          9
      side37 |      4,005    8.850187    1.084598          1          9
      side38 |      4,005    8.862172    1.041103          1          9
      side39 |      4,005     8.88015    .9719431          1          9
-------------+---------------------------------------------------------
      side40 |      4,005    8.890137    .9311542          1          9
      side41 |      4,005    8.908115    .8525372          1          9
      side42 |      4,005    8.910112    .8433261          1          9
      side43 |      4,005    8.902122    .8795649          1          9
      side44 |      4,005     8.90412    .8706535          1          9
-------------+---------------------------------------------------------
      side45 |      4,005    8.906117    .8616453          1          9
      side46 |      4,005    8.914107    .8245807          1          9
      side47 |      4,005     8.91211    .8340085          1          9
      side48 |      4,005    8.918102    .8053793          1          9
      side49 |      4,005    8.930087    .7446822          1          9
-------------+---------------------------------------------------------
      side50 |      4,005    8.924095    .7756478          1          9
      side51 |      4,005    8.930087    .7446822          1          9
      side52 |      4,005    8.940075    .6898758          1          9
      side53 |      4,005    8.942072    .6783657          1          9
      side54 |      4,005     8.95206    .6175092          1          9
-------------+---------------------------------------------------------
      side55 |      4,005    8.958052    .5778445          1          9
      side56 |      4,005    8.958052    .5778445          1          9
      side57 |      4,005    8.962047    .5497777          1          9
      side58 |      4,005    8.966042    .5201681          1          9
      side59 |      4,005    8.966042    .5201681          1          9
-------------+---------------------------------------------------------
      side60 |      4,005    8.972035    .4722224          1          9
      side61 |      4,005     8.98402    .3572348          1          9
      side62 |      4,005     8.98402    .3572348          1          9
      side63 |      4,005     8.99201    .2527295          1          9
      side64 |      4,005    8.994007    .2188975          1          9
-------------+---------------------------------------------------------
      side65 |      4,005    8.994007    .2188975          1          9
      side66 |      4,005    8.998002    .1264121          1          9
      side67 |      4,005    8.998002    .1264121          1          9
      side68 |      4,005           9           0          9          9
       fmw18 |      4,005    8.852185     1.07748          1          9
-------------+---------------------------------------------------------
       fmw19 |      4,005     8.83221    1.146515          1          9
       fmw20 |      4,005    8.794257    1.266496          1          9
       fmw21 |      4,005     8.74432    1.407326          1          9
       fmw22 |      4,005    8.702372     1.51427          1          9
       fmw23 |      4,005    8.656429    1.622091          1          9
-------------+---------------------------------------------------------
       fmw24 |      4,005    8.602497    1.738612          1          9
       fmw25 |      4,005    8.578527     1.78744          1          9
       fmw26 |      4,005    8.554557    1.834657          1          9
       fmw27 |      4,005    8.528589     1.88413          1          9
       fmw28 |      4,005    8.532584    1.876627          1          9
-------------+---------------------------------------------------------
       fmw29 |      4,005    8.536579    1.869085          1          9
       fmw30 |      4,005    8.538577      1.8653          1          9
       fmw31 |      4,005    8.548564    1.846224          1          9
       fmw32 |      4,005    8.576529    1.791435          1          9
       fmw33 |      4,005    8.594507    1.755075          1          9
-------------+---------------------------------------------------------
       fmw34 |      4,005    8.598502    1.746868          1          9
       fmw35 |      4,005    8.608489    1.726137          1          9
       fmw36 |      4,005    8.616479    1.709329          1          9
       fmw37 |      4,005    8.632459    1.675094          1          9
       fmw38 |      4,005    8.642447    1.653258          1          9
-------------+---------------------------------------------------------
       fmw39 |      4,005    8.666417    1.599383          1          9
       fmw40 |      4,005    8.686392    1.552777          1          9
       fmw41 |      4,005     8.70437    1.509376          1          9
       fmw42 |      4,005    8.726342    1.454271          1          9
       fmw43 |      4,005    8.732335    1.438817          1          9
-------------+---------------------------------------------------------
       fmw44 |      4,005    8.742322     1.41263          1          9
       fmw45 |      4,005    8.742322     1.41263          1          9
       fmw46 |      4,005     8.75231    1.385876          1          9
       fmw47 |      4,005      8.7603    1.364042          1          9
       fmw48 |      4,005    8.766292    1.347404          1          9
-------------+---------------------------------------------------------
       fmw49 |      4,005     8.77628    1.319146          1          9
       fmw50 |      4,005    8.782272     1.30186          1          9
       fmw51 |      4,005     8.79226    1.272466          1          9
       fmw52 |      4,005    8.802247    1.242297          1          9
       fmw53 |      4,005    8.820225    1.185847          1          9
-------------+---------------------------------------------------------
       fmw54 |      4,005    8.836205    1.133073          1          9
       fmw55 |      4,005    8.862172    1.041103          1          9
       fmw56 |      4,005    8.866167    1.026164          1          9
       fmw57 |      4,005     8.88814    .9394621          1          9
       fmw58 |      4,005    8.894132    .9142987          1          9
-------------+---------------------------------------------------------
       fmw59 |      4,005    8.902122    .8795649          1          9
       fmw60 |      4,005    8.902122    .8795649          1          9
       fmw61 |      4,005    8.910112    .8433261          1          9
       fmw62 |      4,005     8.92809    .7551505          1          9
       fmw63 |      4,005     8.94407     .666651          1          9
-------------+---------------------------------------------------------
       fmw64 |      4,005     8.95206    .6175092          1          9
       fmw65 |      4,005    8.966042    .5201681          1          9
       fmw66 |      4,005    8.978027    .4187377          1          9
       fmw67 |      4,005    8.982022    .3788573          1          9
       fmw68 |      4,005    8.986017    .3342044          1          9

. 
end of do-file
 replace id of principle 
(4,005 real changes made)
 make household head dummy  
(4,005 missing values generated)
(2,027 real changes made)
(1,978 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
         8 |         .          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .51250428  .48895028 | .50611735
(4,005 missing values generated)
(4,005 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      4,005       22003    1156.288      20001      24005
          pri[4005,283]
 ** Rename variables of renameListSpo 
 rename variable of experience 

. *******************************************************
. *Title: Renamevar_Exp
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables of working experience
. * 
. * 1. rename vars. of experience
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. * set list of variables
. ** of principal
. local casPri $CasPri

. local fullPri $FullPri

. local selfPri $SelfPri

. local sidePri $SidePri

. local fmwPri $FmwPri

. ** of spouse
. local casSpo $CasSpo

. local fullSpo $FullSpo

. local selfSpo $SelfSpo

. local sideSpo $SideSpo

. local fmwSpo $FmwSpo

. 
. * 1. rename vars. of experience
. local empStatus cas full self side fmw

. local num_m: word count `empStatus'

. local resp_i $Resp_i

. local age_t $Age_t

. 
. if `resp_i'==1{
.         local expVar casPri fullPri selfPri sidePri fmwPri
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. else {
.         local expVar casSpo fullSpo selfSpo sideSpo fmwSpo
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. sum $ExpList

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       cas18 |      4,005    8.511111    1.332071          1          9
       cas19 |      4,005    8.463171    1.452186          1          9
       cas20 |      4,005    8.465169    1.447412          1          9
       cas21 |      4,005    8.437203    1.512639          1          9
       cas22 |      4,005    8.429213    1.530671          1          9
-------------+---------------------------------------------------------
       cas23 |      4,005    8.387266    1.621406          1          9
       cas24 |      4,005    8.391261    1.613032          1          9
       cas25 |      4,005    8.429213    1.530671          1          9
       cas26 |      4,005    8.437203    1.512639          1          9
       cas27 |      4,005    8.445194    1.494347          1          9
-------------+---------------------------------------------------------
       cas28 |      4,005    8.455181    1.471101          1          9
       cas29 |      4,005    8.445194    1.494347          1          9
       cas30 |      4,005    8.427216    1.535139          1          9
       cas31 |      4,005    8.433208    1.521687          1          9
       cas32 |      4,005    8.423221    1.544029          1          9
-------------+---------------------------------------------------------
       cas33 |      4,005    8.415231    1.561627          1          9
       cas34 |      4,005    8.401248    1.591859          1          9
       cas35 |      4,005    8.395256    1.604604          1          9
       cas36 |      4,005    8.403246    1.587583          1          9
       cas37 |      4,005    8.379276    1.637998          1          9
-------------+---------------------------------------------------------
       cas38 |      4,005    8.353308    1.690535          1          9
       cas39 |      4,005    8.357303    1.682585          1          9
       cas40 |      4,005    8.371286    1.654384          1          9
       cas41 |      4,005    8.355306    1.686566          1          9
       cas42 |      4,005    8.355306    1.686566          1          9
-------------+---------------------------------------------------------
       cas43 |      4,005    8.353308    1.690535          1          9
       cas44 |      4,005    8.365293    1.666543          1          9
       cas45 |      4,005    8.359301    1.678593          1          9
       cas46 |      4,005    8.365293    1.666543          1          9
       cas47 |      4,005    8.387266    1.621406          1          9
-------------+---------------------------------------------------------
       cas48 |      4,005    8.399251    1.596121          1          9
       cas49 |      4,005    8.407241    1.578988          1          9
       cas50 |      4,005    8.447191    1.489732          1          9
       cas51 |      4,005    8.461174    1.456942          1          9
       cas52 |      4,005    8.477154    1.418372          1          9
-------------+---------------------------------------------------------
       cas53 |      4,005    8.509114    1.337326          1          9
       cas54 |      4,005    8.547066    1.233116          1          9
       cas55 |      4,005    8.553059    1.215737          1          9
       cas56 |      4,005    8.577029    1.143269          1          9
       cas57 |      4,005    8.587016    1.111529          1          9
-------------+---------------------------------------------------------
       cas58 |      4,005    8.599001    1.072077          1          9
       cas59 |      4,005    8.624969    .9806702          1          9
       cas60 |      4,005    8.630961     .958239          1          9
       cas61 |      4,005    8.622971     .988026          1          9
       cas62 |      4,005    8.628964    .9657781          1          9
-------------+---------------------------------------------------------
       cas63 |      4,005    8.648939    .8873075          1          9
       cas64 |      4,005    8.662921     .827678          1          9
       cas65 |      4,005    8.684894    .7235748          1          9
       cas66 |      4,005    8.688889    .7029188          1          9
       cas67 |      4,005    8.694881    .6706985          1          9
-------------+---------------------------------------------------------
       cas68 |      4,005    8.700874    .6367937          1          9
      full18 |      4,005    6.627466    3.384684          1          9
      full19 |      4,005    6.094132    3.592766          1          9
      full20 |      4,005    5.842447    3.659986          1          9
      full21 |      4,005    5.480899    3.724792          1          9
-------------+---------------------------------------------------------
      full22 |      4,005    5.299126    3.743781          1          9
      full23 |      4,005    4.969538    3.755591          1          9
      full24 |      4,005    5.097378    3.754452          1          9
      full25 |      4,005    5.255181    3.747034          1          9
      full26 |      4,005    5.456929    3.727809          1          9
-------------+---------------------------------------------------------
      full27 |      4,005    5.606742    3.706368          1          9
      full28 |      4,005    5.730587    3.683952          1          9
      full29 |      4,005    5.874407    3.652481          1          9
      full30 |      4,005    5.986267    3.623869          1          9
      full31 |      4,005    6.108115    3.588477          1          9
-------------+---------------------------------------------------------
      full32 |      4,005    6.148065    3.575893          1          9
      full33 |      4,005    6.221973     3.55131          1          9
      full34 |      4,005     6.28789    3.527934          1          9
      full35 |      4,005     6.33583    3.510058          1          9
      full36 |      4,005    6.397753    3.485856          1          9
-------------+---------------------------------------------------------
      full37 |      4,005    6.469663    3.456146          1          9
      full38 |      4,005    6.525593    3.431819          1          9
      full39 |      4,005    6.595506    3.399871          1          9
      full40 |      4,005    6.667416    3.365178          1          9
      full41 |      4,005    6.755306     3.32017          1          9
-------------+---------------------------------------------------------
      full42 |      4,005    6.827216    3.281134          1          9
      full43 |      4,005    6.903121    3.237687          1          9
      full44 |      4,005    6.937079    3.217481          1          9
      full45 |      4,005    6.999001     3.17937          1          9
      full46 |      4,005    7.076904    3.129023          1          9
-------------+---------------------------------------------------------
      full47 |      4,005    7.132834    3.091161          1          9
      full48 |      4,005    7.202747    3.041725          1          9
      full49 |      4,005    7.276654    2.986795          1          9
      full50 |      4,005    7.354557     2.92576          1          9
      full51 |      4,005    7.456429    2.840747          1          9
-------------+---------------------------------------------------------
      full52 |      4,005     7.51236    2.791392          1          9
      full53 |      4,005    7.628215    2.682565          1          9
      full54 |      4,005    7.692135    2.618395          1          9
      full55 |      4,005    7.805993    2.495964          1          9
      full56 |      4,005    7.909863    2.374022          1          9
-------------+---------------------------------------------------------
      full57 |      4,005    7.981773    2.283025          1          9
      full58 |      4,005    8.043695    2.199773          1          9
      full59 |      4,005     8.10362    2.114363          1          9
      full60 |      4,005    8.159551    2.029813          1          9
      full61 |      4,005    8.425218    1.539592          1          9
-------------+---------------------------------------------------------
      full62 |      4,005    8.479151    1.413464          1          9
      full63 |      4,005    8.531086    1.278167          1          9
      full64 |      4,005    8.593009    1.091998          1          9
      full65 |      4,005    8.614981    1.016878          1          9
      full66 |      4,005    8.674906    .7727127          1          9
-------------+---------------------------------------------------------
      full67 |      4,005    8.692884    .6816137          1          9
      full68 |      4,005    8.698876    .6482985          1          9
      self18 |      4,005    8.563046    1.186139          1          9
      self19 |      4,005    8.535081    1.267073          1          9
      self20 |      4,005    8.497129    1.368368          1          9
-------------+---------------------------------------------------------
      self21 |      4,005    8.441199    1.503526          1          9
      self22 |      4,005    8.391261    1.613032          1          9
      self23 |      4,005    8.347316    1.702373          1          9
      self24 |      4,005    8.319351     1.75629          1          9
      self25 |      4,005    8.281398    1.826234          1          9
-------------+---------------------------------------------------------
      self26 |      4,005    8.261423    1.861681          1          9
      self27 |      4,005    8.239451    1.899667          1          9
      self28 |      4,005    8.215481    1.939973          1          9
      self29 |      4,005    8.197503    1.969471          1          9
      self30 |      4,005    8.181523    1.995189          1          9
-------------+---------------------------------------------------------
      self31 |      4,005    8.177528    2.001546          1          9
      self32 |      4,005    8.167541    2.017319          1          9
      self33 |      4,005    8.167541    2.017319          1          9
      self34 |      4,005    8.153558    2.039113          1          9
      self35 |      4,005    8.155556     2.03602          1          9
-------------+---------------------------------------------------------
      self36 |      4,005    8.147566    2.048353          1          9
      self37 |      4,005    8.147566    2.048353          1          9
      self38 |      4,005    8.139576    2.060582          1          9
      self39 |      4,005    8.141573    2.057535          1          9
      self40 |      4,005    8.137578    2.063623          1          9
-------------+---------------------------------------------------------
      self41 |      4,005    8.131586    2.072708          1          9
      self42 |      4,005    8.129588    2.075723          1          9
      self43 |      4,005    8.137578    2.063623          1          9
      self44 |      4,005    8.153558    2.039113          1          9
      self45 |      4,005    8.157553     2.03292          1          9
-------------+---------------------------------------------------------
      self46 |      4,005    8.203496    1.959706          1          9
      self47 |      4,005    8.207491    1.953159          1          9
      self48 |      4,005    8.227466    1.919963          1          9
      self49 |      4,005    8.239451    1.899667          1          9
      self50 |      4,005    8.267416    1.851141          1          9
-------------+---------------------------------------------------------
      self51 |      4,005    8.303371    1.786172          1          9
      self52 |      4,005    8.311361    1.771312          1          9
      self53 |      4,005    8.327341    1.741101          1          9
      self54 |      4,005    8.357303    1.682585          1          9
      self55 |      4,005    8.395256    1.604604          1          9
-------------+---------------------------------------------------------
      self56 |      4,005    8.419226    1.552858          1          9
      self57 |      4,005    8.443196    1.498945          1          9
      self58 |      4,005    8.465169    1.447412          1          9
      self59 |      4,005    8.465169    1.447412          1          9
      self60 |      4,005    8.479151    1.413464          1          9
-------------+---------------------------------------------------------
      self61 |      4,005    8.521099    1.305436          1          9
      self62 |      4,005    8.551061     1.22156          1          9
      self63 |      4,005    8.577029    1.143269          1          9
      self64 |      4,005    8.591011     1.09855          1          9
      self65 |      4,005    8.602996     1.05857          1          9
-------------+---------------------------------------------------------
      self66 |      4,005    8.616979    1.009748          1          9
      self67 |      4,005    8.642946    .9116042          1          9
      self68 |      4,005    8.664919    .8187856          1          9
      side18 |      4,005    8.714856    .5493539          1          9
      side19 |      4,005    8.710861    .5757282          1          9
-------------+---------------------------------------------------------
      side20 |      4,005    8.706866    .6009195          1          9
      side21 |      4,005    8.698876    .6482985          1          9
      side22 |      4,005    8.692884    .6816137          1          9
      side23 |      4,005    8.676904    .7631487          1          9
      side24 |      4,005    8.662921     .827678          1          9
-------------+---------------------------------------------------------
      side25 |      4,005    8.650936    .8790503          1          9
      side26 |      4,005    8.646941    .8954842          1          9
      side27 |      4,005    8.644944    .9035824          1          9
      side28 |      4,005    8.640949    .9195518          1          9
      side29 |      4,005    8.634956    .9429673          1          9
-------------+---------------------------------------------------------
      side30 |      4,005    8.628964    .9657781          1          9
      side31 |      4,005    8.620974    .9953235          1          9
      side32 |      4,005    8.620974    .9953235          1          9
      side33 |      4,005    8.624969    .9806702          1          9
      side34 |      4,005    8.628964    .9657781          1          9
-------------+---------------------------------------------------------
      side35 |      4,005    8.622971     .988026          1          9
      side36 |      4,005    8.622971     .988026          1          9
      side37 |      4,005    8.628964    .9657781          1          9
      side38 |      4,005    8.634956    .9429673          1          9
      side39 |      4,005    8.634956    .9429673          1          9
-------------+---------------------------------------------------------
      side40 |      4,005    8.634956    .9429673          1          9
      side41 |      4,005    8.640949    .9195518          1          9
      side42 |      4,005    8.640949    .9195518          1          9
      side43 |      4,005    8.642946    .9116042          1          9
      side44 |      4,005    8.652934    .8707103          1          9
-------------+---------------------------------------------------------
      side45 |      4,005    8.658926    .8451681          1          9
      side46 |      4,005    8.662921     .827678          1          9
      side47 |      4,005    8.662921     .827678          1          9
      side48 |      4,005    8.664919    .8187856          1          9
      side49 |      4,005    8.674906    .7727127          1          9
-------------+---------------------------------------------------------
      side50 |      4,005    8.674906    .7727127          1          9
      side51 |      4,005    8.678901    .7534581          1          9
      side52 |      4,005    8.682896    .7336766          1          9
      side53 |      4,005    8.684894    .7235748          1          9
      side54 |      4,005    8.692884    .6816137          1          9
-------------+---------------------------------------------------------
      side55 |      4,005    8.696879    .6595966          1          9
      side56 |      4,005    8.698876    .6482985          1          9
      side57 |      4,005    8.702871    .6250708          1          9
      side58 |      4,005    8.704869    .6131173          1          9
      side59 |      4,005    8.710861    .5757282          1          9
-------------+---------------------------------------------------------
      side60 |      4,005    8.716854    .5356689          1          9
      side61 |      4,005    8.716854    .5356689          1          9
      side62 |      4,005    8.718851    .5216173          1          9
      side63 |      4,005    8.720849    .5071687          1          9
      side64 |      4,005    8.722846    .4922881          1          9
-------------+---------------------------------------------------------
      side65 |      4,005    8.722846    .4922881          1          9
      side66 |      4,005    8.726841    .4610624          1          9
      side67 |      4,005    8.726841    .4610624          1          9
      side68 |      4,005    8.728839    .4446145          8          9
       fmw18 |      4,005    8.636954    .9352315          1          9
-------------+---------------------------------------------------------
       fmw19 |      4,005    8.616979    1.009748          1          9
       fmw20 |      4,005    8.597004    1.078762          1          9
       fmw21 |      4,005    8.561049    1.192124          1          9
       fmw22 |      4,005    8.541074    1.250224          1          9
       fmw23 |      4,005    8.511111    1.332071          1          9
-------------+---------------------------------------------------------
       fmw24 |      4,005    8.463171    1.452186          1          9
       fmw25 |      4,005    8.443196    1.498945          1          9
       fmw26 |      4,005    8.419226    1.552858          1          9
       fmw27 |      4,005    8.419226    1.552858          1          9
       fmw28 |      4,005    8.401248    1.591859          1          9
-------------+---------------------------------------------------------
       fmw29 |      4,005    8.387266    1.621406          1          9
       fmw30 |      4,005    8.387266    1.621406          1          9
       fmw31 |      4,005    8.385268    1.625574          1          9
       fmw32 |      4,005    8.383271    1.629728          1          9
       fmw33 |      4,005    8.385268    1.625574          1          9
-------------+---------------------------------------------------------
       fmw34 |      4,005    8.389263    1.617226          1          9
       fmw35 |      4,005    8.401248    1.591859          1          9
       fmw36 |      4,005    8.415231    1.561627          1          9
       fmw37 |      4,005    8.423221    1.544029          1          9
       fmw38 |      4,005    8.437203    1.512639          1          9
-------------+---------------------------------------------------------
       fmw39 |      4,005    8.449189      1.4851          1          9
       fmw40 |      4,005    8.451186    1.480451          1          9
       fmw41 |      4,005    8.461174    1.456942          1          9
       fmw42 |      4,005    8.467166     1.44262          1          9
       fmw43 |      4,005    8.479151    1.413464          1          9
-------------+---------------------------------------------------------
       fmw44 |      4,005    8.495131    1.373464          1          9
       fmw45 |      4,005    8.515106    1.321491          1          9
       fmw46 |      4,005    8.513109    1.326793          1          9
       fmw47 |      4,005    8.521099    1.305436          1          9
       fmw48 |      4,005    8.531086    1.278167          1          9
-------------+---------------------------------------------------------
       fmw49 |      4,005    8.533084    1.272634          1          9
       fmw50 |      4,005    8.535081    1.267073          1          9
       fmw51 |      4,005    8.543071    1.244551          1          9
       fmw52 |      4,005    8.561049    1.192124          1          9
       fmw53 |      4,005    8.575031    1.149502          1          9
-------------+---------------------------------------------------------
       fmw54 |      4,005    8.589014     1.10506          1          9
       fmw55 |      4,005    8.602996     1.05857          1          9
       fmw56 |      4,005    8.624969    .9806702          1          9
       fmw57 |      4,005    8.640949    .9195518          1          9
       fmw58 |      4,005    8.644944    .9035824          1          9
-------------+---------------------------------------------------------
       fmw59 |      4,005    8.648939    .8873075          1          9
       fmw60 |      4,005    8.656929    .8537717          1          9
       fmw61 |      4,005    8.656929    .8537717          1          9
       fmw62 |      4,005    8.664919    .8187856          1          9
       fmw63 |      4,005    8.672909    .7821546          1          9
-------------+---------------------------------------------------------
       fmw64 |      4,005    8.684894    .7235748          1          9
       fmw65 |      4,005    8.692884    .6816137          1          9
       fmw66 |      4,005    8.696879    .6595966          1          9
       fmw67 |      4,005    8.704869    .6131173          1          9
       fmw68 |      4,005    8.704869    .6131173          1          9

. 
end of do-file
 replace id of spouse and drop not married 
variable id was int now long
(4,005 real changes made)
(1,086 observations deleted)
  2,919
 make household head dummy  
(2,919 missing values generated)
(1,275 real changes made)
(1,644 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 | .98364486 | .98364486
         3 | .01923077 | .01923077
         4 | .32142857 | .32142857
         5 | .07407407 | .07407407
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .43679342 | .43679342
(2,919 missing values generated)
(2,919 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,919    32005.91    1140.565      30001      34005
          spo[2919,283]
          pri[4005,283]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[6924,283]
          spo[2919,283]
          pri[4005,283]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 6924
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 6,924

. qui sum

. 
. *** recode size dummy
. gen osize=size

. foreach x of num 88 99{
  2.                 mvdecode size, mv(`x')
  3.         }
        size: 1889 missing values generated
        size: 141 missing values generated

. replace size=1 if size<=6
(2,642 real changes made)

. replace size=4 if size==7 | size==8
(775 real changes made)

. replace size=5 if size==9 | size==10
(933 real changes made)

. replace size=6 if size==11
(275 real changes made)

. tab osize size

           |                    size
     osize |         1          4          5          6 |     Total
-----------+--------------------------------------------+----------
         1 |       269          0          0          0 |       269 
         2 |       847          0          0          0 |       847 
         3 |       473          0          0          0 |       473 
         4 |       628          0          0          0 |       628 
         5 |       304          0          0          0 |       304 
         6 |       390          0          0          0 |       390 
         7 |         0        568          0          0 |       568 
         8 |         0        207          0          0 |       207 
         9 |         0          0        218          0 |       218 
        10 |         0          0        715          0 |       715 
        11 |         0          0          0        275 |       275 
-----------+--------------------------------------------+----------
     Total |     2,911        775        933        275 |     4,894 


. 
. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2004.dta saved

. mat drop _all

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      3,445       49.78       49.78
          2 |      3,476       50.22      100.00
------------+-----------------------------------
      Total |      6,921      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      6,924        2004           0       2004       2004

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2004m1

. disp %tm r(max)
 2004m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 16 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 16 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      6,905    1956.386    13.23375       1920       1985

. gen bym=ym(byear, bmonth)
(23 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
1920m12

. disp %tm r(max)
 1985m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(23 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           21             19
 5%           25             19
10%           28             19       Obs               6,901
25%           36             20       Sum of Wgt.       6,901

50%           47                      Mean            46.7212
                        Largest       Std. Dev.      13.24506
75%           57             78
90%           64             79       Variance       175.4315
95%           67             81       Skewness      -.0932043
99%           70             83       Kurtosis       2.007179

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
 recode missing value (9) to 0 for each employment status 
.         qui forvalues status_j = 1/`num_m'{
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
.         qui forvalues x=`age_t'/65{
.         sum we*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        we18 |      6,924    .4550838    .4980144          0          1
        we19 |      6,924    .5545927    .4970466          0          1
        we20 |      6,924     .609041    .4880005          0          1
        we21 |      6,924    .6884749    .4631503          0          1
        we22 |      6,924    .7294916    .4442545          0          1
-------------+---------------------------------------------------------
        we23 |      6,924    .7991046     .400699          0          1
        we24 |      6,924    .7928943    .4052612          0          1
        we25 |      6,924    .7690641    .4214619          0          1
        we26 |      6,924    .7462449    .4351905          0          1
        we27 |      6,924    .7205373    .4487676          0          1
-------------+---------------------------------------------------------
        we28 |      6,924     .694974    .4604517          0          1
        we29 |      6,924    .6769209    .4676864          0          1
        we30 |      6,924    .6626228    .4728489          0          1
        we31 |      6,924    .6428365    .4791982          0          1
        we32 |      6,924    .6338821     .481777          0          1
-------------+---------------------------------------------------------
        we33 |      6,924    .6220393    .4849127          0          1
        we34 |      6,924    .6123628    .4872462          0          1
        we35 |      6,924    .6019642    .4895283          0          1
        we36 |      6,924    .5902657    .4918201          0          1
        we37 |      6,924    .5765453    .4941418          0          1
-------------+---------------------------------------------------------
        we38 |      6,924     .568602    .4953072          0          1
        we39 |      6,924    .5556037    .4969345          0          1
        we40 |      6,924    .5454939     .497962          0          1
        we41 |      6,924    .5281629    .4992423          0          1
        we42 |      6,924    .5167533    .4997553          0          1
-------------+---------------------------------------------------------
        we43 |      6,924    .5043328    .5000173          0          1
        we44 |      6,924    .4880127    .4998924          0          1
        we45 |      6,924    .4750144    .4994114          0          1
        we46 |      6,924    .4536395     .497882          0          1
        we47 |      6,924     .438186    .4962002          0          1
-------------+---------------------------------------------------------
        we48 |      6,924     .418833    .4934036          0          1
        we49 |      6,924    .4023686    .4904109          0          1
        we50 |      6,924    .3827267    .4860876          0          1
        we51 |      6,924    .3560081    .4788522          0          1
        we52 |      6,924    .3356441    .4722493          0          1
-------------+---------------------------------------------------------
        we53 |      6,924    .3093588    .4622627          0          1
        we54 |      6,924    .2861063    .4519723          0          1
        we55 |      6,924    .2570768    .4370537          0          1
        we56 |      6,924    .2297805     .420722          0          1
        we57 |      6,924    .2059503    .4044235          0          1
-------------+---------------------------------------------------------
        we58 |      6,924    .1890526    .3915787          0          1
        we59 |      6,924    .1722992    .3776676          0          1
        we60 |      6,924    .1581456    .3649038          0          1
        we61 |      6,924    .1083189    .3108052          0          1
        we62 |      6,924    .0914211    .2882279          0          1
-------------+---------------------------------------------------------
        we63 |      6,924    .0742345    .2621711          0          1
        we64 |      6,924    .0584922    .2346888          0          1
        we65 |      6,924    .0465049    .2105911          0          1
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de

                           workexp
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            2              0
10%            5              0       Obs               6,924
25%           10              0       Sum of Wgt.       6,924

50%           21                      Mean           22.33507
                        Largest       Std. Dev.      13.81814
75%           34             48
90%           42             48       Variance        190.941
95%           45             48       Skewness        .166936
99%           48             48       Kurtosis       1.842831
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
.         sum workexp
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
empsinceyear: 1889 missing values generated
empsinceyear: 309 missing values generated
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
empsincemo~h: 1889 missing values generated
empsincemo~h: 309 missing values generated
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
(2,455 missing values generated)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
 1949m4
.         disp %tm r(max)
 2004m4
.         
.         gen emptenure=(svyym-empym)
(2,455 missing values generated)
.         label var emptenure "Tenure months" 
.         sum emptenure, de

                        Tenure months
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0             -3
 5%            4             -3
10%           10             -3       Obs               4,469
25%           33             -3       Sum of Wgt.       4,469

50%          115                      Mean           157.1249
                        Largest       Std. Dev.       144.054
75%          249            620
90%          381            621       Variance       20751.55
95%          441            657       Skewness       .9008686
99%          537            657       Kurtosis       2.861103
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
.         sum emptenure
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2004.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2005

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2005

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2005.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(990 vars, 3,314 obs)

. count
  3,314

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2005
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file rename variables in KHPS2005
. ********************************************************
. 
. * Define folder location
. local path $Path

. disp "`path' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion 

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2005

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$Varlist"


. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v76 ///
>                                 v139 ///
>                                 v171 v159 v160 v161 v164 v165 ///
>                                 v207 v183 ///
>                                 v185 v186 v187 v188 v189 v190 ///
>                                 v203 v204 v205

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,314    2006.732    1159.744          1       4005
          v4 |      3,314    1.254979    .4359151          1          2
          v5 |      3,314    1.502112     .500071          1          2
          v6 |      3,314    1957.483    13.54909       1934       1984
          v7 |      3,314    6.184068    3.539767          1         12
-------------+---------------------------------------------------------
         v76 |      3,314    2.876282    11.29976          1         99
        v139 |      3,314    2.547375     2.09732          1          9
        v171 |      3,314     31.1557    38.16976          1         99
        v159 |      3,314    3.585999    2.823834          1          9
        v160 |      3,314    30.25347    35.07797          1         99
-------------+---------------------------------------------------------
        v161 |      3,314    4.402233    2.627079          1          9
        v164 |      3,314    5.298733    2.050543          1          9
        v165 |      3,314    5.171998    2.978744          1          9
        v207 |      3,314    5.561859    15.61255          1         99
        v183 |      3,314    3.940555    2.914585          1          9
-------------+---------------------------------------------------------
        v185 |      3,314     3.85697    3.140642          1          9
        v186 |      3,314    47679.67    44354.61          6      99999
        v187 |      3,314    851801.3    176793.4       2300     999999
        v188 |      3,314      774843    297305.1        400     999999
        v189 |      3,314    85798.66    16325.34         70      99999
-------------+---------------------------------------------------------
        v190 |      3,314    27169.92    41562.73          0      99999
        v203 |      3,314    40.70006    31.59523          1         99
        v204 |      3,314    317.6098     406.535          1        999
        v205 |      3,314    485.9909    471.7495          0        999

. 
. ** variable number of spouse
. gen relno=.
(3,314 missing values generated)

. gen dsex=.
(3,314 missing values generated)

. gen bYear=.
(3,314 missing values generated)

. gen bMonth=.
(3,314 missing values generated)

. global RenameListSpo ///
>                                 v1 v4 v14 v15 v16 ///
>                                 v76 ///
>                                 v392 ///
>                                 v424 v412 v413 v414 v417 v418 ///
>                                 v460 v436 ///
>                                 v438 v439 v440 v441 v442 v443 ///
>                                 v456 v457 v458

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,314    2006.732    1159.744          1       4005
          v4 |      3,314    1.254979    .4359151          1          2
         v14 |      3,314    1.826494    1.586925          1          9
         v15 |      3,314    2435.657    1791.601       1910       9999
         v16 |      3,314    11.84128    21.31503          0         99
-------------+---------------------------------------------------------
         v76 |      3,314    2.876282    11.29976          1         99
        v392 |      3,314    4.079964    2.977722          1          9
        v424 |      3,314    47.44659    41.27166          1         99
        v412 |      3,314    4.842185     3.10664          1          9
        v413 |      3,314    46.80296    39.62486          1         99
-------------+---------------------------------------------------------
        v414 |      3,314    5.435727    2.756263          1          9
        v417 |      3,314    6.069101    2.121653          1          9
        v418 |      3,314    5.974955    2.826234          1          9
        v460 |      3,314    26.56065    38.29698          1         99
        v436 |      3,314    5.142426    3.066758          1          9
-------------+---------------------------------------------------------
        v438 |      3,314    5.009656    3.289516          1          9
        v439 |      3,314    58585.48    42187.96         10      99999
        v440 |      3,314    860359.8    156061.8       2000     999999
        v441 |      3,314      821976      234555        550     999999
        v442 |      3,314     86999.1    12897.09         52      99999
-------------+---------------------------------------------------------
        v443 |      3,314    45388.01    44933.35          0      99999
        v456 |      3,314    54.06337    34.33314          2         99
        v457 |      3,314    484.6261    430.7153          1        999
        v458 |      3,314    603.8702    437.6406          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar_OldKHPS.do"

. *******************************************************
. * Title: Renamevar_OldKHPS
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file rename variables and save cleaned data as dta,
. * applied for KHPS before 2008
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> ** KHPS(new_cohort, principal): id=original id+40000
> ** KHPS(new_cohort, spouse): id=original id+50000 (=(original id +40000)+10000)
> */
. 
. * Define folder location
. local path $Path

. local inter $Inter

. disp "`path', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Intermediate 

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2005

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         if `i'==1 {
  6.                 dis " replace id of principle "
  7.                 ** replace id (KHPS)
.                 replace id = id+20000
  8.         }
  9.         else {
 10.                 dis " replace id of spouse and drop not married "
 11.                 ** replace id (spouse)
.                 replace id = id+10000
 12.                 ** keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.         }
 15.         
.         dis " make household head dummy  "
 16.         ** make breadwinner dummy
.         gen dearnmost=.
 17.         replace dearnmost=1 if earnmost==`i'
 18.         replace dearnmost=0 if dearnmost!=1
 19.         label var dearnmost "Breadwinner dummy"
 20.         tab earnmost marital, sum(dearnmost) mean miss
 21.         
.         ** make household head dummy
.         gen dhead=.
 22.         replace dhead=dearnmost
 23.         label var dhead "HH head dummy"
 24.         
.         sum id
 25.         
.         ** save variable as matrix
.         if `i'==1{
 26.                 local matName pri
 27.         }
 28.         else {
 29.                 local matName spo
 30.         }
 31.         mkmat `matVarList', matrix(`matName')
 32.         mat dir
 33.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 34.         drop dhead dearnmost
 35. }
 ** Rename variables of renameListPri 
 replace id of principle 
(3,314 real changes made)
 make household head dummy  
(3,314 missing values generated)
(1,677 real changes made)
(1,637 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         .          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .51761847  .47218935 |   .506035
(3,314 missing values generated)
(3,314 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,314    22006.73    1159.744      20001      24005
          pri[3314,26]
 ** Rename variables of renameListSpo 
 replace id of spouse and drop not married 
variable id was int now long
(3,314 real changes made)
(845 observations deleted)
  2,469
 make household head dummy  
(2,469 missing values generated)
(1,087 real changes made)
(1,382 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .44025921 | .44025921
(2,469 missing values generated)
(2,469 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,469    32005.31    1150.975      30001      34005
          spo[2469,26]
          pri[3314,26]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[5783,26]
          spo[2469,26]
          pri[3314,26]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 5783
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 5,783

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2005.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,865       49.54       49.54
          2 |      2,918       50.46      100.00
------------+-----------------------------------
      Total |      5,783      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      5,783        2005           0       2005       2005

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2005m1

. disp %tm r(max)
 2005m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 24 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 24 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      5,759    1956.474    13.10331       1920       1985

. gen bym=ym(byear, bmonth)
(24 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
1920m12

. disp %tm r(max)
 1985m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(24 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           22             20
 5%           26             20
10%           30             21       Obs               5,759
25%           37             21       Sum of Wgt.       5,759

50%           48                      Mean           47.63709
                        Largest       Std. Dev.      13.11359
75%           58             79
90%           65             80       Variance       171.9662
95%           68             82       Skewness       -.081128
99%           71             84       Kurtosis       2.025973

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(5,783 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(5,783 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2005.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2006

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2006

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2006.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(865 vars, 2,887 obs)

. count
  2,887

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2006
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file rename variables in KHPS2006
. ********************************************************
. 
. * Define folder location
. local path $Path

. disp "`path' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion 

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2006

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$Varlist"


. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v76 ///
>                                 v132 ///
>                                 v152 v153 v154 v155 v158 v159 ///
>                                 v195 v169 ///
>                                 v171 v172 v173 v174 v175 v176 ///
>                                 v189 v190 v191

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,887    2011.481    1165.258          1       4013
          v4 |      2,887    1.241427    .4280228          1          2
          v5 |      2,887    1.502598    .5000799          1          2
          v6 |      2,887     1957.39    13.40534       1934       1984
          v7 |      2,887    6.151715    3.537226          1         12
-------------+---------------------------------------------------------
         v76 |      2,887    2.341531    8.692866          1         99
        v132 |      2,887    2.602009    2.127576          1          9
        v152 |      2,887    27.98788     36.1903          1         99
        v153 |      2,887     3.54832     2.78105          1          9
        v154 |      2,887    30.11084    34.94007          1         99
-------------+---------------------------------------------------------
        v155 |      2,887    4.392449    2.603662          1          9
        v158 |      2,887    5.281607    2.056045          1          9
        v159 |      2,887    5.161413    2.993107          1          9
        v195 |      2,887    4.842051    13.32654          1         99
        v169 |      2,887    3.860062    2.903117          1          9
-------------+---------------------------------------------------------
        v171 |      2,887    3.855906    3.131893          1          9
        v172 |      2,887    47681.59    44329.57          7      99999
        v173 |      2,887    851354.8    178214.8       1100     999999
        v174 |      2,887    773054.2    299299.1        600     999999
        v175 |      2,887    85966.27     15848.1         40      99999
-------------+---------------------------------------------------------
        v176 |      2,887    26423.79    41054.41          0      99999
        v189 |      2,887    39.22965    30.62404          1         99
        v190 |      2,887    302.6037    398.0493          1        999
        v191 |      2,887    485.4628    470.9411          0        999

. 
. ** variable number of spouse
. gen relno=.
(2,887 missing values generated)

. gen dsex=.
(2,887 missing values generated)

. gen bYear=.
(2,887 missing values generated)

. gen bMonth=.
(2,887 missing values generated)

. global RenameListSpo ///
>                                 v1 v4 v14 v15 v16 ///
>                                 v76 ///
>                                 v348 ///
>                                 v368 v369 v370 v371 v374 v375 ///
>                                 v411 v385 ///
>                                 v387 v388 v389 v390 v391 v392 ///
>                                 v405 v406 v407

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,887    2011.481    1165.258          1       4013
          v4 |      2,887    1.241427    .4280228          1          2
         v14 |      2,887     1.83443    1.581342          1          9
         v15 |      2,887    2436.221     1792.29       1909       9999
         v16 |      2,887    11.89539    21.30648          0         99
-------------+---------------------------------------------------------
         v76 |      2,887    2.341531    8.692866          1         99
        v348 |      2,887    4.055767    2.934609          1          9
        v368 |      2,887    44.59785    40.85873          1         99
        v369 |      2,887    4.783166    3.105684          1          9
        v370 |      2,887    46.04676    39.58643          1         99
-------------+---------------------------------------------------------
        v371 |      2,887    5.392795    2.759886          1          9
        v374 |      2,887    6.030828    2.156093          1          9
        v375 |      2,887    6.001039    2.824565          1          9
        v411 |      2,887    25.35989    37.56994          1         99
        v385 |      2,887    5.038102    3.056627          1          9
-------------+---------------------------------------------------------
        v387 |      2,887    4.993072    3.272762          1          9
        v388 |      2,887    58803.99    42113.55          5      99999
        v389 |      2,887    860686.3    155302.3       1000     999999
        v390 |      2,887    817077.7    242436.6        500     999999
        v391 |      2,887    86604.55    14061.71         40      99999
-------------+---------------------------------------------------------
        v392 |      2,887    44092.86    44812.61          0      99999
        v405 |      2,887    52.61829    34.26055          1         99
        v406 |      2,887    470.8597    429.8503          1        999
        v407 |      2,887     603.043    438.0686          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar_OldKHPS.do"

. *******************************************************
. * Title: Renamevar_OldKHPS
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file rename variables and save cleaned data as dta,
. * applied for KHPS before 2008
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> ** KHPS(new_cohort, principal): id=original id+40000
> ** KHPS(new_cohort, spouse): id=original id+50000 (=(original id +40000)+10000)
> */
. 
. * Define folder location
. local path $Path

. local inter $Inter

. disp "`path', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Intermediate 

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2006

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         if `i'==1 {
  6.                 dis " replace id of principle "
  7.                 ** replace id (KHPS)
.                 replace id = id+20000
  8.         }
  9.         else {
 10.                 dis " replace id of spouse and drop not married "
 11.                 ** replace id (spouse)
.                 replace id = id+10000
 12.                 ** keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.         }
 15.         
.         dis " make household head dummy  "
 16.         ** make breadwinner dummy
.         gen dearnmost=.
 17.         replace dearnmost=1 if earnmost==`i'
 18.         replace dearnmost=0 if dearnmost!=1
 19.         label var dearnmost "Breadwinner dummy"
 20.         tab earnmost marital, sum(dearnmost) mean miss
 21.         
.         ** make household head dummy
.         gen dhead=.
 22.         replace dhead=dearnmost
 23.         label var dhead "HH head dummy"
 24.         
.         sum id
 25.         
.         ** save variable as matrix
.         if `i'==1{
 26.                 local matName pri
 27.         }
 28.         else {
 29.                 local matName spo
 30.         }
 31.         mkmat `matVarList', matrix(`matName')
 32.         mat dir
 33.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 34.         drop dhead dearnmost
 35. }
 ** Rename variables of renameListPri 
 replace id of principle 
(2,887 real changes made)
 make household head dummy  
(2,887 missing values generated)
(1,469 real changes made)
(1,418 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .50547945  .51936872 |  .5088327
(2,887 missing values generated)
(2,887 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,887    22011.48    1165.258      20001      24013
          pri[2887,26]
 ** Rename variables of renameListSpo 
 replace id of spouse and drop not married 
variable id was int now long
(2,887 real changes made)
(697 observations deleted)
  2,190
 make household head dummy  
(2,190 missing values generated)
(987 real changes made)
(1,203 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .45068493 | .45068493
(2,190 missing values generated)
(2,190 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,190    32000.28    1150.168      30001      34005
          spo[2190,26]
          pri[2887,26]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[5077,26]
          spo[2190,26]
          pri[2887,26]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 5077
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 5,077

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2006.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,508       49.40       49.40
          2 |      2,569       50.60      100.00
------------+-----------------------------------
      Total |      5,077      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      5,077        2006           0       2006       2006

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2006m1

. disp %tm r(max)
 2006m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 25 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 25 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      5,052    1956.551    12.99874       1920       1985

. gen bym=ym(byear, bmonth)
(25 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
1920m12

. disp %tm r(max)
 1985m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(25 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             21
 5%           28             21
10%           31             22       Obs               5,052
25%           38             22       Sum of Wgt.       5,052

50%           49                      Mean           48.56017
                        Largest       Std. Dev.       13.0054
75%           59             79
90%           66             80       Variance       169.1405
95%           69             83       Skewness      -.0633478
99%           72             85       Kurtosis       2.017549

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(5,077 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(5,077 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2006.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2007

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2007

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2007.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(689 vars, 2,643 obs)

. count
  2,643

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2007
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file rename variables in KHPS2007
. ********************************************************
. 
. * Define folder location
. local path $Path

. disp "`path' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion 

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2007

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$Varlist"


. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v76 ///
>                                 v138 ///
>                                 v158 v159 v160 v161 v164 v165 ///
>                                 v201 v175 ///
>                                 v177 v178 v179 v180 v181 v182 ///
>                                 v195 v196 v197

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,643    2010.806    1161.069          1       4017
          v4 |      2,643    1.238365    .4261644          1          2
          v5 |      2,643    1.509648    .5000015          1          2
          v6 |      2,643    1957.392    13.29821       1934       1984
          v7 |      2,643    6.116156    3.533946          1         12
-------------+---------------------------------------------------------
         v76 |      2,643    2.795687    11.00612          1         99
        v138 |      2,643    2.576996    2.102329          1          9
        v158 |      2,643    27.82406    36.08129          1         99
        v159 |      2,643    3.554294    2.781261          1          9
        v160 |      2,643    30.34544    35.15103          1         99
-------------+---------------------------------------------------------
        v161 |      2,643    4.407113    2.606399          1          9
        v164 |      2,643    5.298903    2.071386          1          9
        v165 |      2,643    5.187666    2.976499          1          9
        v201 |      2,643    5.617858     15.8956          1         99
        v175 |      2,643    3.961786    2.935797          1          9
-------------+---------------------------------------------------------
        v177 |      2,643    3.795308    3.119149          1          9
        v178 |      2,643    46275.35    44369.02         10      99999
        v179 |      2,643    854660.6    170235.1       1000     999999
        v180 |      2,643    778485.1    293256.7        600     999999
        v181 |      2,643    85320.85    17437.66         40      99999
-------------+---------------------------------------------------------
        v182 |      2,643    26211.09    40972.88          0      99999
        v195 |      2,643    40.13621    31.08271          1         99
        v196 |      2,643    310.2028    402.5285          1        999
        v197 |      2,643    491.5176    471.4533          0        999

. 
. ** variable number of spouse
. gen relno=.
(2,643 missing values generated)

. gen dsex=.
(2,643 missing values generated)

. gen bYear=.
(2,643 missing values generated)

. gen bMonth=.
(2,643 missing values generated)

. global RenameListSpo ///
>                                 v1 v4 v14 v15 v16 ///
>                                 v76 ///
>                                 v309 ///
>                                 v329 v330 v331 v332 v335 v336 ///
>                                 v372 v346 ///
>                                 v348 v349 v350 v351 v352 v353 ///
>                                 v366 v367 v368

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,643    2010.806    1161.069          1       4017
          v4 |      2,643    1.238365    .4261644          1          2
         v14 |      2,643     1.81574    1.551691          1          8
         v15 |      2,643    2388.651    1698.627       1910       9999
         v16 |      2,643    11.31593    20.25852          0         99
-------------+---------------------------------------------------------
         v76 |      2,643    2.795687    11.00612          1         99
        v309 |      2,643    4.004919    2.933978          1          9
        v329 |      2,643    43.67159      40.778          1         99
        v330 |      2,643    4.704124     3.11322          1          9
        v331 |      2,643     45.2448    39.49888          1         99
-------------+---------------------------------------------------------
        v332 |      2,643    5.362845     2.76694          1          9
        v335 |      2,643    6.000757    2.142889          1          9
        v336 |      2,643    5.977299    2.816132          1          9
        v372 |      2,643    26.08854    38.18466          1         99
        v346 |      2,643    5.013999    3.069007          1          9
-------------+---------------------------------------------------------
        v348 |      2,643    4.916005    3.281365          1          9
        v349 |      2,643    57773.99    42436.36         10      99999
        v350 |      2,643    860793.9    154910.9       1500     999999
        v351 |      2,643      813383    247888.5        600     999999
        v352 |      2,643     86863.1    13265.94         55      99999
-------------+---------------------------------------------------------
        v353 |      2,643    43381.34    44832.97          0      99999
        v366 |      2,643    52.92925    34.45077          1         99
        v367 |      2,643    468.7215    431.1587          1        999
        v368 |      2,643    609.6239     437.757          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar_OldKHPS.do"

. *******************************************************
. * Title: Renamevar_OldKHPS
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file rename variables and save cleaned data as dta,
. * applied for KHPS before 2008
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> ** KHPS(new_cohort, principal): id=original id+40000
> ** KHPS(new_cohort, spouse): id=original id+50000 (=(original id +40000)+10000)
> */
. 
. * Define folder location
. local path $Path

. local inter $Inter

. disp "`path', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Intermediate 

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2007

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         if `i'==1 {
  6.                 dis " replace id of principle "
  7.                 ** replace id (KHPS)
.                 replace id = id+20000
  8.         }
  9.         else {
 10.                 dis " replace id of spouse and drop not married "
 11.                 ** replace id (spouse)
.                 replace id = id+10000
 12.                 ** keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.         }
 15.         
.         dis " make household head dummy  "
 16.         ** make breadwinner dummy
.         gen dearnmost=.
 17.         replace dearnmost=1 if earnmost==`i'
 18.         replace dearnmost=0 if dearnmost!=1
 19.         label var dearnmost "Breadwinner dummy"
 20.         tab earnmost marital, sum(dearnmost) mean miss
 21.         
.         ** make household head dummy
.         gen dhead=.
 22.         replace dhead=dearnmost
 23.         label var dhead "HH head dummy"
 24.         
.         sum id
 25.         
.         ** save variable as matrix
.         if `i'==1{
 26.                 local matName pri
 27.         }
 28.         else {
 29.                 local matName spo
 30.         }
 31.         mkmat `matVarList', matrix(`matName')
 32.         mat dir
 33.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 34.         drop dhead dearnmost
 35. }
 ** Rename variables of renameListPri 
 replace id of principle 
(2,643 real changes made)
 make household head dummy  
(2,643 missing values generated)
(1,371 real changes made)
(1,272 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total |  .5171386  .52380952 | .51872872
(2,643 missing values generated)
(2,643 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,643    22010.81    1161.069      20001      24017
          pri[2643,26]
 ** Rename variables of renameListSpo 
 replace id of spouse and drop not married 
variable id was int now long
(2,643 real changes made)
(630 observations deleted)
  2,013
 make household head dummy  
(2,013 missing values generated)
(891 real changes made)
(1,122 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .44262295 | .44262295
(2,013 missing values generated)
(2,013 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,013    32013.15    1145.594      30001      34017
          spo[2013,26]
          pri[2643,26]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[4656,26]
          spo[2013,26]
          pri[2643,26]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 4656
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 4,656

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2007.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,285       49.08       49.08
          2 |      2,371       50.92      100.00
------------+-----------------------------------
      Total |      4,656      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      4,656        2007           0       2007       2007

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2007m1

. disp %tm r(max)
 2007m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 12 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 12 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      4,644    1956.646    12.89738       1922       1985

. gen bym=ym(byear, bmonth)
(12 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1922m2

. disp %tm r(max)
 1985m9

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(12 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           24             21
 5%           29             22
10%           32             22       Obs               4,644
25%           39             22       Sum of Wgt.       4,644

50%           50                      Mean           49.46533
                        Largest       Std. Dev.      12.90262
75%           60             78
90%           67             80       Variance       166.4776
95%           70             81       Skewness      -.0652878
99%           73             84       Kurtosis       2.026871

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(4,656 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(4,656 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2007.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2008

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2008

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2008.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(823 vars, 3,691 obs)

. count
  3,691

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2008
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file rename variables in KHPS2008
. ********************************************************
. 
. * Define folder location
. local path $Path

. disp "`path' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion 

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2008

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$Varlist"


. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v85 ///
>                                 v148 ///
>                                 v168 v169 v170 v171 v174 v175 ///
>                                 v215 v188 ///
>                                 v190 v191 v192 v193 v194 v195 ///
>                                 v209 v210 v211

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,691    3256.195    2002.024          1       6420
          v4 |      3,691    1.239772    .4270023          1          2
          v5 |      3,691    1.523435    .4995182          1          2
          v6 |      3,691    1958.282    13.37789       1934       1987
          v7 |      3,691    6.181794      3.5018          1         12
-------------+---------------------------------------------------------
         v85 |      3,691    2.505825    9.603842          1         99
        v148 |      3,691    2.587646    2.110395          1          9
        v168 |      3,691    27.88946    36.16283          1         99
        v169 |      3,691    3.551612    2.772147          1          9
        v170 |      3,691    29.88404    34.86808          1         99
-------------+---------------------------------------------------------
        v171 |      3,691    4.407207    2.576366          1          9
        v174 |      3,691    5.296938    2.045589          1          9
        v175 |      3,691    5.193444    2.964281          1          9
        v215 |      3,691    6.105933     17.2051          1         99
        v188 |      3,691    3.974533    2.928303          1          9
-------------+---------------------------------------------------------
        v190 |      3,691    3.801409     3.10945          1          9
        v191 |      3,691    46692.48    44354.43         10      99999
        v192 |      3,691    856557.5    165661.1       2000     999999
        v193 |      3,691    770164.5    302442.8        619     999999
        v194 |      3,691    85483.66    17059.36         40      99999
-------------+---------------------------------------------------------
        v195 |      3,691    25696.58    40699.79          0      99999
        v209 |      3,691    39.83392    31.11568          1         99
        v210 |      3,691     302.029    399.0104          1        999
        v211 |      3,691    465.4584     470.876          0        999

. 
. ** variable number of spouse
. gen relno=.
(3,691 missing values generated)

. gen dsex=.
(3,691 missing values generated)

. gen bYear=.
(3,691 missing values generated)

. gen bMonth=.
(3,691 missing values generated)

. global RenameListSpo ///
>                                 v1 v4 v14 v15 v16 ///
>                                 v85 ///
>                                 v376 ///
>                                 v396 v397 v398 v399 v402 v403 ///
>                                 v443 v416 ///
>                                 v418 v419 v420 v421 v422 v423 ///
>                                 v437 v438 v439

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,691    3256.195    2002.024          1       6420
          v4 |      3,691    1.239772    .4270023          1          2
         v14 |      3,691    1.812517    1.568168          1          9
         v15 |      3,691     2446.91    1814.597       1910       9999
         v16 |      3,691     12.0447    21.53429          0         99
-------------+---------------------------------------------------------
         v85 |      3,691    2.505825    9.603842          1         99
        v376 |      3,691    4.016527    2.938115          1          9
        v396 |      3,691    44.25413    40.88919          1         99
        v397 |      3,691    4.750745    3.105057          1          9
        v398 |      3,691    45.76158    39.55536          1         99
-------------+---------------------------------------------------------
        v399 |      3,691    5.374424    2.747383          1          9
        v402 |      3,691    6.026009     2.12263          1          9
        v403 |      3,691    5.945001    2.825831          1          9
        v443 |      3,691    25.82525    38.02262          1         99
        v416 |      3,691    5.042536    3.063746          1          9
-------------+---------------------------------------------------------
        v418 |      3,691    4.894879    3.290341          1          9
        v419 |      3,691    57106.28    42615.27         10      99999
        v420 |      3,691      864342    145530.3       1000     999999
        v421 |      3,691    813859.8    247059.8        500     999999
        v422 |      3,691    87009.46    12792.62         40      99999
-------------+---------------------------------------------------------
        v423 |      3,691    43060.59       44748          0      99999
        v437 |      3,691    53.23598    34.31265          1         99
        v438 |      3,691     466.194    430.7294          1        999
        v439 |      3,691    588.5264    442.3201          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar_OldKHPS.do"

. *******************************************************
. * Title: Renamevar_OldKHPS
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file rename variables and save cleaned data as dta,
. * applied for KHPS before 2008
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> ** KHPS(new_cohort, principal): id=original id+40000
> ** KHPS(new_cohort, spouse): id=original id+50000 (=(original id +40000)+10000)
> */
. 
. * Define folder location
. local path $Path

. local inter $Inter

. disp "`path', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Intermediate 

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2008

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         if `i'==1 {
  6.                 dis " replace id of principle "
  7.                 ** replace id (KHPS)
.                 replace id = id+20000
  8.         }
  9.         else {
 10.                 dis " replace id of spouse and drop not married "
 11.                 ** replace id (spouse)
.                 replace id = id+10000
 12.                 ** keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.         }
 15.         
.         dis " make household head dummy  "
 16.         ** make breadwinner dummy
.         gen dearnmost=.
 17.         replace dearnmost=1 if earnmost==`i'
 18.         replace dearnmost=0 if dearnmost!=1
 19.         label var dearnmost "Breadwinner dummy"
 20.         tab earnmost marital, sum(dearnmost) mean miss
 21.         
.         ** make household head dummy
.         gen dhead=.
 22.         replace dhead=dearnmost
 23.         label var dhead "HH head dummy"
 24.         
.         sum id
 25.         
.         ** save variable as matrix
.         if `i'==1{
 26.                 local matName pri
 27.         }
 28.         else {
 29.                 local matName spo
 30.         }
 31.         mkmat `matVarList', matrix(`matName')
 32.         mat dir
 33.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 34.         drop dhead dearnmost
 35. }
 ** Rename variables of renameListPri 
 replace id of principle 
(3,691 real changes made)
 make household head dummy  
(3,691 missing values generated)
(1,878 real changes made)
(1,813 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          0 |         0
         9 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .50605845  .51751412 |  .5088052
(3,691 missing values generated)
(3,691 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,691    23256.19    2002.024      20001      26420
          pri[3691,26]
 ** Rename variables of renameListSpo 
 replace id of spouse and drop not married 
variable id was int now long
(3,691 real changes made)
(885 observations deleted)
  2,806
 make household head dummy  
(2,806 missing values generated)
(1,293 real changes made)
(1,513 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
         9 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .46079829 | .46079829
(2,806 missing values generated)
(2,806 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,806    33226.64    1991.107      30001      36419
          spo[2806,26]
          pri[3691,26]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[6497,26]
          spo[2806,26]
          pri[3691,26]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 6497
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 6,497

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2008.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      3,180       48.95       48.95
          2 |      3,317       51.05      100.00
------------+-----------------------------------
      Total |      6,497      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      6,497        2008           0       2008       2008

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2008m1

. disp %tm r(max)
 2008m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 30 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 30 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      6,467    1957.427    12.96303       1922       1987

. gen bym=ym(byear, bmonth)
(32 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1922m2

. disp %tm r(max)
 1987m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(32 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           24             21
 5%           28             21
10%           32             21       Obs               6,465
25%           39             21       Sum of Wgt.       6,465

50%           50                      Mean           49.67502
                        Largest       Std. Dev.      12.97105
75%           60             79
90%           67             81       Variance       168.2482
95%           70             82       Skewness      -.0802767
99%           73             85       Kurtosis       2.070726

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(6,497 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(6,497 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2008.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2009

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2009

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2009.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(884 vars, 3,422 obs)

. count
  3,422

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2009
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in KHPS 2009
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v85 v86 v87 ///
>                                 v160 ///
>                                 v180 v181 v182 v183 v186 v187 ///
>                                 v238 v195 ///
>                                 v197 v198 v199 v200 v201 v202 ///
>                                 v216 v217 v218

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,422    3239.965    1996.773          1       6421
          v4 |      3,422    1.236996    .4253019          1          2
          v5 |      3,422    1.521917    .4995924          1          2
          v6 |      3,422    1958.175    13.28186       1934       1987
          v7 |      3,422    6.176213    3.504653          1         12
-------------+---------------------------------------------------------
         v85 |      3,422    2.398013    9.112116          1         99
         v86 |      3,422    2.046756    1.058991          1          9
         v87 |      3,422    79.06137    26.21286          1         99
        v160 |      3,422    2.645237    2.137711          1          9
        v180 |      3,422    28.74868    36.58115          1         99
-------------+---------------------------------------------------------
        v181 |      3,422    3.634424    2.806519          1          9
        v182 |      3,422    30.77031    35.28376          1         99
        v183 |      3,422    4.469024    2.607312          1          9
        v186 |      3,422    5.339275    2.069185          1          9
        v187 |      3,422    5.257452    2.955194          1          9
-------------+---------------------------------------------------------
        v238 |      3,422    4.911163    13.51988          1         99
        v195 |      3,422    4.180304    3.011027          1          9
        v197 |      3,422    3.883694    3.114201          1          9
        v198 |      3,422    47869.75    44281.22         10      99999
        v199 |      3,422    859958.2    157154.9       1000     999999
-------------+---------------------------------------------------------
        v200 |      3,422    765119.9    307578.3        620     888888
        v201 |      3,422    85101.84    17924.83         50      99999
        v202 |      3,422    25997.24    40746.44          0      99999
        v216 |      3,422    40.41555    31.42861          1         99
        v217 |      3,422    300.0523    397.2932          1        999
-------------+---------------------------------------------------------
        v218 |      3,422    449.1464    468.2698          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v14 v15 v16 ///
>                                 v86 v87 v88 ///
>                                 v429 ///
>                                 v449 v450 v451 v452 v455 v456 ///
>                                 v507 v464 ///
>                                 v466 v467 v468 v469 v470 v471 ///
>                                 v485 v486 v487

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,422    3239.965    1996.773          1       6421
          v4 |      3,422    1.236996    .4253019          1          2
         v14 |      3,422    1.812098     1.55689          1          9
         v15 |      3,422     2428.63    1780.471       1910       9999
         v16 |      3,422    11.85506    21.14024          0         99
-------------+---------------------------------------------------------
         v86 |      3,422    2.046756    1.058991          1          9
         v87 |      3,422    79.06137    26.21286          1         99
         v88 |      3,422    2.163063    1.229926          1          9
        v429 |      3,422    4.052016    2.933181          1          9
        v449 |      3,422    44.31765    40.80045          1         99
-------------+---------------------------------------------------------
        v450 |      3,422    4.764465     3.09662          1          9
        v451 |      3,422    45.77937    39.46564          1         99
        v452 |      3,422    5.388077    2.719931          1          9
        v455 |      3,422    6.046464    2.106463          1          9
        v456 |      3,422    5.952367    2.810867          1          9
-------------+---------------------------------------------------------
        v507 |      3,422    25.15108    37.54244          1         99
        v464 |      3,422     5.09059    3.084407          1          9
        v466 |      3,422    4.941262    3.275662          1          9
        v467 |      3,422    57836.64    42404.18         10      99999
        v468 |      3,422    864846.4    143707.8       1000     999999
-------------+---------------------------------------------------------
        v469 |      3,422    813965.7    246969.1        620     999999
        v470 |      3,422    86687.52    13839.54         50      99999
        v471 |      3,422    43395.44    44721.71          0      99999
        v485 |      3,422    53.19229    34.38329          2         99
        v486 |      3,422    461.1973    429.2586          1        999
-------------+---------------------------------------------------------
        v487 |      3,422     565.827     445.697          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2009

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 
(3,422 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,422    23239.96    1996.773      20001      26421
 make household head dummy  
(3,422 missing values generated)
(1,656 real changes made)
(1,766 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .50555343  .54993835 | .51607247
(3,422 missing values generated)
(1,573 real changes made)
(1,670 real changes made)
(1,752 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          . |         0
         7 |         0          . |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .47261586  .53760789 |  .4880187
          pri[3422,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,422    23239.96    1996.773      20001      26421
variable id was int now long
(3,422 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,422    33239.96    1996.773      30001      36421
(811 observations deleted)
  2,611
 make household head dummy  
(2,611 missing values generated)
(289 real changes made)
(2,322 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         8 |         0 |         0
         9 |         0 |         0
-----------+-----------+----------
     Total | .88931444 | .88931444
(2,611 missing values generated)
(0 real changes made)
(2,409 real changes made)
(202 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         9 |         0 |         0
-----------+-----------+----------
     Total | .92263501 | .92263501
          spo[2611,28]
          pri[3422,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[6033,28]
          spo[2611,28]
          pri[3422,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 6033
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 6,033

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2009.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,946       48.83       48.83
          2 |      3,087       51.17      100.00
------------+-----------------------------------
      Total |      6,033      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      6,033        2009           0       2009       2009

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2009m1

. disp %tm r(max)
 2009m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 34 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 34 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      5,999    1957.495    12.88407       1922       1988

. gen bym=ym(byear, bmonth)
(36 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1922m2

. disp %tm r(max)
 1988m4

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(36 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           25             20
 5%           30             22
10%           33             22       Obs               5,997
25%           40             22       Sum of Wgt.       5,997

50%           51                      Mean            50.6088
                        Largest       Std. Dev.      12.89161
75%           61             79
90%           68             79       Variance       166.1935
95%           71             82       Skewness      -.0843744
99%           74             86       Kurtosis       2.072316

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(6,033 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(6,033 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2009.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2010

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2010

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2010.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(857 vars, 3,207 obs)

. count
  3,207

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2010
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in KHPS 2010
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v85 v86 v87 ///
>                                 v161 ///
>                                 v181 v182 v183 v184 v187 v188 ///
>                                 v243 v196 ///
>                                 v198 v199 v200 v201 v202 v203 ///
>                                 v217 v218 v219

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,207    3228.207    1996.366          1       6425
          v4 |      3,207    1.229498    .4205756          1          2
          v5 |      3,207    1.523542    .4995233          1          2
          v6 |      3,207    1958.075    13.12529       1934       1987
          v7 |      3,207     6.15778    3.514792          1         12
-------------+---------------------------------------------------------
         v85 |      3,207    2.390396    9.093937          1         99
         v86 |      3,207    2.046149    1.083704          1          9
         v87 |      3,207    78.48706    26.95603          1         99
        v161 |      3,207    2.700031    2.149833          1          9
        v181 |      3,207    29.24758      36.846          1         99
-------------+---------------------------------------------------------
        v182 |      3,207    3.662613    2.824948          1          9
        v183 |      3,207    31.20767    35.43918          1         99
        v184 |      3,207    4.501091    2.618719          1          9
        v187 |      3,207    5.336452    2.084309          1          9
        v188 |      3,207    5.313065    2.929387          1          9
-------------+---------------------------------------------------------
        v243 |      3,207    5.038977    13.83798          1         99
        v196 |      3,207    4.215154    3.018013          1          9
        v198 |      3,207    3.978173    3.136153          1          9
        v199 |      3,207    48944.08    44181.76         10      99999
        v200 |      3,207    859882.9    157114.8       1000     999999
-------------+---------------------------------------------------------
        v201 |      3,207    764504.4    308559.5        620     999999
        v202 |      3,207    85406.74    17241.16         40      99999
        v203 |      3,207    27171.03     41304.1          0      99999
        v217 |      3,207    41.18865    31.95474          1         99
        v218 |      3,207     311.092    402.2564          1        999
-------------+---------------------------------------------------------
        v219 |      3,207    478.2984    469.6833          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v14 v15 v16 ///
>                                 v85 v86 v87 ///
>                                 v426 ///
>                                 v446 v447 v448 v449 v452 v453 ///
>                                 v508 v461 ///
>                                 v463 v464 v465 v466 v467 v468 ///
>                                 v482 v483 v484

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,207    3228.207    1996.366          1       6425
          v4 |      3,207    1.229498    .4205756          1          2
         v14 |      3,207    1.843156    1.604161          1          9
         v15 |      3,207    2406.631    1724.374       1910       9999
         v16 |      3,207    11.60368    20.54613          0         99
-------------+---------------------------------------------------------
         v85 |      3,207    2.390396    9.093937          1         99
         v86 |      3,207    2.046149    1.083704          1          9
         v87 |      3,207    78.48706    26.95603          1         99
        v426 |      3,207    4.014655    2.920463          1          9
        v446 |      3,207     44.7652    40.87328          1         99
-------------+---------------------------------------------------------
        v447 |      3,207    4.791394    3.098983          1          9
        v448 |      3,207    46.18771    39.49952          1         99
        v449 |      3,207    5.410976    2.732532          1          9
        v452 |      3,207     6.04802    2.116875          1          9
        v453 |      3,207    5.977861    2.796232          1          9
-------------+---------------------------------------------------------
        v508 |      3,207    24.36919     37.0149          1         99
        v461 |      3,207    5.114749     3.08811          1          9
        v463 |      3,207    5.010602    3.253658          1          9
        v464 |      3,207    58933.56    42027.71         10      99999
        v465 |      3,207    863199.7      148074       2000     999999
-------------+---------------------------------------------------------
        v466 |      3,207    809501.6    253516.8        600     999999
        v467 |      3,207    86481.65    14441.19         40      99999
        v468 |      3,207    43310.34    44685.25          0      99999
        v482 |      3,207    54.38385    34.58518          1         99
        v483 |      3,207    476.5466    431.0215          1        999
-------------+---------------------------------------------------------
        v484 |      3,207    594.6473    440.2123          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2010

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 
(3,207 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,207    23228.21    1996.366      20001      26425
 make household head dummy  
(3,207 missing values generated)
(1,542 real changes made)
(1,665 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          . |         0
         9 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .49898826  .58695652 |  .5191768
(3,207 missing values generated)
(1,477 real changes made)
(1,586 real changes made)
(1,621 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          . |         0
         7 |         0          . |         0
         9 |         0          . |         0
        10 |         0          . |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .47146904  .57201087 | .49454319
          pri[3207,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,207    23228.21    1996.366      20001      26425
variable id was int now long
(3,207 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,207    33228.21    1996.366      30001      36425
(736 observations deleted)
  2,471
 make household head dummy  
(2,471 missing values generated)
(1,323 real changes made)
(1,148 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
         9 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .46458924 | .46458924
(2,471 missing values generated)
(1,037 real changes made)
(58 real changes made)
(2,413 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
         9 |         0 |         0
        10 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .02347228 | .02347228
          spo[2471,28]
          pri[3207,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[5678,28]
          spo[2471,28]
          pri[3207,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 5678
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 5,678

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2010.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,778       48.93       48.93
          2 |      2,900       51.07      100.00
------------+-----------------------------------
      Total |      5,678      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      5,678        2010           0       2010       2010

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2010m1

. disp %tm r(max)
 2010m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 9 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 9 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      5,669    1957.533    12.80705       1922       1988

. gen bym=ym(byear, bmonth)
(10 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1922m2

. disp %tm r(max)
 1988m4

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(10 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           26             21
 5%           31             23
10%           34             23       Obs               5,668
25%           41             23       Sum of Wgt.       5,668

50%           52                      Mean           51.56757
                        Largest       Std. Dev.      12.81239
75%           62             80
90%           69             80       Variance       164.1572
95%           72             83       Skewness      -.0694397
99%           75             87       Kurtosis       2.071332

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(5,678 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(5,678 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2010.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2011

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2011

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2011.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(859 vars, 3,030 obs)

. count
  3,030

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2011
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in KHPS 2011
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v85 v86 v87 ///
>                                 v173 ///
>                                 v193 v194 v195 v196 v199 v200 ///
>                                 v249 v208 ///
>                                 v210 v211 v212 v213 v214 v215 ///
>                                 v229 v230 v231

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,030    3207.643    1998.384          1       6426
          v4 |      3,030    1.224092     .417052          1          2
          v5 |      3,030    1.523432    .4995331          1          2
          v6 |      3,030    1958.039    13.07062       1934       1987
          v7 |      3,030    6.148185    3.513802          1         12
-------------+---------------------------------------------------------
         v85 |      3,030    2.520792    9.833614          1         99
         v86 |      3,030    2.035314    1.055605          1          9
         v87 |      3,030    78.21254    27.28369          1         99
        v173 |      3,030    2.741584    2.187381          1          9
        v193 |      3,030    29.72805    37.02781          1         99
-------------+---------------------------------------------------------
        v194 |      3,030    3.706271     2.84162          1          9
        v195 |      3,030    32.03333    35.84453          1         99
        v196 |      3,030    4.536964    2.636649          1          9
        v199 |      3,030    5.361386    2.091603          1          9
        v200 |      3,030    5.359736    2.934179          1          9
-------------+---------------------------------------------------------
        v249 |      3,030    4.548845    11.98759          1         99
        v208 |      3,030     4.29835    3.059673          1          9
        v210 |      3,030    3.955116    3.149929          1          9
        v211 |      3,030    48221.14    44258.33         10      99999
        v212 |      3,030    863148.9    148448.7       1000     999999
-------------+---------------------------------------------------------
        v213 |      3,030    767826.5    305160.4        500     999999
        v214 |      3,030    85963.47    15882.12         50      99999
        v215 |      3,030    27384.96    41317.91          0      99999
        v229 |      3,030    41.40198     31.8688          1         99
        v230 |      3,030    311.7112    401.8348          1        999
-------------+---------------------------------------------------------
        v231 |      3,030    470.0033    468.3433          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v14 v15 v16 ///
>                                 v85 v86 v87 ///
>                                 v431 ///
>                                 v451 v452 v453 v454 v457 v458 ///
>                                 v507 v466 ///
>                                 v468 v469 v470 v471 v472 v473 ///
>                                 v487 v488 v489

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,030    3207.643    1998.384          1       6426
          v4 |      3,030    1.224092     .417052          1          2
         v14 |      3,030    1.862376    1.634032          1          8
         v15 |      3,030    2423.079     1750.44       1910       9999
         v16 |      3,030    11.81782    20.85007          1         99
-------------+---------------------------------------------------------
         v85 |      3,030    2.520792    9.833614          1         99
         v86 |      3,030    2.035314    1.055605          1          9
         v87 |      3,030    78.21254    27.28369          1         99
        v431 |      3,030    4.041914    2.909989          1          9
        v451 |      3,030    45.38416    40.89675          1         99
-------------+---------------------------------------------------------
        v452 |      3,030    4.818812    3.102919          1          9
        v453 |      3,030    46.81914    39.53838          1         99
        v454 |      3,030    5.455116     2.73088          1          9
        v457 |      3,030    6.086139    2.113682          1          9
        v458 |      3,030    6.038284    2.775617          1          9
-------------+---------------------------------------------------------
        v507 |      3,030    24.09076    36.81811          1         99
        v466 |      3,030    5.114851    3.102945          1          9
        v468 |      3,030    4.990429    3.277157          1          9
        v469 |      3,030    58145.39    42290.58         10      99999
        v470 |      3,030      865495    141658.7       2800     999999
-------------+---------------------------------------------------------
        v471 |      3,030    813612.4    247445.7        630     999999
        v472 |      3,030    86949.58    12999.07         50      99999
        v473 |      3,030    44383.25    44760.89          0      99999
        v487 |      3,030    54.71584    34.61707          2         99
        v488 |      3,030    482.8221    430.9435          1        999
-------------+---------------------------------------------------------
        v489 |      3,030    593.7277    439.6173          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2011

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 
(3,030 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,030    23207.64    1998.384      20001      26426
 make household head dummy  
(3,030 missing values generated)
(1,432 real changes made)
(1,598 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          . |         0
         6 |         0          . |         0
         7 |         0          . |         0
        10 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .49893662  .62592047 | .52739274
(3,030 missing values generated)
(1,403 real changes made)
(1,500 real changes made)
(1,530 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          . |         0
         7 |         0          . |         0
         8 |         0          . |         0
        88 |         0          0 |         0
        99 |         0          . |         0
-----------+----------------------+----------
     Total | .46320715  .60530191 |  .4950495
          pri[3030,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,030    23207.64    1998.384      20001      26426
variable id was int now long
(3,030 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,030    33207.64    1998.384      30001      36426
(679 observations deleted)
  2,351
 make household head dummy  
(2,351 missing values generated)
(1,259 real changes made)
(1,092 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        10 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total |  .4644832 |  .4644832
(2,351 missing values generated)
(992 real changes made)
(62 real changes made)
(2,289 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
         8 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .02637176 | .02637176
          spo[2351,28]
          pri[3030,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[5381,28]
          spo[2351,28]
          pri[3030,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 5381
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 5,381

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2011.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,632       48.91       48.91
          2 |      2,749       51.09      100.00
------------+-----------------------------------
      Total |      5,381      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      5,381        2011           0       2011       2011

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2011m1

. disp %tm r(max)
 2011m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 10 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 10 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      5,371    1957.628    12.79412       1922       1988

. gen bym=ym(byear, bmonth)
(10 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1922m2

. disp %tm r(max)
 1988m4

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(10 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           27             22
 5%           32             24
10%           35             24       Obs               5,371
25%           42             24       Sum of Wgt.       5,371

50%           52                      Mean           52.47608
                        Largest       Std. Dev.      12.80203
75%           63             81
90%           70             81       Variance       163.8919
95%           73             84       Skewness      -.0491483
99%           76             88       Kurtosis        2.07526

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(5,381 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(5,381 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2011.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2012

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2012

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2012.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(882 vars, 2,865 obs)

. count
  2,865

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2012
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in KHPS 2012
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v85 v86 v87 ///
>                                 v167 ///
>                                 v187 v188 v189 v190 v193 v194 ///
>                                 v228 v202 ///
>                                 v204 v205 v206 v207 v208 v209 ///
>                                 v214 v215 v216

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,865    3210.759    1995.251          1       6429
          v4 |      2,865     1.22164    .4154229          1          2
          v5 |      2,865    1.526353    .4993922          1          2
          v6 |      2,865    1958.014    12.99025       1934       1987
          v7 |      2,865    6.139965     3.51577          1         12
-------------+---------------------------------------------------------
         v85 |      2,865    2.434206    9.443929          1         99
         v86 |      2,865    1.993368    .9231795          1          9
         v87 |      2,865    77.95812    27.57523          1         99
        v167 |      2,865    2.745201    2.185688          1          9
        v187 |      2,865    30.22827    37.39534          1         99
-------------+---------------------------------------------------------
        v188 |      2,865    3.754974    2.868266          1          9
        v189 |      2,865     32.3438    36.04068          1         99
        v190 |      2,865     4.57452    2.645906          1          9
        v193 |      2,865    5.394066    2.117045          1          9
        v194 |      2,865    5.406632    2.917228          1          9
-------------+---------------------------------------------------------
        v228 |      2,865    4.611867     12.0436          1         99
        v202 |      2,865    4.401745    3.031872          1          9
        v204 |      2,865    4.047818    3.144031          1          9
        v205 |      2,865    50136.34    44086.14         10      99999
        v206 |      2,865    864182.2    145862.4       2000     999999
-------------+---------------------------------------------------------
        v207 |      2,865    758333.5    314873.9        500     999999
        v208 |      2,865     85825.5    16241.36         40      99999
        v209 |      2,865    28528.38    41869.91          0      99999
        v214 |      2,865    41.74974    32.05147          1         99
        v215 |      2,865    319.9969    405.8609          1        999
-------------+---------------------------------------------------------
        v216 |      2,865    487.3518     468.725          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v14 v15 v16 ///
>                                 v85 v86 v87 ///
>                                 v405 ///
>                                 v425 v426 v427 v428 v431 v432 ///
>                                 v466 v440 ///
>                                 v442 v443 v444 v445 v446 v447 ///
>                                 v452 v453 v454

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,865    3210.759    1995.251          1       6429
          v4 |      2,865     1.22164    .4154229          1          2
         v14 |      2,865    1.878883     1.65272          1          8
         v15 |      2,865    2423.946    1747.995       1910       9999
         v16 |      2,865    11.88831    20.96169          1         99
-------------+---------------------------------------------------------
         v85 |      2,865    2.434206    9.443929          1         99
         v86 |      2,865    1.993368    .9231795          1          9
         v87 |      2,865    77.95812    27.57523          1         99
        v405 |      2,865    4.006981    2.909113          1          9
        v425 |      2,865    44.94799     40.9489          1         99
-------------+---------------------------------------------------------
        v426 |      2,865    4.801745    3.104297          1          9
        v427 |      2,865    46.25166    39.50917          1         99
        v428 |      2,865    5.405934    2.743511          1          9
        v431 |      2,865    6.069808    2.107949          1          9
        v432 |      2,865    6.042932     2.77142          1          9
-------------+---------------------------------------------------------
        v466 |      2,865    23.92949    36.76231          1         99
        v440 |      2,865    5.262827    3.050729          1          9
        v442 |      2,865    5.026527    3.261207          1          9
        v443 |      2,865    59000.67    42007.68          8      99999
        v444 |      2,865    865788.6    141241.3       2800     999999
-------------+---------------------------------------------------------
        v445 |      2,865    807067.4    256866.2        600     888888
        v446 |      2,865    86836.82    13366.91         42      99999
        v447 |      2,865    44087.01    44783.87          0      99999
        v452 |      2,865    54.33264    34.81222          1         99
        v453 |      2,865    476.3627    431.4681          1        999
-------------+---------------------------------------------------------
        v454 |      2,865    602.3983    438.4128          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2012

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 
(2,865 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,865    23210.76    1995.251      20001      26429
 make household head dummy  
(2,865 missing values generated)
(1,331 real changes made)
(1,534 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          . |         0
         6 |         0          0 |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .50224215   .6519685 | .53542757
(2,865 missing values generated)
(1,350 real changes made)
(1,437 real changes made)
(1,428 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         8 |         0          . |         0
        10 |         0          . |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .47174888  .60629921 | .50157068
          pri[2865,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,865    23210.76    1995.251      20001      26429
variable id was int now long
(2,865 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,865    33210.76    1995.251      30001      36429
(635 observations deleted)
  2,230
 make household head dummy  
(2,230 missing values generated)
(1,202 real changes made)
(1,028 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .46098655 | .46098655
(2,230 missing values generated)
(925 real changes made)
(45 real changes made)
(2,185 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         8 |         0 |         0
        10 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .02017937 | .02017937
          spo[2230,28]
          pri[2865,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[5095,28]
          spo[2230,28]
          pri[2865,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 5095
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 5,095

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2012.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,484       48.75       48.75
          2 |      2,611       51.25      100.00
------------+-----------------------------------
      Total |      5,095      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      5,095        2012           0       2012       2012

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2012m1

. disp %tm r(max)
 2012m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 7 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 7 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      5,088    1957.732    12.79176       1922       1988

. gen bym=ym(byear, bmonth)
(7 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1922m2

. disp %tm r(max)
1988m12

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(7 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           28             23
 5%           33             24
10%           36             25       Obs               5,088
25%           43             25       Sum of Wgt.       5,088

50%           53                      Mean           53.37264
                        Largest       Std. Dev.      12.79952
75%           64             82
90%           71             82       Variance       163.8277
95%           74             85       Skewness      -.0347654
99%           77             89       Kurtosis       2.073017

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(5,095 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(5,095 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2012.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2013

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2013

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2013.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(1,021 vars, 2,702 obs)

. count
  2,702

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2013
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in KHPS 2013
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v85 v86 v87 ///
>                                 v190 ///
>                                 v210 v211 v212 v213 v216 v217 ///
>                                 v266 v225 ///
>                                 v227 v228 v229 v230 v231 v232 ///
>                                 v246 v247 v248

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,702    3213.849    1994.777          1       6429
          v4 |      2,702    1.221318    .4152107          1          2
          v5 |      2,702    1.523316    .4995485          1          2
          v6 |      2,702    1958.087    12.96544       1934       1987
          v7 |      2,702    6.124352    3.518724          1         12
-------------+---------------------------------------------------------
         v85 |      2,702    3.091044    12.35914          1         99
         v86 |      2,702    2.027757    1.004049          1          9
         v87 |      2,702    78.42746    27.01163          1         99
        v190 |      2,702    2.785344    2.201233          1          9
        v210 |      2,702    30.88971    37.69155          1         99
-------------+---------------------------------------------------------
        v211 |      2,702    3.813842    2.890022          1          9
        v212 |      2,702    32.92228    36.32176          1         99
        v213 |      2,702    4.631754    2.644043          1          9
        v216 |      2,702    5.436343    2.118705          1          9
        v217 |      2,702    5.426351    2.895364          1          9
-------------+---------------------------------------------------------
        v266 |      2,702    4.284604    10.50107          1         99
        v225 |      2,702    4.457439    3.038845          1          9
        v227 |      2,702    4.103627    3.174488          1          9
        v228 |      2,702    50709.75    44045.36         10      99999
        v229 |      2,702    861001.8    154329.9       1800     999999
-------------+---------------------------------------------------------
        v230 |      2,702    766762.5      306079        600     999999
        v231 |      2,702    85790.44    16300.99         50      99999
        v232 |      2,702    28949.45    41991.74          0      99999
        v246 |      2,702    42.82457    32.67272          1         99
        v247 |      2,702    330.5189    409.6543          1        999
-------------+---------------------------------------------------------
        v248 |      2,702    491.6295    467.8587          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v14 v15 v16 ///
>                                 v85 v86 v87 ///
>                                 v471 ///
>                                 v491 v492 v493 v494 v497 v498 ///
>                                 v547 v506 ///
>                                 v508 v509 v510 v511 v512 v513 ///
>                                 v527 v528 v529

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      2,702    3213.849    1994.777          1       6429
          v4 |      2,702    1.221318    .4152107          1          2
         v14 |      2,702    1.880829    1.653156          1          8
         v15 |      2,702    2403.193    1703.695       1910       9999
         v16 |      2,702    11.69023    20.47557          1         99
-------------+---------------------------------------------------------
         v85 |      2,702    3.091044    12.35914          1         99
         v86 |      2,702    2.027757    1.004049          1          9
         v87 |      2,702    78.42746    27.01163          1         99
        v471 |      2,702     4.07809    2.893041          1          9
        v491 |      2,702    45.55292    40.95453          1         99
-------------+---------------------------------------------------------
        v492 |      2,702    4.865285    3.101454          1          9
        v493 |      2,702    47.10104     39.5435          1         99
        v494 |      2,702    5.493708    2.728312          1          9
        v497 |      2,702    6.112879    2.109425          1          9
        v498 |      2,702    6.062546    2.745562          1          9
-------------+---------------------------------------------------------
        v547 |      2,702    23.40674    36.29152          1         99
        v506 |      2,702    5.255366    3.053988          1          9
        v508 |      2,702    5.057735    3.245536          1          9
        v509 |      2,702    59686.26    41776.93         10      99999
        v510 |      2,702    863991.6      146181       2300     999999
-------------+---------------------------------------------------------
        v511 |      2,702    804149.9      261004        640     999999
        v512 |      2,702    87109.34    12496.37         72      99999
        v513 |      2,702    44317.17    44707.76          0      99999
        v527 |      2,702    55.88897    34.81543          1         99
        v528 |      2,702    494.4404    431.9092          1        999
-------------+---------------------------------------------------------
        v529 |      2,702     608.007    436.1131          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2013

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 
(2,702 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,702    23213.85    1994.777      20001      26429
 make household head dummy  
(2,702 missing values generated)
(1,247 real changes made)
(1,455 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          . |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .49904943  .67725753 | .53849001
(2,702 missing values generated)
(1,285 real changes made)
(1,356 real changes made)
(1,346 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .46863118   .6187291 | .50185048
          pri[2702,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,702    23213.85    1994.777      20001      26429
variable id was int now long
(2,702 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      2,702    33213.85    1994.777      30001      36429
(598 observations deleted)
  2,104
 make household head dummy  
(2,104 missing values generated)
(1,131 real changes made)
(973 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .46245247 | .46245247
(2,104 missing values generated)
(880 real changes made)
(47 real changes made)
(2,057 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total |  .0223384 |  .0223384
          spo[2104,28]
          pri[2702,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[4806,28]
          spo[2104,28]
          pri[2702,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 4806
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 4,806

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2013.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,342       48.73       48.73
          2 |      2,464       51.27      100.00
------------+-----------------------------------
      Total |      4,806      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      4,806        2013           0       2013       2013

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2013m1

. disp %tm r(max)
 2013m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 1 missing value generated

. mvdecode bmonth, mv(99)
      bmonth: 1 missing value generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      4,805    1957.949    12.78384       1926       1988

. gen bym=ym(byear, bmonth)
(1 missing value generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1926m7

. disp %tm r(max)
1988m12

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(1 missing value generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           29             24
 5%           34             25
10%           37             25       Obs               4,805
25%           44             25       Sum of Wgt.       4,805

50%           54                      Mean           54.15609
                        Largest       Std. Dev.      12.79302
75%           64             82
90%           72             83       Variance       163.6613
95%           75             83       Skewness      -.0296297
99%           78             86       Kurtosis       2.072937

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(4,806 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(4,806 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2013.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2014

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2014

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPS2014.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(957 vars, 3,312 obs)

. count
  3,312

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_VarlistKHPS2014
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in KHPS 2014
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. global VarList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 workstatus ///
>                                 occ owner ind size employed regular ///
>                                 switch union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. disp "$VarList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 workstatus                                 occ 
> owner ind size employed regular                                 switch union   
>                               paymethod monthlypaid dailypaid hourlypaid yearly
> paid bonus                                 workdaypermonth workhourperweek over
> workperweek

. 
. ** variable number of principal
. global RenameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v101 v102 v103 ///
>                                 v220 ///
>                                 v227 v228 v229 v230 v233 v234 ///
>                                 v265 v242 ///
>                                 v244 v245 v246 v247 v248 v249 ///
>                                 v251 v252 v253

. sum $RenameListPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,312    4205.039     2512.38          1       8011
          v4 |      3,312    1.235205    .4241911          1          2
          v5 |      3,312    1.512983    .4999069          1          2
          v6 |      3,312    1960.047    13.55957       1934       1992
          v7 |      3,312     6.17814    3.524642          1         12
-------------+---------------------------------------------------------
        v101 |      3,312     2.34994    9.107357          1         99
        v102 |      3,312    1.930556    .6735338          1          9
        v103 |      3,312    77.99819    27.49727          1         99
        v220 |      3,312    2.705314    2.202685          1          9
        v227 |      3,312    29.94897    37.29834          1         99
-------------+---------------------------------------------------------
        v228 |      3,312    3.725242    2.828426          1          9
        v229 |      3,312    31.94746    35.75041          1         99
        v230 |      3,312    4.570954    2.600172          1          9
        v233 |      3,312    5.419082    2.043495          1          9
        v234 |      3,312      5.2032    2.914375          1          9
-------------+---------------------------------------------------------
        v265 |      3,312    4.152174    10.26383          1         99
        v242 |      3,312    4.148551    3.078207          1          9
        v244 |      3,312    4.014191    3.124437          1          9
        v245 |      3,312    49823.32    44097.53          8      99999
        v246 |      3,312    861277.3    153373.1       1070     888888
-------------+---------------------------------------------------------
        v247 |      3,312    759199.5    313735.4        500     999999
        v248 |      3,312    85146.19    17871.26          0      99999
        v249 |      3,312    28598.53    41964.71          0      99999
        v251 |      3,312    41.55133    32.16097          1         99
        v252 |      3,312    318.5474    405.8362          1        999
-------------+---------------------------------------------------------
        v253 |      3,312    471.6932    468.3977          0        999

. 
. ** variable number of spouse
. global RenameListSpo ///
>                                 v1 v4  v12 v13 v14 ///
>                                 v101 v102 v103 ///
>                                 v498 ///
>                                 v505 v506 v507 v508 v511 v512 ///
>                                 v543 v520 ///
>                                 v522 v523 v524 v525 v526 v527 ///
>                                 v529 v530 v531

. sum $RenameListSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      3,312    4205.039     2512.38          1       8011
          v4 |      3,312    1.235205    .4241911          1          2
         v12 |      3,312    1.844203    1.594275          1          8
         v13 |      3,312    2370.793    1644.021       1916       9999
         v14 |      3,312    11.31039    19.75618          1         99
-------------+---------------------------------------------------------
        v101 |      3,312     2.34994    9.107357          1         99
        v102 |      3,312    1.930556    .6735338          1          9
        v103 |      3,312    77.99819    27.49727          1         99
        v498 |      3,312    4.117754    2.939852          1          9
        v505 |      3,312    46.04227    40.97565          1         99
-------------+---------------------------------------------------------
        v506 |      3,312    4.894626    3.088458          1          9
        v507 |      3,312     47.3913    39.52989          1         99
        v508 |      3,312    5.491848    2.699026          1          9
        v511 |      3,312    6.149758    2.051564          1          9
        v512 |      3,312    5.954408    2.762966          1          9
-------------+---------------------------------------------------------
        v543 |      3,312    24.70713    37.04749          1         99
        v520 |      3,312    5.147041    3.121393          1          9
        v522 |      3,312    5.019928    3.245548          1          9
        v523 |      3,312    58893.16     42030.7          0      99999
        v524 |      3,312    867458.7    135596.3       1000     999999
-------------+---------------------------------------------------------
        v525 |      3,312    805814.4    258677.6        450     999999
        v526 |      3,312    86881.45    13261.97         10      99999
        v527 |      3,312    45476.86    44765.62          0      99999
        v529 |      3,312    56.08454    34.76597          1         99
        v530 |      3,312    497.6238    431.0363          1        999
-------------+---------------------------------------------------------
        v531 |      3,312    604.2847    436.0223          0        999

. 
. ** variable list to be convert to matrix
. global MatVarList $VarList dhead dearnmost

. 
. 
. * rename varname and make head dummy
. do "$Path\Code\Renamevar.do"

. *******************************************************
. *Title: Renamevar
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables and save cleaned data as dta
. * 
. * 1. rename varname and make head dummy
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. /* definition of id
> ** JHPS(principal): id=original id
> ** JHPS(spouse): id=original id+10000
> ** KHPS(principal): id=original id+20000
> ** KHPS(spouse): id=original id+30000 (=(original id +20000)+10000)
> */
. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPS2014

. 
. * set list of variables
. local varList $VarList

. local renameListPri $RenameListPri

. local renameListSpo $RenameListSpo

. local renameList renameListPri renameListSpo

. local matVarList $MatVarList

. 
. 
. * 1. rename varname and make head dummy
. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** replace id (KHPS)
.         if "`currentData'"=="KHPS"&&`i'==1{
  6.                 replace id = id+20000
  7.                 }
  8.         sum id
  9.         
.         if `i'==2{
 10.                 ** replace id (spouse)
.                 replace id = id+10000
 11.                 sum id
 12.                 * keep sample of spouse
.                 keep if marital==1
 13.                 count
 14.                 }
 15.         
.         dis " make household head dummy  "
 16.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 17.         replace dhead=0 if head!=`i'
 18.         replace dhead=1 if head==`i'
 19.         label var dhead "HH head dummy"
 20.         tab head marital, sum(dhead) mean miss
 21.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 22.         replace earnmost=1 if dhead==1&earnif==2
 23.         replace dearnmost=1 if earnmost==`i'
 24.         replace dearnmost=0 if dearnmost!=1
 25.         label var dearnmost "Breadwinner dummy"
 26.         tab earnmost marital, sum(dearnmost) mean miss
 27.         
.         ** save variable as matrix
.         if `i'==1{
 28.                 local matName pri
 29.         }
 30.         else {
 31.                 local matName spo
 32.         }
 33.         mkmat `matVarList', matrix(`matName')
 34.         mat dir
 35.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 36.         drop dhead dearnmost
 37. }
 ** Rename variables of renameListPri 
(3,312 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,312    24205.04     2512.38      20001      28011
 make household head dummy  
(3,312 missing values generated)
(1,499 real changes made)
(1,813 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          . |         0
         6 |         0          . |         0
         7 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .52072641  .63414634 | .54740338
(3,312 missing values generated)
(1,614 real changes made)
(1,704 real changes made)
(1,608 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         7 |         0          0 |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .49111725  .59050064 | .51449275
          pri[3312,28]
 ** Rename variables of renameListSpo 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,312    24205.04     2512.38      20001      28011
variable id was int now long
(3,312 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      3,312    34205.04     2512.38      30001      38011
(779 observations deleted)
  2,533
 make household head dummy  
(2,533 missing values generated)
(1,397 real changes made)
(1,136 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .44848006 | .44848006
(2,533 missing values generated)
(1,021 real changes made)
(60 real changes made)
(2,473 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         7 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .02368733 | .02368733
          spo[2533,28]
          pri[3312,28]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[5845,28]
          spo[2533,28]
          pri[3312,28]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 5845
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 5,845

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2014.dta saved

. mat drop _all

. 
end of do-file

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,873       49.15       49.15
          2 |      2,972       50.85      100.00
------------+-----------------------------------
      Total |      5,845      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      5,845        2014           0       2014       2014

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2014m1

. disp %tm r(max)
 2014m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 1 missing value generated

. mvdecode bmonth, mv(99)
      bmonth: 2 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      5,844    1959.629    13.22022       1926       1992

. gen bym=ym(byear, bmonth)
(2 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1926m7

. disp %tm r(max)
 1992m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(2 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           26             22
 5%           32             22
10%           36             22       Obs               5,843
25%           43             22       Sum of Wgt.       5,843

50%           53                      Mean           53.47801
                        Largest       Std. Dev.      13.22964
75%           64             84
90%           71             85       Variance       175.0233
95%           75             86       Skewness      -.0416235
99%           79             87       Kurtosis       2.150093

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
.         qui forvalues status_j = 1/`num_m'{
  2.                 local currentEmpStatus: word `status_j' of `empStatus'
  3.                 recode `currentEmpStatus'* (9 = 0)
  4.         }
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
  2.                 gen we`x'=0
  3.         }
.         qui forvalues x=`age_t'/65{
  2.                 replace we`x'=1 if cas`x'+full`x'+self`x'+side`x'+fmw`x'>=1
  3.         }
.         sum we*
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
(5,845 missing values generated)
.         sum workexp

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     workexp |          0
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
.         disp %tm r(max)
.         
.         gen emptenure=(svyym-empym)
.         label var emptenure "Tenure months" 
.         sum emptenure, de
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
(5,845 missing values generated)
.         sum emptenure

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   emptenure |          0
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPS2014.dta saved

. 
. *}
. 
end of do-file
Current data: KHPSnew, year list: NewKHPSyear, number of year: 2 
Current survey year: 2007

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPSnew2007

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPSnew2007.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(1,750 vars, 1,419 obs)

. count
  1,419

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_KHPSnew2007
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in KHPSnew 2007
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. *** common variable with other years
. local varList ///
>                                 id marital sex byear bmonth ///
>                                 earnmost ///
>                                 edbg workstatus ///
>                                 occ owner ind size employed regular ///
>                                 empsinceyear empsincemonth union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. *** variables of working experience
. global ExpList ///
>                                 cas* full* self* side* fmw*     

. disp "`varList'" "$ExpList"
id marital sex byear bmonth                                 earnmost             
>                     edbg workstatus                                 occ owner i
> nd size employed regular                                 empsinceyear empsincem
> onth union                                 paymethod monthlypaid dailypaid hour
> lypaid yearlypaid bonus                                 workdaypermonth workhou
> rperweek overworkperweekcas* full* self* side* fmw*

. 
. ** variable number of principal
. *** common variable with other years
. local renameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v76 ///
>                                 v135 v156 ///
>                                 v203 v204 v205 v206 v209 v210 ///
>                                 v222 v223 v224 ///
>                                 v228 v229 v230 v231 v232 v233 ///
>                                 v246 v247 v248

. *** variables of working experience
. global CasPri v420-v473

. global FullPri v474-v527

. global SelfPri v528-v581

. global SidePri v582-v635

. global FmwPri v636-v689

. sum `renameListPri' $CasPri $FullPri $SelfPri $SidePri $FmwPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      1,419        5710    409.7743       5001       6419
          v4 |      1,419    1.264975    .4414757          1          2
          v5 |      1,419     1.54334    .4982937          1          2
          v6 |      1,419    1960.669    13.59416       1937       1987
          v7 |      1,419    6.238196    3.418143          1         12
-------------+---------------------------------------------------------
         v76 |      1,419    2.926709    11.22191          1         99
        v135 |      1,419    2.863284    1.265657          1          9
        v156 |      1,419    2.532065    2.048993          1          9
        v203 |      1,419    27.59267    36.23537          1         99
        v204 |      1,419    3.537703    2.777952          1          9
-------------+---------------------------------------------------------
        v205 |      1,419     29.7914    35.02798          1         99
        v206 |      1,419    4.400987    2.598801          1          9
        v209 |      1,419    5.325581    2.024111          1          9
        v210 |      1,419    5.232558    2.943671          1          9
        v222 |      1,419    4095.469    3250.929       1928       9999
-------------+---------------------------------------------------------
        v223 |      1,419    30.50176    38.78206          0         99
        v224 |      1,419    3.800564    2.928456          1          9
        v228 |      1,419    3.904863    3.192922          1          9
        v229 |      1,419    47742.58    44414.08         10      99999
        v230 |      1,419    859899.4    157611.5       1000     999999
-------------+---------------------------------------------------------
        v231 |      1,419    775079.2    297058.7        611     999999
        v232 |      1,419    85906.89    15984.16         60      99999
        v233 |      1,419    28432.07    42365.37          0      99999
        v246 |      1,419     40.9852    32.24176          2         99
        v247 |      1,419    324.9676    412.6277          1        999
-------------+---------------------------------------------------------
        v248 |      1,419    479.8985    472.9439          0        999
        v420 |      1,419    8.943622     .669447          1          9
        v421 |      1,419    8.887245    .9433754          1          9
        v422 |      1,419    8.864693    1.031938          1          9
        v423 |      1,419    8.729387    1.446772          1          9
-------------+---------------------------------------------------------
        v424 |      1,419    8.520789    1.899101          1          9
        v425 |      1,419    8.498238    1.940356          1          9
        v426 |      1,419    8.475687    1.980496          1          9
        v427 |      1,419    8.498238    1.940356          1          9
        v428 |      1,419    8.447498    2.029201          1          9
-------------+---------------------------------------------------------
        v429 |      1,419    8.458774    2.009908          1          9
        v430 |      1,419    8.447498    2.029201          1          9
        v431 |      1,419    8.408034     2.09485          1          9
        v432 |      1,419    8.470049    1.990364          1          9
        v433 |      1,419    8.498238    1.940356          1          9
-------------+---------------------------------------------------------
        v434 |      1,419    8.565891    1.812935          1          9
        v435 |      1,419    8.537703    1.867383          1          9
        v436 |      1,419    8.571529    1.801795          1          9
        v437 |      1,419    8.526427    1.888604          1          9
        v438 |      1,419    8.520789    1.899101          1          9
-------------+---------------------------------------------------------
        v439 |      1,419    8.503876     1.93015          1          9
        v440 |      1,419     8.44186    2.038756          1          9
        v441 |      1,419    8.424947    2.067063          1          9
        v442 |      1,419    8.419309    2.076382          1          9
        v443 |      1,419    8.385483    2.131128          1          9
-------------+---------------------------------------------------------
        v444 |      1,419    8.351656    2.183979          1          9
        v445 |      1,419    8.396758    2.113097          1          9
        v446 |      1,419    8.351656    2.183979          1          9
        v447 |      1,419    8.346018    2.192612          1          9
        v448 |      1,419    8.300916    2.259989          1          9
-------------+---------------------------------------------------------
        v449 |      1,419    8.317829    2.235068          1          9
        v450 |      1,419    8.368569    2.157782          1          9
        v451 |      1,419    8.379845    2.140064          1          9
        v452 |      1,419    8.424947    2.067063          1          9
        v453 |      1,419    8.464412    2.000168          1          9
-------------+---------------------------------------------------------
        v454 |      1,419    8.464412    2.000168          1          9
        v455 |      1,419    8.470049    1.990364          1          9
        v456 |      1,419    8.509514    1.919873          1          9
        v457 |      1,419    8.571529    1.801795          1          9
        v458 |      1,419     8.59408    1.756349          1          9
-------------+---------------------------------------------------------
        v459 |      1,419    8.616631    1.709396          1          9
        v460 |      1,419    8.639183    1.660811          1          9
        v461 |      1,419    8.684285    1.558126          1          9
        v462 |      1,419     8.69556    1.531172          1          9
        v463 |      1,419    8.740662    1.417343          1          9
-------------+---------------------------------------------------------
        v464 |      1,419    8.774489    1.324564          1          9
        v465 |      1,419    8.785765    1.291961          1          9
        v466 |      1,419    8.774489    1.324564          1          9
        v467 |      1,419    8.791402    1.275309          1          9
        v468 |      1,419    8.836505    1.132315          1          9
-------------+---------------------------------------------------------
        v469 |      1,419    8.904158    .8706811          1          9
        v470 |      1,419    8.926709    .7624739          1          9
        v471 |      1,419    8.937984    .7018727          1          9
        v472 |      1,419    8.971811    .4742096          1          9
        v473 |      1,419           9           0          9          9
-------------+---------------------------------------------------------
        v474 |      1,419    8.656096    1.623213          1          9
        v475 |      1,419    8.565891    1.812935          1          9
        v476 |      1,419    8.475687    1.980496          1          9
        v477 |      1,419    7.472163    3.145692          1          9
        v478 |      1,419    5.634249    3.950788          1          9
-------------+---------------------------------------------------------
        v479 |      1,419    5.256519    3.993174          1          9
        v480 |      1,419    4.557435    3.976843          1          9
        v481 |      1,419    4.326286    3.944246          1          9
        v482 |      1,419     3.93728    3.857605          1          9
        v483 |      1,419    4.174066     3.91518          1          9
-------------+---------------------------------------------------------
        v484 |      1,419    4.461593    3.964996          1          9
        v485 |      1,419     4.82241    3.997465          1          9
        v486 |      1,419     5.07611    4.000686          1          9
        v487 |      1,419    5.301621    3.990018          1          9
        v488 |      1,419    5.420014     3.97929          1          9
-------------+---------------------------------------------------------
        v489 |      1,419    5.566596    3.961064          1          9
        v490 |      1,419    5.735729    3.933142          1          9
        v491 |      1,419    5.848485    3.910352          1          9
        v492 |      1,419    5.899225    3.898988          1          9
        v493 |      1,419    6.034531    3.865265          1          9
-------------+---------------------------------------------------------
        v494 |      1,419    6.119098    3.841617          1          9
        v495 |      1,419    6.271318    3.793929          1          9
        v496 |      1,419    6.400987    3.747951          1          9
        v497 |      1,419    6.451727    3.728577          1          9
        v498 |      1,419    6.592671    3.670544          1          9
-------------+---------------------------------------------------------
        v499 |      1,419    6.564482    3.682656          1          9
        v500 |      1,419    6.598309    3.668091          1          9
        v501 |      1,419    6.682875    3.630044          1          9
        v502 |      1,419    6.789993      3.5784          1          9
        v503 |      1,419     6.82382    3.561267          1          9
-------------+---------------------------------------------------------
        v504 |      1,419    6.919662    3.510496          1          9
        v505 |      1,419    7.071882      3.4228          1          9
        v506 |      1,419    7.122622    3.391546          1          9
        v507 |      1,419    7.145173    3.377317          1          9
        v508 |      1,419    7.280479    3.287405          1          9
-------------+---------------------------------------------------------
        v509 |      1,419    7.376321    3.218757          1          9
        v510 |      1,419    7.483439    3.136792          1          9
        v511 |      1,419    7.573643    3.063164          1          9
        v512 |      1,419    7.680761    2.969804          1          9
        v513 |      1,419    7.765328    2.891168          1          9
-------------+---------------------------------------------------------
        v514 |      1,419    7.883721    2.773008          1          9
        v515 |      1,419     7.96265    2.688457          1          9
        v516 |      1,419     8.06413    2.572114          1          9
        v517 |      1,419    8.182523    2.423982          1          9
        v518 |      1,419    8.261452    2.316617          1          9
-------------+---------------------------------------------------------
        v519 |      1,419    8.481325    1.970562          1          9
        v520 |      1,419    8.723749    1.461231          1          9
        v521 |      1,419    8.757576    1.371842          1          9
        v522 |      1,419    8.802678     1.24126          1          9
        v523 |      1,419    8.859056    1.052839          1          9
-------------+---------------------------------------------------------
        v524 |      1,419    8.892882    .9198171          1          9
        v525 |      1,419    8.932347    .7328217          1          9
        v526 |      1,419    8.954898    .5991964          1          9
        v527 |      1,419    8.971811    .4742096          1          9
        v528 |      1,419    8.971811    .4742096          1          9
-------------+---------------------------------------------------------
        v529 |      1,419    8.960536    .5606955          1          9
        v530 |      1,419    8.943622     .669447          1          9
        v531 |      1,419    8.881607    .9663265          1          9
        v532 |      1,419    8.853418    1.073304          1          9
        v533 |      1,419    8.825229    1.169866          1          9
-------------+---------------------------------------------------------
        v534 |      1,419    8.791402    1.275309          1          9
        v535 |      1,419      8.7463    1.402363          1          9
        v536 |      1,419    8.627907    1.685317          1          9
        v537 |      1,419    8.577167    1.790568          1          9
        v538 |      1,419    8.515152    1.909523          1          9
-------------+---------------------------------------------------------
        v539 |      1,419    8.486963    1.960561          1          9
        v540 |      1,419     8.44186    2.038756          1          9
        v541 |      1,419    8.436223    2.048251          1          9
        v542 |      1,419    8.424947    2.067063          1          9
        v543 |      1,419    8.402396    2.104001          1          9
-------------+---------------------------------------------------------
        v544 |      1,419    8.334743    2.209736          1          9
        v545 |      1,419    8.334743    2.209736          1          9
        v546 |      1,419    8.340381    2.201198          1          9
        v547 |      1,419    8.329105    2.218226          1          9
        v548 |      1,419    8.323467     2.22667          1          9
-------------+---------------------------------------------------------
        v549 |      1,419    8.312192     2.24342          1          9
        v550 |      1,419    8.317829    2.235068          1          9
        v551 |      1,419    8.334743    2.209736          1          9
        v552 |      1,419    8.340381    2.201198          1          9
        v553 |      1,419    8.346018    2.192612          1          9
-------------+---------------------------------------------------------
        v554 |      1,419    8.351656    2.183979          1          9
        v555 |      1,419    8.362932    2.166564          1          9
        v556 |      1,419    8.391121    2.122139          1          9
        v557 |      1,419    8.430585    2.057686          1          9
        v558 |      1,419    8.458774    2.009908          1          9
-------------+---------------------------------------------------------
        v559 |      1,419      8.4926    1.950493          1          9
        v560 |      1,419    8.503876     1.93015          1          9
        v561 |      1,419    8.509514    1.919873          1          9
        v562 |      1,419    8.515152    1.909523          1          9
        v563 |      1,419    8.537703    1.867383          1          9
-------------+---------------------------------------------------------
        v564 |      1,419     8.54334    1.856655          1          9
        v565 |      1,419    8.577167    1.790568          1          9
        v566 |      1,419     8.59408    1.756349          1          9
        v567 |      1,419    8.610994    1.721282          1          9
        v568 |      1,419    8.639183    1.660811          1          9
-------------+---------------------------------------------------------
        v569 |      1,419    8.673009    1.584542          1          9
        v570 |      1,419    8.706836    1.503649          1          9
        v571 |      1,419    8.735025    1.432144          1          9
        v572 |      1,419    8.774489    1.324564          1          9
        v573 |      1,419    8.813953    1.206144          1          9
-------------+---------------------------------------------------------
        v574 |      1,419    8.853418    1.073304          1          9
        v575 |      1,419    8.859056    1.052839          1          9
        v576 |      1,419    8.875969    .9887129          1          9
        v577 |      1,419    8.904158    .8706811          1          9
        v578 |      1,419    8.926709    .7624739          1          9
-------------+---------------------------------------------------------
        v579 |      1,419     8.94926    .6353185          1          9
        v580 |      1,419     8.94926    .6353185          1          9
        v581 |      1,419    8.966173    .5192869          1          9
        v582 |      1,419    8.994362    .2123727          1          9
        v583 |      1,419    8.994362    .2123727          1          9
-------------+---------------------------------------------------------
        v584 |      1,419    8.994362    .2123727          1          9
        v585 |      1,419    8.988724    .3002345          1          9
        v586 |      1,419    8.988724    .3002345          1          9
        v587 |      1,419    8.994362    .2123727          1          9
        v588 |      1,419    8.977449     .424296          1          9
-------------+---------------------------------------------------------
        v589 |      1,419    8.971811    .4742096          1          9
        v590 |      1,419    8.966173    .5192869          1          9
        v591 |      1,419    8.960536    .5606955          1          9
        v592 |      1,419    8.943622     .669447          1          9
        v593 |      1,419    8.921071    .7909752          1          9
-------------+---------------------------------------------------------
        v594 |      1,419    8.881607    .9663265          1          9
        v595 |      1,419    8.864693    1.031938          1          9
        v596 |      1,419    8.859056    1.052839          1          9
        v597 |      1,419    8.859056    1.052839          1          9
        v598 |      1,419    8.853418    1.073304          1          9
-------------+---------------------------------------------------------
        v599 |      1,419     8.84778    1.093357          1          9
        v600 |      1,419    8.853418    1.073304          1          9
        v601 |      1,419    8.864693    1.031938          1          9
        v602 |      1,419    8.853418    1.073304          1          9
        v603 |      1,419    8.859056    1.052839          1          9
-------------+---------------------------------------------------------
        v604 |      1,419    8.864693    1.031938          1          9
        v605 |      1,419    8.859056    1.052839          1          9
        v606 |      1,419    8.853418    1.073304          1          9
        v607 |      1,419    8.859056    1.052839          1          9
        v608 |      1,419    8.887245    .9433754          1          9
-------------+---------------------------------------------------------
        v609 |      1,419     8.89852    .8956039          1          9
        v610 |      1,419    8.904158    .8706811          1          9
        v611 |      1,419    8.921071    .7909752          1          9
        v612 |      1,419    8.915433    .8184457          1          9
        v613 |      1,419    8.904158    .8706811          1          9
-------------+---------------------------------------------------------
        v614 |      1,419    8.915433    .8184457          1          9
        v615 |      1,419    8.926709    .7624739          1          9
        v616 |      1,419    8.943622     .669447          1          9
        v617 |      1,419     8.94926    .6353185          1          9
        v618 |      1,419    8.960536    .5606955          1          9
-------------+---------------------------------------------------------
        v619 |      1,419    8.966173    .5192869          1          9
        v620 |      1,419    8.971811    .4742096          1          9
        v621 |      1,419    8.971811    .4742096          1          9
        v622 |      1,419    8.971811    .4742096          1          9
        v623 |      1,419    8.971811    .4742096          1          9
-------------+---------------------------------------------------------
        v624 |      1,419    8.971811    .4742096          1          9
        v625 |      1,419    8.971811    .4742096          1          9
        v626 |      1,419    8.977449     .424296          1          9
        v627 |      1,419    8.983087    .3675809          1          9
        v628 |      1,419    8.983087    .3675809          1          9
-------------+---------------------------------------------------------
        v629 |      1,419    8.983087    .3675809          1          9
        v630 |      1,419    8.983087    .3675809          1          9
        v631 |      1,419    8.983087    .3675809          1          9
        v632 |      1,419    8.988724    .3002345          1          9
        v633 |      1,419    8.994362    .2123727          1          9
-------------+---------------------------------------------------------
        v634 |      1,419           9           0          9          9
        v635 |      1,419           9           0          9          9
        v636 |      1,419    8.966173    .5192869          1          9
        v637 |      1,419    8.960536    .5606955          1          9
        v638 |      1,419    8.954898    .5991964          1          9
-------------+---------------------------------------------------------
        v639 |      1,419    8.932347    .7328217          1          9
        v640 |      1,419    8.870331    1.010572          1          9
        v641 |      1,419    8.853418    1.073304          1          9
        v642 |      1,419    8.802678     1.24126          1          9
        v643 |      1,419    8.735025    1.432144          1          9
-------------+---------------------------------------------------------
        v644 |      1,419    8.684285    1.558126          1          9
        v645 |      1,419     8.64482    1.648393          1          9
        v646 |      1,419    8.656096    1.623213          1          9
        v647 |      1,419    8.616631    1.709396          1          9
        v648 |      1,419     8.59408    1.756349          1          9
-------------+---------------------------------------------------------
        v649 |      1,419    8.622269    1.697409          1          9
        v650 |      1,419    8.605356    1.733068          1          9
        v651 |      1,419     8.59408    1.756349          1          9
        v652 |      1,419     8.59408    1.756349          1          9
        v653 |      1,419     8.59408    1.756349          1          9
-------------+---------------------------------------------------------
        v654 |      1,419    8.582805    1.779253          1          9
        v655 |      1,419    8.582805    1.779253          1          9
        v656 |      1,419    8.622269    1.697409          1          9
        v657 |      1,419     8.64482    1.648393          1          9
        v658 |      1,419    8.661734    1.610445          1          9
-------------+---------------------------------------------------------
        v659 |      1,419     8.69556    1.531172          1          9
        v660 |      1,419     8.69556    1.531172          1          9
        v661 |      1,419    8.729387    1.446772          1          9
        v662 |      1,419    8.740662    1.417343          1          9
        v663 |      1,419    8.751938    1.387198          1          9
-------------+---------------------------------------------------------
        v664 |      1,419    8.768851    1.340532          1          9
        v665 |      1,419    8.763214    1.356289          1          9
        v666 |      1,419    8.785765    1.291961          1          9
        v667 |      1,419    8.791402    1.275309          1          9
        v668 |      1,419     8.79704    1.258412          1          9
-------------+---------------------------------------------------------
        v669 |      1,419    8.808316    1.223841          1          9
        v670 |      1,419    8.819591    1.188157          1          9
        v671 |      1,419    8.830867    1.151257          1          9
        v672 |      1,419    8.813953    1.206144          1          9
        v673 |      1,419    8.819591    1.188157          1          9
-------------+---------------------------------------------------------
        v674 |      1,419    8.819591    1.188157          1          9
        v675 |      1,419    8.819591    1.188157          1          9
        v676 |      1,419    8.836505    1.132315          1          9
        v677 |      1,419     8.84778    1.093357          1          9
        v678 |      1,419    8.859056    1.052839          1          9
-------------+---------------------------------------------------------
        v679 |      1,419    8.881607    .9663265          1          9
        v680 |      1,419    8.892882    .9198171          1          9
        v681 |      1,419     8.89852    .8956039          1          9
        v682 |      1,419    8.915433    .8184457          1          9
        v683 |      1,419    8.937984    .7018727          1          9
-------------+---------------------------------------------------------
        v684 |      1,419    8.943622     .669447          1          9
        v685 |      1,419    8.937984    .7018727          1          9
        v686 |      1,419     8.94926    .6353185          1          9
        v687 |      1,419    8.954898    .5991964          1          9
        v688 |      1,419    8.971811    .4742096          1          9
-------------+---------------------------------------------------------
        v689 |      1,419    8.983087    .3675809          1          9

. 
. ** variable number of spouse
. *** common variable with other years
. gen relno=.
(1,419 missing values generated)

. gen dsex=.
(1,419 missing values generated)

. gen bYear=.
(1,419 missing values generated)

. gen bMonth=.
(1,419 missing values generated)

. local renameListSpo ///
>                                 v1 v4 v14 v15 v16 ///
>                                 v76 ///
>                                 v813 v834 ///
>                                 v881 v882 v823 v824 v887 v888 ///
>                                 v900 v901 v902 ///
>                                 v906 v907 v908 v909 v910 v911 ///
>                                 v924 v925 v926

. *** variables of working experience
. global CasSpo v1098-v1151

. global FullSpo v1152-v1205

. global SelfSpo v1206-v1259

. global SideSpo v1260-v1313

. global FmwSpo v1314-v1367

. sum `renameListSpo' $CasSpo $FullSpo $SelfSpo $SideSpo $FmwSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      1,419        5710    409.7743       5001       6419
          v4 |      1,419    1.264975    .4414757          1          2
         v14 |      1,419    1.724454    1.471224          1          9
         v15 |      1,419    2381.216    1699.624       1913       9999
         v16 |      1,419    11.45948    20.15232          0         99
-------------+---------------------------------------------------------
         v76 |      1,419    2.926709    11.22191          1         99
        v813 |      1,419    4.137421    2.555202          1          9
        v834 |      1,419    4.056378    3.002994          1          9
        v881 |      1,419    45.62579    41.01354          1         99
        v882 |      1,419    4.845666    3.089999          1          9
-------------+---------------------------------------------------------
        v823 |      1,419    7.979563    1.078841          1          9
        v824 |      1,419     8.11487    .5819792          1          9
        v887 |      1,419    6.102889    2.088145          1          9
        v888 |      1,419    5.852008    2.894589          1          9
        v900 |      1,419    5421.453    3487.563       1941       9999
-------------+---------------------------------------------------------
        v901 |      1,419    46.34531    41.80555          0         99
        v902 |      1,419    5.091614    3.088046          1          9
        v906 |      1,419    5.066244    3.321063          1          9
        v907 |      1,419    58119.64    42331.68         10      99999
        v908 |      1,419    867891.4    134602.2       3500     999999
-------------+---------------------------------------------------------
        v909 |      1,419    830227.3    220984.6        620     999999
        v910 |      1,419    86653.04    13910.45         50      99999
        v911 |      1,419    47456.36    45108.08          0      99999
        v924 |      1,419    55.33545    34.21836          1         99
        v925 |      1,419      494.26    431.1574          1        999
-------------+---------------------------------------------------------
        v926 |      1,419    601.3136    438.3673          0        999
       v1098 |      1,419    8.689922    .7280235          1          9
       v1099 |      1,419    8.678647    .7830463          1          9
       v1100 |      1,419    8.667371    .8342963          1          9
       v1101 |      1,419    8.605356    1.071163          1          9
-------------+---------------------------------------------------------
       v1102 |      1,419      8.4926    1.395811          1          9
       v1103 |      1,419    8.413672    1.579169          1          9
       v1104 |      1,419    8.351656    1.706935          1          9
       v1105 |      1,419    8.396758    1.615254          1          9
       v1106 |      1,419    8.408034    1.591308          1          9
-------------+---------------------------------------------------------
       v1107 |      1,419    8.413672    1.579169          1          9
       v1108 |      1,419    8.374207     1.66188          1          9
       v1109 |      1,419    8.396758    1.615254          1          9
       v1110 |      1,419    8.402396    1.603336          1          9
       v1111 |      1,419    8.391121    1.627065          1          9
-------------+---------------------------------------------------------
       v1112 |      1,419    8.385483    1.638771          1          9
       v1113 |      1,419    8.368569    1.673286          1          9
       v1114 |      1,419    8.391121    1.627065          1          9
       v1115 |      1,419    8.413672    1.579169          1          9
       v1116 |      1,419    8.379845    1.650376          1          9
-------------+---------------------------------------------------------
       v1117 |      1,419    8.334743    1.739769          1          9
       v1118 |      1,419    8.306554    1.792802          1          9
       v1119 |      1,419    8.278365    1.843879          1          9
       v1120 |      1,419    8.306554    1.792802          1          9
       v1121 |      1,419    8.340381    1.728912          1          9
-------------+---------------------------------------------------------
       v1122 |      1,419    8.340381    1.728912          1          9
       v1123 |      1,419    8.306554    1.792802          1          9
       v1124 |      1,419    8.312192    1.782357          1          9
       v1125 |      1,419    8.312192    1.782357          1          9
       v1126 |      1,419    8.306554    1.792802          1          9
-------------+---------------------------------------------------------
       v1127 |      1,419    8.329105    1.750541          1          9
       v1128 |      1,419    8.340381    1.728912          1          9
       v1129 |      1,419    8.391121    1.627065          1          9
       v1130 |      1,419    8.402396    1.603336          1          9
       v1131 |      1,419    8.385483    1.638771          1          9
-------------+---------------------------------------------------------
       v1132 |      1,419    8.374207     1.66188          1          9
       v1133 |      1,419    8.419309    1.566916          1          9
       v1134 |      1,419    8.453136    1.490836          1          9
       v1135 |      1,419    8.515152    1.337963          1          9
       v1136 |      1,419    8.532065    1.292621          1          9
-------------+---------------------------------------------------------
       v1137 |      1,419    8.565891    1.196076          1          9
       v1138 |      1,419    8.571529    1.179123          1          9
       v1139 |      1,419    8.588443    1.126564          1          9
       v1140 |      1,419    8.588443    1.126564          1          9
       v1141 |      1,419    8.599718    1.089972          1          9
-------------+---------------------------------------------------------
       v1142 |      1,419     8.59408    1.108434          1          9
       v1143 |      1,419    8.599718    1.089972          1          9
       v1144 |      1,419    8.599718    1.089972          1          9
       v1145 |      1,419    8.633545    .9711796          1          9
       v1146 |      1,419    8.622269    1.012453          1          9
-------------+---------------------------------------------------------
       v1147 |      1,419    8.639183    .9498205          1          9
       v1148 |      1,419     8.64482    .9279356          1          9
       v1149 |      1,419    8.656096    .8824311          1          9
       v1150 |      1,419    8.673009    .8090968          1          9
       v1151 |      1,419    8.684285    .7560567          1          9
-------------+---------------------------------------------------------
       v1152 |      1,419    8.481325     1.42372          1          9
       v1153 |      1,419    8.402396    1.603336          1          9
       v1154 |      1,419    8.329105    1.750541          1          9
       v1155 |      1,419    7.624383    2.694977          1          9
       v1156 |      1,419    6.282593    3.536798          1          9
-------------+---------------------------------------------------------
       v1157 |      1,419    6.130374    3.588384          1          9
       v1158 |      1,419    5.470754    3.732745          1          9
       v1159 |      1,419     5.17759    3.758136          1          9
       v1160 |      1,419    4.743481    3.753572          1          9
       v1161 |      1,419    4.737844    3.753182          1          9
-------------+---------------------------------------------------------
       v1162 |      1,419    4.878788    3.760378          1          9
       v1163 |      1,419    5.093023    3.761182          1          9
       v1164 |      1,419    5.256519    3.753572          1          9
       v1165 |      1,419    5.346723    3.746311          1          9
       v1166 |      1,419    5.504581     3.72832          1          9
-------------+---------------------------------------------------------
       v1167 |      1,419    5.600423    3.714079          1          9
       v1168 |      1,419    5.696265    3.697299          1          9
       v1169 |      1,419    5.814658    3.673011          1          9
       v1170 |      1,419    5.842847    3.666641          1          9
       v1171 |      1,419    5.882311    3.657339          1          9
-------------+---------------------------------------------------------
       v1172 |      1,419    6.000705    3.626711          1          9
       v1173 |      1,419    6.073996    3.605672          1          9
       v1174 |      1,419    6.152925    3.581198          1          9
       v1175 |      1,419    6.192389    3.568242          1          9
       v1176 |      1,419    6.248767    3.548891          1          9
-------------+---------------------------------------------------------
       v1177 |      1,419    6.350247    3.511509          1          9
       v1178 |      1,419    6.406624    3.489292          1          9
       v1179 |      1,419    6.508104    3.446617          1          9
       v1180 |      1,419    6.615222      3.3977          1          9
       v1181 |      1,419      6.6716    3.370301          1          9
-------------+---------------------------------------------------------
       v1182 |      1,419    6.744891     3.33292          1          9
       v1183 |      1,419    6.846371    3.277752          1          9
       v1184 |      1,419    6.947851    3.218439          1          9
       v1185 |      1,419    7.009866    3.180053          1          9
       v1186 |      1,419    7.094433    3.124965          1          9
-------------+---------------------------------------------------------
       v1187 |      1,419    7.128259     3.10201          1          9
       v1188 |      1,419    7.190275    3.058506          1          9
       v1189 |      1,419    7.274841    2.996097          1          9
       v1190 |      1,419    7.398872    2.897672          1          9
       v1191 |      1,419    7.449612    2.854876          1          9
-------------+---------------------------------------------------------
       v1192 |      1,419    7.562368     2.75405          1          9
       v1193 |      1,419     7.65821    2.661594          1          9
       v1194 |      1,419    7.765328    2.550043          1          9
       v1195 |      1,419    7.816068    2.493856          1          9
       v1196 |      1,419     7.91191    2.381166          1          9
-------------+---------------------------------------------------------
       v1197 |      1,419    8.052854    2.197421          1          9
       v1198 |      1,419    8.368569    1.673286          1          9
       v1199 |      1,419    8.436223    1.529443          1          9
       v1200 |      1,419    8.503876    1.367239          1          9
       v1201 |      1,419    8.565891    1.196076          1          9
-------------+---------------------------------------------------------
       v1202 |      1,419    8.616631    1.032425          1          9
       v1203 |      1,419    8.656096    .8824311          1          9
       v1204 |      1,419    8.678647    .7830463          1          9
       v1205 |      1,419    8.684285    .7560567          1          9
       v1206 |      1,419    8.706836    .6362596          1          9
-------------+---------------------------------------------------------
       v1207 |      1,419    8.701198    .6682968          1          9
       v1208 |      1,419    8.689922    .7280235          1          9
       v1209 |      1,419    8.667371    .8342963          1          9
       v1210 |      1,419    8.627907     .992047          1          9
       v1211 |      1,419    8.616631    1.032425          1          9
-------------+---------------------------------------------------------
       v1212 |      1,419    8.565891    1.196076          1          9
       v1213 |      1,419     8.54334    1.261362          1          9
       v1214 |      1,419    8.498238     1.38161          1          9
       v1215 |      1,419      8.4926    1.395811          1          9
       v1216 |      1,419    8.447498    1.503836          1          9
-------------+---------------------------------------------------------
       v1217 |      1,419    8.447498    1.503836          1          9
       v1218 |      1,419    8.402396    1.603336          1          9
       v1219 |      1,419    8.385483    1.638771          1          9
       v1220 |      1,419    8.374207     1.66188          1          9
       v1221 |      1,419    8.346018    1.717968          1          9
-------------+---------------------------------------------------------
       v1222 |      1,419    8.340381    1.728912          1          9
       v1223 |      1,419    8.317829    1.771833          1          9
       v1224 |      1,419    8.312192    1.782357          1          9
       v1225 |      1,419    8.300916    1.803169          1          9
       v1226 |      1,419    8.272727    1.853875          1          9
-------------+---------------------------------------------------------
       v1227 |      1,419    8.261452    1.873654          1          9
       v1228 |      1,419    8.255814     1.88344          1          9
       v1229 |      1,419    8.238901      1.9124          1          9
       v1230 |      1,419    8.250176     1.89316          1          9
       v1231 |      1,419    8.261452    1.873654          1          9
-------------+---------------------------------------------------------
       v1232 |      1,419    8.238901      1.9124          1          9
       v1233 |      1,419    8.244538    1.902812          1          9
       v1234 |      1,419    8.255814     1.88344          1          9
       v1235 |      1,419    8.267089    1.863799          1          9
       v1236 |      1,419    8.295278    1.813458          1          9
-------------+---------------------------------------------------------
       v1237 |      1,419    8.312192    1.782357          1          9
       v1238 |      1,419    8.323467    1.761228          1          9
       v1239 |      1,419    8.340381    1.728912          1          9
       v1240 |      1,419    8.357294    1.695812          1          9
       v1241 |      1,419    8.385483    1.638771          1          9
-------------+---------------------------------------------------------
       v1242 |      1,419    8.391121    1.627065          1          9
       v1243 |      1,419    8.385483    1.638771          1          9
       v1244 |      1,419    8.396758    1.615254          1          9
       v1245 |      1,419    8.419309    1.566916          1          9
       v1246 |      1,419    8.424947    1.554546          1          9
-------------+---------------------------------------------------------
       v1247 |      1,419    8.458774    1.477699          1          9
       v1248 |      1,419    8.475687    1.437438          1          9
       v1249 |      1,419    8.503876    1.367239          1          9
       v1250 |      1,419    8.526427    1.307934          1          9
       v1251 |      1,419    8.565891    1.196076          1          9
-------------+---------------------------------------------------------
       v1252 |      1,419    8.577167    1.161895          1          9
       v1253 |      1,419    8.588443    1.126564          1          9
       v1254 |      1,419    8.610994    1.051987          1          9
       v1255 |      1,419    8.639183    .9498205          1          9
       v1256 |      1,419    8.656096    .8824311          1          9
-------------+---------------------------------------------------------
       v1257 |      1,419    8.667371    .8342963          1          9
       v1258 |      1,419    8.673009    .8090968          1          9
       v1259 |      1,419    8.673009    .8090968          1          9
       v1260 |      1,419    8.735025    .4414757          8          9
       v1261 |      1,419    8.735025    .4414757          8          9
-------------+---------------------------------------------------------
       v1262 |      1,419    8.735025    .4414757          8          9
       v1263 |      1,419    8.735025    .4414757          8          9
       v1264 |      1,419    8.735025    .4414757          8          9
       v1265 |      1,419    8.735025    .4414757          8          9
       v1266 |      1,419    8.735025    .4414757          8          9
-------------+---------------------------------------------------------
       v1267 |      1,419    8.729387    .4868399          1          9
       v1268 |      1,419    8.718111      .56661          1          9
       v1269 |      1,419    8.718111      .56661          1          9
       v1270 |      1,419    8.706836    .6362596          1          9
       v1271 |      1,419     8.69556    .6988213          1          9
-------------+---------------------------------------------------------
       v1272 |      1,419     8.69556    .6988213          1          9
       v1273 |      1,419    8.684285    .7560567          1          9
       v1274 |      1,419    8.678647    .7830463          1          9
       v1275 |      1,419    8.678647    .7830463          1          9
       v1276 |      1,419    8.661734    .8587195          1          9
-------------+---------------------------------------------------------
       v1277 |      1,419    8.656096    .8824311          1          9
       v1278 |      1,419    8.656096    .8824311          1          9
       v1279 |      1,419    8.650458    .9054868          1          9
       v1280 |      1,419    8.673009    .8090968          1          9
       v1281 |      1,419    8.678647    .7830463          1          9
-------------+---------------------------------------------------------
       v1282 |      1,419    8.661734    .8587195          1          9
       v1283 |      1,419    8.673009    .8090968          1          9
       v1284 |      1,419    8.678647    .7830463          1          9
       v1285 |      1,419    8.689922    .7280235          1          9
       v1286 |      1,419    8.684285    .7560567          1          9
-------------+---------------------------------------------------------
       v1287 |      1,419    8.684285    .7560567          1          9
       v1288 |      1,419     8.69556    .6988213          1          9
       v1289 |      1,419    8.701198    .6682968          1          9
       v1290 |      1,419    8.706836    .6362596          1          9
       v1291 |      1,419    8.706836    .6362596          1          9
-------------+---------------------------------------------------------
       v1292 |      1,419    8.718111      .56661          1          9
       v1293 |      1,419    8.723749     .528263          1          9
       v1294 |      1,419    8.723749     .528263          1          9
       v1295 |      1,419    8.723749     .528263          1          9
       v1296 |      1,419    8.723749     .528263          1          9
-------------+---------------------------------------------------------
       v1297 |      1,419    8.723749     .528263          1          9
       v1298 |      1,419    8.723749     .528263          1          9
       v1299 |      1,419    8.723749     .528263          1          9
       v1300 |      1,419    8.718111      .56661          1          9
       v1301 |      1,419    8.723749     .528263          1          9
-------------+---------------------------------------------------------
       v1302 |      1,419    8.729387    .4868399          1          9
       v1303 |      1,419    8.735025    .4414757          8          9
       v1304 |      1,419    8.735025    .4414757          8          9
       v1305 |      1,419    8.735025    .4414757          8          9
       v1306 |      1,419    8.735025    .4414757          8          9
-------------+---------------------------------------------------------
       v1307 |      1,419    8.735025    .4414757          8          9
       v1308 |      1,419    8.735025    .4414757          8          9
       v1309 |      1,419    8.735025    .4414757          8          9
       v1310 |      1,419    8.735025    .4414757          8          9
       v1311 |      1,419    8.735025    .4414757          8          9
-------------+---------------------------------------------------------
       v1312 |      1,419    8.735025    .4414757          8          9
       v1313 |      1,419    8.735025    .4414757          8          9
       v1314 |      1,419    8.701198    .6682968          1          9
       v1315 |      1,419     8.69556    .6988213          1          9
       v1316 |      1,419    8.689922    .7280235          1          9
-------------+---------------------------------------------------------
       v1317 |      1,419    8.656096    .8824311          1          9
       v1318 |      1,419     8.59408    1.108434          1          9
       v1319 |      1,419    8.588443    1.126564          1          9
       v1320 |      1,419    8.515152    1.337963          1          9
       v1321 |      1,419    8.509514    1.352692          1          9
-------------+---------------------------------------------------------
       v1322 |      1,419    8.464412    1.464424          1          9
       v1323 |      1,419    8.413672    1.579169          1          9
       v1324 |      1,419    8.385483    1.638771          1          9
       v1325 |      1,419    8.374207     1.66188          1          9
       v1326 |      1,419    8.368569    1.673286          1          9
-------------+---------------------------------------------------------
       v1327 |      1,419    8.362932    1.684596          1          9
       v1328 |      1,419    8.362932    1.684596          1          9
       v1329 |      1,419    8.357294    1.695812          1          9
       v1330 |      1,419    8.351656    1.706935          1          9
       v1331 |      1,419    8.346018    1.717968          1          9
-------------+---------------------------------------------------------
       v1332 |      1,419    8.340381    1.728912          1          9
       v1333 |      1,419    8.385483    1.638771          1          9
       v1334 |      1,419    8.396758    1.615254          1          9
       v1335 |      1,419    8.396758    1.615254          1          9
       v1336 |      1,419    8.413672    1.579169          1          9
-------------+---------------------------------------------------------
       v1337 |      1,419    8.413672    1.579169          1          9
       v1338 |      1,419    8.436223    1.529443          1          9
       v1339 |      1,419    8.447498    1.503836          1          9
       v1340 |      1,419    8.470049    1.451004          1          9
       v1341 |      1,419    8.475687    1.437438          1          9
-------------+---------------------------------------------------------
       v1342 |      1,419    8.486963    1.409846          1          9
       v1343 |      1,419    8.503876    1.367239          1          9
       v1344 |      1,419    8.509514    1.352692          1          9
       v1345 |      1,419    8.526427    1.307934          1          9
       v1346 |      1,419    8.526427    1.307934          1          9
-------------+---------------------------------------------------------
       v1347 |      1,419    8.532065    1.292621          1          9
       v1348 |      1,419     8.54334    1.261362          1          9
       v1349 |      1,419    8.560254    1.212767          1          9
       v1350 |      1,419    8.565891    1.196076          1          9
       v1351 |      1,419    8.571529    1.179123          1          9
-------------+---------------------------------------------------------
       v1352 |      1,419    8.582805     1.14438          1          9
       v1353 |      1,419    8.582805     1.14438          1          9
       v1354 |      1,419     8.59408    1.108434          1          9
       v1355 |      1,419    8.599718    1.089972          1          9
       v1356 |      1,419    8.616631    1.032425          1          9
-------------+---------------------------------------------------------
       v1357 |      1,419    8.616631    1.032425          1          9
       v1358 |      1,419    8.633545    .9711796          1          9
       v1359 |      1,419     8.64482    .9279356          1          9
       v1360 |      1,419    8.650458    .9054868          1          9
       v1361 |      1,419    8.650458    .9054868          1          9
-------------+---------------------------------------------------------
       v1362 |      1,419    8.656096    .8824311          1          9
       v1363 |      1,419    8.661734    .8587195          1          9
       v1364 |      1,419    8.684285    .7560567          1          9
       v1365 |      1,419     8.69556    .6988213          1          9
       v1366 |      1,419    8.718111      .56661          1          9
-------------+---------------------------------------------------------
       v1367 |      1,419    8.723749     .528263          1          9

. 
. ** variable list to be convert to matrix
. local matVarList `varList' dhead dearnmost $ExpList

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPSnew2007

. 
. * 1. rename varname and make head dummy
. local renameList renameListPri renameListSpo

. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** rename variable of experience
.         dis " rename variable of experience "
  6.         global Resp_i `i'
  7.         global Age_t 15
  8.         do "$Path\Code\Renamevar_Exp.do"
  9.         
.         if `i'==1 {
 10.                 dis " replace id of principle "
 11.                 ** replace id (KHPS)
.                 replace id = id+20000
 12.         }
 13.         else {
 14.                 dis " replace id of spouse and drop not married "
 15.                 ** replace id (spouse)
.                 replace id = id+10000
 16.                 ** keep sample of spouse
.                 keep if marital==1
 17.                 count
 18.         }
 19.         
.         dis " make household head dummy  "
 20.         ** make breadwinner dummy
.         gen dearnmost=.
 21.         replace dearnmost=1 if earnmost==`i'
 22.         replace dearnmost=0 if dearnmost!=1
 23.         label var dearnmost "Breadwinner dummy"
 24.         tab earnmost marital, sum(dearnmost) mean miss
 25.         
.         ** make household head dummy
.         gen dhead=.
 26.         replace dhead=dearnmost
 27.         label var dhead "HH head dummy"
 28.         
.         sum id
 29.         
.         ** save variable as matrix
.         if `i'==1{
 30.                 local matName pri
 31.         }
 32.         else {
 33.                 local matName spo
 34.         }
 35.         mkmat `matVarList', matrix(`matName')
 36.         mat dir
 37.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 38.         drop dhead dearnmost
 39.         drop $ExpList
 40. }
 ** Rename variables of renameListPri 
 rename variable of experience 

. *******************************************************
. *Title: Renamevar_Exp
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables of working experience
. * 
. * 1. rename vars. of experience
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. * set list of variables
. ** of principal
. local casPri $CasPri

. local fullPri $FullPri

. local selfPri $SelfPri

. local sidePri $SidePri

. local fmwPri $FmwPri

. ** of spouse
. local casSpo $CasSpo

. local fullSpo $FullSpo

. local selfSpo $SelfSpo

. local sideSpo $SideSpo

. local fmwSpo $FmwSpo

. 
. * 1. rename vars. of experience
. local empStatus cas full self side fmw

. local num_m: word count `empStatus'

. local resp_i $Resp_i

. local age_t $Age_t

. 
. if `resp_i'==1{
.         local expVar casPri fullPri selfPri sidePri fmwPri
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. else {
.         local expVar casSpo fullSpo selfSpo sideSpo fmwSpo
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. sum $ExpList

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       cas15 |      1,419    8.943622     .669447          1          9
       cas16 |      1,419    8.887245    .9433754          1          9
       cas17 |      1,419    8.864693    1.031938          1          9
       cas18 |      1,419    8.729387    1.446772          1          9
       cas19 |      1,419    8.520789    1.899101          1          9
-------------+---------------------------------------------------------
       cas20 |      1,419    8.498238    1.940356          1          9
       cas21 |      1,419    8.475687    1.980496          1          9
       cas22 |      1,419    8.498238    1.940356          1          9
       cas23 |      1,419    8.447498    2.029201          1          9
       cas24 |      1,419    8.458774    2.009908          1          9
-------------+---------------------------------------------------------
       cas25 |      1,419    8.447498    2.029201          1          9
       cas26 |      1,419    8.408034     2.09485          1          9
       cas27 |      1,419    8.470049    1.990364          1          9
       cas28 |      1,419    8.498238    1.940356          1          9
       cas29 |      1,419    8.565891    1.812935          1          9
-------------+---------------------------------------------------------
       cas30 |      1,419    8.537703    1.867383          1          9
       cas31 |      1,419    8.571529    1.801795          1          9
       cas32 |      1,419    8.526427    1.888604          1          9
       cas33 |      1,419    8.520789    1.899101          1          9
       cas34 |      1,419    8.503876     1.93015          1          9
-------------+---------------------------------------------------------
       cas35 |      1,419     8.44186    2.038756          1          9
       cas36 |      1,419    8.424947    2.067063          1          9
       cas37 |      1,419    8.419309    2.076382          1          9
       cas38 |      1,419    8.385483    2.131128          1          9
       cas39 |      1,419    8.351656    2.183979          1          9
-------------+---------------------------------------------------------
       cas40 |      1,419    8.396758    2.113097          1          9
       cas41 |      1,419    8.351656    2.183979          1          9
       cas42 |      1,419    8.346018    2.192612          1          9
       cas43 |      1,419    8.300916    2.259989          1          9
       cas44 |      1,419    8.317829    2.235068          1          9
-------------+---------------------------------------------------------
       cas45 |      1,419    8.368569    2.157782          1          9
       cas46 |      1,419    8.379845    2.140064          1          9
       cas47 |      1,419    8.424947    2.067063          1          9
       cas48 |      1,419    8.464412    2.000168          1          9
       cas49 |      1,419    8.464412    2.000168          1          9
-------------+---------------------------------------------------------
       cas50 |      1,419    8.470049    1.990364          1          9
       cas51 |      1,419    8.509514    1.919873          1          9
       cas52 |      1,419    8.571529    1.801795          1          9
       cas53 |      1,419     8.59408    1.756349          1          9
       cas54 |      1,419    8.616631    1.709396          1          9
-------------+---------------------------------------------------------
       cas55 |      1,419    8.639183    1.660811          1          9
       cas56 |      1,419    8.684285    1.558126          1          9
       cas57 |      1,419     8.69556    1.531172          1          9
       cas58 |      1,419    8.740662    1.417343          1          9
       cas59 |      1,419    8.774489    1.324564          1          9
-------------+---------------------------------------------------------
       cas60 |      1,419    8.785765    1.291961          1          9
       cas61 |      1,419    8.774489    1.324564          1          9
       cas62 |      1,419    8.791402    1.275309          1          9
       cas63 |      1,419    8.836505    1.132315          1          9
       cas64 |      1,419    8.904158    .8706811          1          9
-------------+---------------------------------------------------------
       cas65 |      1,419    8.926709    .7624739          1          9
       cas66 |      1,419    8.937984    .7018727          1          9
       cas67 |      1,419    8.971811    .4742096          1          9
       cas68 |      1,419           9           0          9          9
      full15 |      1,419    8.656096    1.623213          1          9
-------------+---------------------------------------------------------
      full16 |      1,419    8.565891    1.812935          1          9
      full17 |      1,419    8.475687    1.980496          1          9
      full18 |      1,419    7.472163    3.145692          1          9
      full19 |      1,419    5.634249    3.950788          1          9
      full20 |      1,419    5.256519    3.993174          1          9
-------------+---------------------------------------------------------
      full21 |      1,419    4.557435    3.976843          1          9
      full22 |      1,419    4.326286    3.944246          1          9
      full23 |      1,419     3.93728    3.857605          1          9
      full24 |      1,419    4.174066     3.91518          1          9
      full25 |      1,419    4.461593    3.964996          1          9
-------------+---------------------------------------------------------
      full26 |      1,419     4.82241    3.997465          1          9
      full27 |      1,419     5.07611    4.000686          1          9
      full28 |      1,419    5.301621    3.990018          1          9
      full29 |      1,419    5.420014     3.97929          1          9
      full30 |      1,419    5.566596    3.961064          1          9
-------------+---------------------------------------------------------
      full31 |      1,419    5.735729    3.933142          1          9
      full32 |      1,419    5.848485    3.910352          1          9
      full33 |      1,419    5.899225    3.898988          1          9
      full34 |      1,419    6.034531    3.865265          1          9
      full35 |      1,419    6.119098    3.841617          1          9
-------------+---------------------------------------------------------
      full36 |      1,419    6.271318    3.793929          1          9
      full37 |      1,419    6.400987    3.747951          1          9
      full38 |      1,419    6.451727    3.728577          1          9
      full39 |      1,419    6.592671    3.670544          1          9
      full40 |      1,419    6.564482    3.682656          1          9
-------------+---------------------------------------------------------
      full41 |      1,419    6.598309    3.668091          1          9
      full42 |      1,419    6.682875    3.630044          1          9
      full43 |      1,419    6.789993      3.5784          1          9
      full44 |      1,419     6.82382    3.561267          1          9
      full45 |      1,419    6.919662    3.510496          1          9
-------------+---------------------------------------------------------
      full46 |      1,419    7.071882      3.4228          1          9
      full47 |      1,419    7.122622    3.391546          1          9
      full48 |      1,419    7.145173    3.377317          1          9
      full49 |      1,419    7.280479    3.287405          1          9
      full50 |      1,419    7.376321    3.218757          1          9
-------------+---------------------------------------------------------
      full51 |      1,419    7.483439    3.136792          1          9
      full52 |      1,419    7.573643    3.063164          1          9
      full53 |      1,419    7.680761    2.969804          1          9
      full54 |      1,419    7.765328    2.891168          1          9
      full55 |      1,419    7.883721    2.773008          1          9
-------------+---------------------------------------------------------
      full56 |      1,419     7.96265    2.688457          1          9
      full57 |      1,419     8.06413    2.572114          1          9
      full58 |      1,419    8.182523    2.423982          1          9
      full59 |      1,419    8.261452    2.316617          1          9
      full60 |      1,419    8.481325    1.970562          1          9
-------------+---------------------------------------------------------
      full61 |      1,419    8.723749    1.461231          1          9
      full62 |      1,419    8.757576    1.371842          1          9
      full63 |      1,419    8.802678     1.24126          1          9
      full64 |      1,419    8.859056    1.052839          1          9
      full65 |      1,419    8.892882    .9198171          1          9
-------------+---------------------------------------------------------
      full66 |      1,419    8.932347    .7328217          1          9
      full67 |      1,419    8.954898    .5991964          1          9
      full68 |      1,419    8.971811    .4742096          1          9
      self15 |      1,419    8.971811    .4742096          1          9
      self16 |      1,419    8.960536    .5606955          1          9
-------------+---------------------------------------------------------
      self17 |      1,419    8.943622     .669447          1          9
      self18 |      1,419    8.881607    .9663265          1          9
      self19 |      1,419    8.853418    1.073304          1          9
      self20 |      1,419    8.825229    1.169866          1          9
      self21 |      1,419    8.791402    1.275309          1          9
-------------+---------------------------------------------------------
      self22 |      1,419      8.7463    1.402363          1          9
      self23 |      1,419    8.627907    1.685317          1          9
      self24 |      1,419    8.577167    1.790568          1          9
      self25 |      1,419    8.515152    1.909523          1          9
      self26 |      1,419    8.486963    1.960561          1          9
-------------+---------------------------------------------------------
      self27 |      1,419     8.44186    2.038756          1          9
      self28 |      1,419    8.436223    2.048251          1          9
      self29 |      1,419    8.424947    2.067063          1          9
      self30 |      1,419    8.402396    2.104001          1          9
      self31 |      1,419    8.334743    2.209736          1          9
-------------+---------------------------------------------------------
      self32 |      1,419    8.334743    2.209736          1          9
      self33 |      1,419    8.340381    2.201198          1          9
      self34 |      1,419    8.329105    2.218226          1          9
      self35 |      1,419    8.323467     2.22667          1          9
      self36 |      1,419    8.312192     2.24342          1          9
-------------+---------------------------------------------------------
      self37 |      1,419    8.317829    2.235068          1          9
      self38 |      1,419    8.334743    2.209736          1          9
      self39 |      1,419    8.340381    2.201198          1          9
      self40 |      1,419    8.346018    2.192612          1          9
      self41 |      1,419    8.351656    2.183979          1          9
-------------+---------------------------------------------------------
      self42 |      1,419    8.362932    2.166564          1          9
      self43 |      1,419    8.391121    2.122139          1          9
      self44 |      1,419    8.430585    2.057686          1          9
      self45 |      1,419    8.458774    2.009908          1          9
      self46 |      1,419      8.4926    1.950493          1          9
-------------+---------------------------------------------------------
      self47 |      1,419    8.503876     1.93015          1          9
      self48 |      1,419    8.509514    1.919873          1          9
      self49 |      1,419    8.515152    1.909523          1          9
      self50 |      1,419    8.537703    1.867383          1          9
      self51 |      1,419     8.54334    1.856655          1          9
-------------+---------------------------------------------------------
      self52 |      1,419    8.577167    1.790568          1          9
      self53 |      1,419     8.59408    1.756349          1          9
      self54 |      1,419    8.610994    1.721282          1          9
      self55 |      1,419    8.639183    1.660811          1          9
      self56 |      1,419    8.673009    1.584542          1          9
-------------+---------------------------------------------------------
      self57 |      1,419    8.706836    1.503649          1          9
      self58 |      1,419    8.735025    1.432144          1          9
      self59 |      1,419    8.774489    1.324564          1          9
      self60 |      1,419    8.813953    1.206144          1          9
      self61 |      1,419    8.853418    1.073304          1          9
-------------+---------------------------------------------------------
      self62 |      1,419    8.859056    1.052839          1          9
      self63 |      1,419    8.875969    .9887129          1          9
      self64 |      1,419    8.904158    .8706811          1          9
      self65 |      1,419    8.926709    .7624739          1          9
      self66 |      1,419     8.94926    .6353185          1          9
-------------+---------------------------------------------------------
      self67 |      1,419     8.94926    .6353185          1          9
      self68 |      1,419    8.966173    .5192869          1          9
      side15 |      1,419    8.994362    .2123727          1          9
      side16 |      1,419    8.994362    .2123727          1          9
      side17 |      1,419    8.994362    .2123727          1          9
-------------+---------------------------------------------------------
      side18 |      1,419    8.988724    .3002345          1          9
      side19 |      1,419    8.988724    .3002345          1          9
      side20 |      1,419    8.994362    .2123727          1          9
      side21 |      1,419    8.977449     .424296          1          9
      side22 |      1,419    8.971811    .4742096          1          9
-------------+---------------------------------------------------------
      side23 |      1,419    8.966173    .5192869          1          9
      side24 |      1,419    8.960536    .5606955          1          9
      side25 |      1,419    8.943622     .669447          1          9
      side26 |      1,419    8.921071    .7909752          1          9
      side27 |      1,419    8.881607    .9663265          1          9
-------------+---------------------------------------------------------
      side28 |      1,419    8.864693    1.031938          1          9
      side29 |      1,419    8.859056    1.052839          1          9
      side30 |      1,419    8.859056    1.052839          1          9
      side31 |      1,419    8.853418    1.073304          1          9
      side32 |      1,419     8.84778    1.093357          1          9
-------------+---------------------------------------------------------
      side33 |      1,419    8.853418    1.073304          1          9
      side34 |      1,419    8.864693    1.031938          1          9
      side35 |      1,419    8.853418    1.073304          1          9
      side36 |      1,419    8.859056    1.052839          1          9
      side37 |      1,419    8.864693    1.031938          1          9
-------------+---------------------------------------------------------
      side38 |      1,419    8.859056    1.052839          1          9
      side39 |      1,419    8.853418    1.073304          1          9
      side40 |      1,419    8.859056    1.052839          1          9
      side41 |      1,419    8.887245    .9433754          1          9
      side42 |      1,419     8.89852    .8956039          1          9
-------------+---------------------------------------------------------
      side43 |      1,419    8.904158    .8706811          1          9
      side44 |      1,419    8.921071    .7909752          1          9
      side45 |      1,419    8.915433    .8184457          1          9
      side46 |      1,419    8.904158    .8706811          1          9
      side47 |      1,419    8.915433    .8184457          1          9
-------------+---------------------------------------------------------
      side48 |      1,419    8.926709    .7624739          1          9
      side49 |      1,419    8.943622     .669447          1          9
      side50 |      1,419     8.94926    .6353185          1          9
      side51 |      1,419    8.960536    .5606955          1          9
      side52 |      1,419    8.966173    .5192869          1          9
-------------+---------------------------------------------------------
      side53 |      1,419    8.971811    .4742096          1          9
      side54 |      1,419    8.971811    .4742096          1          9
      side55 |      1,419    8.971811    .4742096          1          9
      side56 |      1,419    8.971811    .4742096          1          9
      side57 |      1,419    8.971811    .4742096          1          9
-------------+---------------------------------------------------------
      side58 |      1,419    8.971811    .4742096          1          9
      side59 |      1,419    8.977449     .424296          1          9
      side60 |      1,419    8.983087    .3675809          1          9
      side61 |      1,419    8.983087    .3675809          1          9
      side62 |      1,419    8.983087    .3675809          1          9
-------------+---------------------------------------------------------
      side63 |      1,419    8.983087    .3675809          1          9
      side64 |      1,419    8.983087    .3675809          1          9
      side65 |      1,419    8.988724    .3002345          1          9
      side66 |      1,419    8.994362    .2123727          1          9
      side67 |      1,419           9           0          9          9
-------------+---------------------------------------------------------
      side68 |      1,419           9           0          9          9
       fmw15 |      1,419    8.966173    .5192869          1          9
       fmw16 |      1,419    8.960536    .5606955          1          9
       fmw17 |      1,419    8.954898    .5991964          1          9
       fmw18 |      1,419    8.932347    .7328217          1          9
-------------+---------------------------------------------------------
       fmw19 |      1,419    8.870331    1.010572          1          9
       fmw20 |      1,419    8.853418    1.073304          1          9
       fmw21 |      1,419    8.802678     1.24126          1          9
       fmw22 |      1,419    8.735025    1.432144          1          9
       fmw23 |      1,419    8.684285    1.558126          1          9
-------------+---------------------------------------------------------
       fmw24 |      1,419     8.64482    1.648393          1          9
       fmw25 |      1,419    8.656096    1.623213          1          9
       fmw26 |      1,419    8.616631    1.709396          1          9
       fmw27 |      1,419     8.59408    1.756349          1          9
       fmw28 |      1,419    8.622269    1.697409          1          9
-------------+---------------------------------------------------------
       fmw29 |      1,419    8.605356    1.733068          1          9
       fmw30 |      1,419     8.59408    1.756349          1          9
       fmw31 |      1,419     8.59408    1.756349          1          9
       fmw32 |      1,419     8.59408    1.756349          1          9
       fmw33 |      1,419    8.582805    1.779253          1          9
-------------+---------------------------------------------------------
       fmw34 |      1,419    8.582805    1.779253          1          9
       fmw35 |      1,419    8.622269    1.697409          1          9
       fmw36 |      1,419     8.64482    1.648393          1          9
       fmw37 |      1,419    8.661734    1.610445          1          9
       fmw38 |      1,419     8.69556    1.531172          1          9
-------------+---------------------------------------------------------
       fmw39 |      1,419     8.69556    1.531172          1          9
       fmw40 |      1,419    8.729387    1.446772          1          9
       fmw41 |      1,419    8.740662    1.417343          1          9
       fmw42 |      1,419    8.751938    1.387198          1          9
       fmw43 |      1,419    8.768851    1.340532          1          9
-------------+---------------------------------------------------------
       fmw44 |      1,419    8.763214    1.356289          1          9
       fmw45 |      1,419    8.785765    1.291961          1          9
       fmw46 |      1,419    8.791402    1.275309          1          9
       fmw47 |      1,419     8.79704    1.258412          1          9
       fmw48 |      1,419    8.808316    1.223841          1          9
-------------+---------------------------------------------------------
       fmw49 |      1,419    8.819591    1.188157          1          9
       fmw50 |      1,419    8.830867    1.151257          1          9
       fmw51 |      1,419    8.813953    1.206144          1          9
       fmw52 |      1,419    8.819591    1.188157          1          9
       fmw53 |      1,419    8.819591    1.188157          1          9
-------------+---------------------------------------------------------
       fmw54 |      1,419    8.819591    1.188157          1          9
       fmw55 |      1,419    8.836505    1.132315          1          9
       fmw56 |      1,419     8.84778    1.093357          1          9
       fmw57 |      1,419    8.859056    1.052839          1          9
       fmw58 |      1,419    8.881607    .9663265          1          9
-------------+---------------------------------------------------------
       fmw59 |      1,419    8.892882    .9198171          1          9
       fmw60 |      1,419     8.89852    .8956039          1          9
       fmw61 |      1,419    8.915433    .8184457          1          9
       fmw62 |      1,419    8.937984    .7018727          1          9
       fmw63 |      1,419    8.943622     .669447          1          9
-------------+---------------------------------------------------------
       fmw64 |      1,419    8.937984    .7018727          1          9
       fmw65 |      1,419     8.94926    .6353185          1          9
       fmw66 |      1,419    8.954898    .5991964          1          9
       fmw67 |      1,419    8.971811    .4742096          1          9
       fmw68 |      1,419    8.983087    .3675809          1          9

. 
end of do-file
 replace id of principle 
(1,419 real changes made)
 make household head dummy  
(1,419 missing values generated)
(656 real changes made)
(763 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
         9 |         0          . |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .47746884  .42021277 | .46229739
(1,419 missing values generated)
(1,419 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      1,419       25710    409.7743      25001      26419
          pri[1419,298]
 ** Rename variables of renameListSpo 
 rename variable of experience 

. *******************************************************
. *Title: Renamevar_Exp
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables of working experience
. * 
. * 1. rename vars. of experience
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. * set list of variables
. ** of principal
. local casPri $CasPri

. local fullPri $FullPri

. local selfPri $SelfPri

. local sidePri $SidePri

. local fmwPri $FmwPri

. ** of spouse
. local casSpo $CasSpo

. local fullSpo $FullSpo

. local selfSpo $SelfSpo

. local sideSpo $SideSpo

. local fmwSpo $FmwSpo

. 
. * 1. rename vars. of experience
. local empStatus cas full self side fmw

. local num_m: word count `empStatus'

. local resp_i $Resp_i

. local age_t $Age_t

. 
. if `resp_i'==1{
.         local expVar casPri fullPri selfPri sidePri fmwPri
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. else {
.         local expVar casSpo fullSpo selfSpo sideSpo fmwSpo
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. sum $ExpList

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       cas15 |      1,419    8.689922    .7280235          1          9
       cas16 |      1,419    8.678647    .7830463          1          9
       cas17 |      1,419    8.667371    .8342963          1          9
       cas18 |      1,419    8.605356    1.071163          1          9
       cas19 |      1,419      8.4926    1.395811          1          9
-------------+---------------------------------------------------------
       cas20 |      1,419    8.413672    1.579169          1          9
       cas21 |      1,419    8.351656    1.706935          1          9
       cas22 |      1,419    8.396758    1.615254          1          9
       cas23 |      1,419    8.408034    1.591308          1          9
       cas24 |      1,419    8.413672    1.579169          1          9
-------------+---------------------------------------------------------
       cas25 |      1,419    8.374207     1.66188          1          9
       cas26 |      1,419    8.396758    1.615254          1          9
       cas27 |      1,419    8.402396    1.603336          1          9
       cas28 |      1,419    8.391121    1.627065          1          9
       cas29 |      1,419    8.385483    1.638771          1          9
-------------+---------------------------------------------------------
       cas30 |      1,419    8.368569    1.673286          1          9
       cas31 |      1,419    8.391121    1.627065          1          9
       cas32 |      1,419    8.413672    1.579169          1          9
       cas33 |      1,419    8.379845    1.650376          1          9
       cas34 |      1,419    8.334743    1.739769          1          9
-------------+---------------------------------------------------------
       cas35 |      1,419    8.306554    1.792802          1          9
       cas36 |      1,419    8.278365    1.843879          1          9
       cas37 |      1,419    8.306554    1.792802          1          9
       cas38 |      1,419    8.340381    1.728912          1          9
       cas39 |      1,419    8.340381    1.728912          1          9
-------------+---------------------------------------------------------
       cas40 |      1,419    8.306554    1.792802          1          9
       cas41 |      1,419    8.312192    1.782357          1          9
       cas42 |      1,419    8.312192    1.782357          1          9
       cas43 |      1,419    8.306554    1.792802          1          9
       cas44 |      1,419    8.329105    1.750541          1          9
-------------+---------------------------------------------------------
       cas45 |      1,419    8.340381    1.728912          1          9
       cas46 |      1,419    8.391121    1.627065          1          9
       cas47 |      1,419    8.402396    1.603336          1          9
       cas48 |      1,419    8.385483    1.638771          1          9
       cas49 |      1,419    8.374207     1.66188          1          9
-------------+---------------------------------------------------------
       cas50 |      1,419    8.419309    1.566916          1          9
       cas51 |      1,419    8.453136    1.490836          1          9
       cas52 |      1,419    8.515152    1.337963          1          9
       cas53 |      1,419    8.532065    1.292621          1          9
       cas54 |      1,419    8.565891    1.196076          1          9
-------------+---------------------------------------------------------
       cas55 |      1,419    8.571529    1.179123          1          9
       cas56 |      1,419    8.588443    1.126564          1          9
       cas57 |      1,419    8.588443    1.126564          1          9
       cas58 |      1,419    8.599718    1.089972          1          9
       cas59 |      1,419     8.59408    1.108434          1          9
-------------+---------------------------------------------------------
       cas60 |      1,419    8.599718    1.089972          1          9
       cas61 |      1,419    8.599718    1.089972          1          9
       cas62 |      1,419    8.633545    .9711796          1          9
       cas63 |      1,419    8.622269    1.012453          1          9
       cas64 |      1,419    8.639183    .9498205          1          9
-------------+---------------------------------------------------------
       cas65 |      1,419     8.64482    .9279356          1          9
       cas66 |      1,419    8.656096    .8824311          1          9
       cas67 |      1,419    8.673009    .8090968          1          9
       cas68 |      1,419    8.684285    .7560567          1          9
      full15 |      1,419    8.481325     1.42372          1          9
-------------+---------------------------------------------------------
      full16 |      1,419    8.402396    1.603336          1          9
      full17 |      1,419    8.329105    1.750541          1          9
      full18 |      1,419    7.624383    2.694977          1          9
      full19 |      1,419    6.282593    3.536798          1          9
      full20 |      1,419    6.130374    3.588384          1          9
-------------+---------------------------------------------------------
      full21 |      1,419    5.470754    3.732745          1          9
      full22 |      1,419     5.17759    3.758136          1          9
      full23 |      1,419    4.743481    3.753572          1          9
      full24 |      1,419    4.737844    3.753182          1          9
      full25 |      1,419    4.878788    3.760378          1          9
-------------+---------------------------------------------------------
      full26 |      1,419    5.093023    3.761182          1          9
      full27 |      1,419    5.256519    3.753572          1          9
      full28 |      1,419    5.346723    3.746311          1          9
      full29 |      1,419    5.504581     3.72832          1          9
      full30 |      1,419    5.600423    3.714079          1          9
-------------+---------------------------------------------------------
      full31 |      1,419    5.696265    3.697299          1          9
      full32 |      1,419    5.814658    3.673011          1          9
      full33 |      1,419    5.842847    3.666641          1          9
      full34 |      1,419    5.882311    3.657339          1          9
      full35 |      1,419    6.000705    3.626711          1          9
-------------+---------------------------------------------------------
      full36 |      1,419    6.073996    3.605672          1          9
      full37 |      1,419    6.152925    3.581198          1          9
      full38 |      1,419    6.192389    3.568242          1          9
      full39 |      1,419    6.248767    3.548891          1          9
      full40 |      1,419    6.350247    3.511509          1          9
-------------+---------------------------------------------------------
      full41 |      1,419    6.406624    3.489292          1          9
      full42 |      1,419    6.508104    3.446617          1          9
      full43 |      1,419    6.615222      3.3977          1          9
      full44 |      1,419      6.6716    3.370301          1          9
      full45 |      1,419    6.744891     3.33292          1          9
-------------+---------------------------------------------------------
      full46 |      1,419    6.846371    3.277752          1          9
      full47 |      1,419    6.947851    3.218439          1          9
      full48 |      1,419    7.009866    3.180053          1          9
      full49 |      1,419    7.094433    3.124965          1          9
      full50 |      1,419    7.128259     3.10201          1          9
-------------+---------------------------------------------------------
      full51 |      1,419    7.190275    3.058506          1          9
      full52 |      1,419    7.274841    2.996097          1          9
      full53 |      1,419    7.398872    2.897672          1          9
      full54 |      1,419    7.449612    2.854876          1          9
      full55 |      1,419    7.562368     2.75405          1          9
-------------+---------------------------------------------------------
      full56 |      1,419     7.65821    2.661594          1          9
      full57 |      1,419    7.765328    2.550043          1          9
      full58 |      1,419    7.816068    2.493856          1          9
      full59 |      1,419     7.91191    2.381166          1          9
      full60 |      1,419    8.052854    2.197421          1          9
-------------+---------------------------------------------------------
      full61 |      1,419    8.368569    1.673286          1          9
      full62 |      1,419    8.436223    1.529443          1          9
      full63 |      1,419    8.503876    1.367239          1          9
      full64 |      1,419    8.565891    1.196076          1          9
      full65 |      1,419    8.616631    1.032425          1          9
-------------+---------------------------------------------------------
      full66 |      1,419    8.656096    .8824311          1          9
      full67 |      1,419    8.678647    .7830463          1          9
      full68 |      1,419    8.684285    .7560567          1          9
      self15 |      1,419    8.706836    .6362596          1          9
      self16 |      1,419    8.701198    .6682968          1          9
-------------+---------------------------------------------------------
      self17 |      1,419    8.689922    .7280235          1          9
      self18 |      1,419    8.667371    .8342963          1          9
      self19 |      1,419    8.627907     .992047          1          9
      self20 |      1,419    8.616631    1.032425          1          9
      self21 |      1,419    8.565891    1.196076          1          9
-------------+---------------------------------------------------------
      self22 |      1,419     8.54334    1.261362          1          9
      self23 |      1,419    8.498238     1.38161          1          9
      self24 |      1,419      8.4926    1.395811          1          9
      self25 |      1,419    8.447498    1.503836          1          9
      self26 |      1,419    8.447498    1.503836          1          9
-------------+---------------------------------------------------------
      self27 |      1,419    8.402396    1.603336          1          9
      self28 |      1,419    8.385483    1.638771          1          9
      self29 |      1,419    8.374207     1.66188          1          9
      self30 |      1,419    8.346018    1.717968          1          9
      self31 |      1,419    8.340381    1.728912          1          9
-------------+---------------------------------------------------------
      self32 |      1,419    8.317829    1.771833          1          9
      self33 |      1,419    8.312192    1.782357          1          9
      self34 |      1,419    8.300916    1.803169          1          9
      self35 |      1,419    8.272727    1.853875          1          9
      self36 |      1,419    8.261452    1.873654          1          9
-------------+---------------------------------------------------------
      self37 |      1,419    8.255814     1.88344          1          9
      self38 |      1,419    8.238901      1.9124          1          9
      self39 |      1,419    8.250176     1.89316          1          9
      self40 |      1,419    8.261452    1.873654          1          9
      self41 |      1,419    8.238901      1.9124          1          9
-------------+---------------------------------------------------------
      self42 |      1,419    8.244538    1.902812          1          9
      self43 |      1,419    8.255814     1.88344          1          9
      self44 |      1,419    8.267089    1.863799          1          9
      self45 |      1,419    8.295278    1.813458          1          9
      self46 |      1,419    8.312192    1.782357          1          9
-------------+---------------------------------------------------------
      self47 |      1,419    8.323467    1.761228          1          9
      self48 |      1,419    8.340381    1.728912          1          9
      self49 |      1,419    8.357294    1.695812          1          9
      self50 |      1,419    8.385483    1.638771          1          9
      self51 |      1,419    8.391121    1.627065          1          9
-------------+---------------------------------------------------------
      self52 |      1,419    8.385483    1.638771          1          9
      self53 |      1,419    8.396758    1.615254          1          9
      self54 |      1,419    8.419309    1.566916          1          9
      self55 |      1,419    8.424947    1.554546          1          9
      self56 |      1,419    8.458774    1.477699          1          9
-------------+---------------------------------------------------------
      self57 |      1,419    8.475687    1.437438          1          9
      self58 |      1,419    8.503876    1.367239          1          9
      self59 |      1,419    8.526427    1.307934          1          9
      self60 |      1,419    8.565891    1.196076          1          9
      self61 |      1,419    8.577167    1.161895          1          9
-------------+---------------------------------------------------------
      self62 |      1,419    8.588443    1.126564          1          9
      self63 |      1,419    8.610994    1.051987          1          9
      self64 |      1,419    8.639183    .9498205          1          9
      self65 |      1,419    8.656096    .8824311          1          9
      self66 |      1,419    8.667371    .8342963          1          9
-------------+---------------------------------------------------------
      self67 |      1,419    8.673009    .8090968          1          9
      self68 |      1,419    8.673009    .8090968          1          9
      side15 |      1,419    8.735025    .4414757          8          9
      side16 |      1,419    8.735025    .4414757          8          9
      side17 |      1,419    8.735025    .4414757          8          9
-------------+---------------------------------------------------------
      side18 |      1,419    8.735025    .4414757          8          9
      side19 |      1,419    8.735025    .4414757          8          9
      side20 |      1,419    8.735025    .4414757          8          9
      side21 |      1,419    8.735025    .4414757          8          9
      side22 |      1,419    8.729387    .4868399          1          9
-------------+---------------------------------------------------------
      side23 |      1,419    8.718111      .56661          1          9
      side24 |      1,419    8.718111      .56661          1          9
      side25 |      1,419    8.706836    .6362596          1          9
      side26 |      1,419     8.69556    .6988213          1          9
      side27 |      1,419     8.69556    .6988213          1          9
-------------+---------------------------------------------------------
      side28 |      1,419    8.684285    .7560567          1          9
      side29 |      1,419    8.678647    .7830463          1          9
      side30 |      1,419    8.678647    .7830463          1          9
      side31 |      1,419    8.661734    .8587195          1          9
      side32 |      1,419    8.656096    .8824311          1          9
-------------+---------------------------------------------------------
      side33 |      1,419    8.656096    .8824311          1          9
      side34 |      1,419    8.650458    .9054868          1          9
      side35 |      1,419    8.673009    .8090968          1          9
      side36 |      1,419    8.678647    .7830463          1          9
      side37 |      1,419    8.661734    .8587195          1          9
-------------+---------------------------------------------------------
      side38 |      1,419    8.673009    .8090968          1          9
      side39 |      1,419    8.678647    .7830463          1          9
      side40 |      1,419    8.689922    .7280235          1          9
      side41 |      1,419    8.684285    .7560567          1          9
      side42 |      1,419    8.684285    .7560567          1          9
-------------+---------------------------------------------------------
      side43 |      1,419     8.69556    .6988213          1          9
      side44 |      1,419    8.701198    .6682968          1          9
      side45 |      1,419    8.706836    .6362596          1          9
      side46 |      1,419    8.706836    .6362596          1          9
      side47 |      1,419    8.718111      .56661          1          9
-------------+---------------------------------------------------------
      side48 |      1,419    8.723749     .528263          1          9
      side49 |      1,419    8.723749     .528263          1          9
      side50 |      1,419    8.723749     .528263          1          9
      side51 |      1,419    8.723749     .528263          1          9
      side52 |      1,419    8.723749     .528263          1          9
-------------+---------------------------------------------------------
      side53 |      1,419    8.723749     .528263          1          9
      side54 |      1,419    8.723749     .528263          1          9
      side55 |      1,419    8.718111      .56661          1          9
      side56 |      1,419    8.723749     .528263          1          9
      side57 |      1,419    8.729387    .4868399          1          9
-------------+---------------------------------------------------------
      side58 |      1,419    8.735025    .4414757          8          9
      side59 |      1,419    8.735025    .4414757          8          9
      side60 |      1,419    8.735025    .4414757          8          9
      side61 |      1,419    8.735025    .4414757          8          9
      side62 |      1,419    8.735025    .4414757          8          9
-------------+---------------------------------------------------------
      side63 |      1,419    8.735025    .4414757          8          9
      side64 |      1,419    8.735025    .4414757          8          9
      side65 |      1,419    8.735025    .4414757          8          9
      side66 |      1,419    8.735025    .4414757          8          9
      side67 |      1,419    8.735025    .4414757          8          9
-------------+---------------------------------------------------------
      side68 |      1,419    8.735025    .4414757          8          9
       fmw15 |      1,419    8.701198    .6682968          1          9
       fmw16 |      1,419     8.69556    .6988213          1          9
       fmw17 |      1,419    8.689922    .7280235          1          9
       fmw18 |      1,419    8.656096    .8824311          1          9
-------------+---------------------------------------------------------
       fmw19 |      1,419     8.59408    1.108434          1          9
       fmw20 |      1,419    8.588443    1.126564          1          9
       fmw21 |      1,419    8.515152    1.337963          1          9
       fmw22 |      1,419    8.509514    1.352692          1          9
       fmw23 |      1,419    8.464412    1.464424          1          9
-------------+---------------------------------------------------------
       fmw24 |      1,419    8.413672    1.579169          1          9
       fmw25 |      1,419    8.385483    1.638771          1          9
       fmw26 |      1,419    8.374207     1.66188          1          9
       fmw27 |      1,419    8.368569    1.673286          1          9
       fmw28 |      1,419    8.362932    1.684596          1          9
-------------+---------------------------------------------------------
       fmw29 |      1,419    8.362932    1.684596          1          9
       fmw30 |      1,419    8.357294    1.695812          1          9
       fmw31 |      1,419    8.351656    1.706935          1          9
       fmw32 |      1,419    8.346018    1.717968          1          9
       fmw33 |      1,419    8.340381    1.728912          1          9
-------------+---------------------------------------------------------
       fmw34 |      1,419    8.385483    1.638771          1          9
       fmw35 |      1,419    8.396758    1.615254          1          9
       fmw36 |      1,419    8.396758    1.615254          1          9
       fmw37 |      1,419    8.413672    1.579169          1          9
       fmw38 |      1,419    8.413672    1.579169          1          9
-------------+---------------------------------------------------------
       fmw39 |      1,419    8.436223    1.529443          1          9
       fmw40 |      1,419    8.447498    1.503836          1          9
       fmw41 |      1,419    8.470049    1.451004          1          9
       fmw42 |      1,419    8.475687    1.437438          1          9
       fmw43 |      1,419    8.486963    1.409846          1          9
-------------+---------------------------------------------------------
       fmw44 |      1,419    8.503876    1.367239          1          9
       fmw45 |      1,419    8.509514    1.352692          1          9
       fmw46 |      1,419    8.526427    1.307934          1          9
       fmw47 |      1,419    8.526427    1.307934          1          9
       fmw48 |      1,419    8.532065    1.292621          1          9
-------------+---------------------------------------------------------
       fmw49 |      1,419     8.54334    1.261362          1          9
       fmw50 |      1,419    8.560254    1.212767          1          9
       fmw51 |      1,419    8.565891    1.196076          1          9
       fmw52 |      1,419    8.571529    1.179123          1          9
       fmw53 |      1,419    8.582805     1.14438          1          9
-------------+---------------------------------------------------------
       fmw54 |      1,419    8.582805     1.14438          1          9
       fmw55 |      1,419     8.59408    1.108434          1          9
       fmw56 |      1,419    8.599718    1.089972          1          9
       fmw57 |      1,419    8.616631    1.032425          1          9
       fmw58 |      1,419    8.616631    1.032425          1          9
-------------+---------------------------------------------------------
       fmw59 |      1,419    8.633545    .9711796          1          9
       fmw60 |      1,419     8.64482    .9279356          1          9
       fmw61 |      1,419    8.650458    .9054868          1          9
       fmw62 |      1,419    8.650458    .9054868          1          9
       fmw63 |      1,419    8.656096    .8824311          1          9
-------------+---------------------------------------------------------
       fmw64 |      1,419    8.661734    .8587195          1          9
       fmw65 |      1,419    8.684285    .7560567          1          9
       fmw66 |      1,419     8.69556    .6988213          1          9
       fmw67 |      1,419    8.718111      .56661          1          9
       fmw68 |      1,419    8.723749     .528263          1          9

. 
end of do-file
 replace id of spouse and drop not married 
variable id was int now long
(1,419 real changes made)
(376 observations deleted)
  1,043
 make household head dummy  
(1,043 missing values generated)
(500 real changes made)
(543 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
         9 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .47938639 | .47938639
(1,043 missing values generated)
(1,043 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      1,043    35711.93    404.4233      35001      36419
          spo[1043,298]
          pri[1419,298]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[2462,298]
          spo[1043,298]
          pri[1419,298]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 2462
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 2,462

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPSnew2007.dta saved

. mat drop _all

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      1,214       49.31       49.31
          2 |      1,248       50.69      100.00
------------+-----------------------------------
      Total |      2,462      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      2,462        2007           0       2007       2007

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2007m1

. disp %tm r(max)
 2007m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 13 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 13 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      2,449    1959.079    13.05403       1929       1987

. gen bym=ym(byear, bmonth)
(16 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
1929m11

. disp %tm r(max)
 1987m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(16 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           20             20
 5%           25             20
10%           29             20       Obs               2,446
25%           37             20       Sum of Wgt.       2,446

50%           47                      Mean            47.0045
                        Largest       Std. Dev.      13.04858
75%           58             75
90%           64             75       Variance       170.2654
95%           67             75       Skewness      -.1268322
99%           70             77       Kurtosis       2.074244

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
 recode missing value (9) to 0 for each employment status 
.         qui forvalues status_j = 1/`num_m'{
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
.         qui forvalues x=`age_t'/65{
.         sum we*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        we15 |      2,462    .0597076    .2369924          0          1
        we16 |      2,462    .0787977    .2694775          0          1
        we17 |      2,462    .0954509    .2938964          0          1
        we18 |      2,462    .2412673     .427939          0          1
        we19 |      2,462    .5060926    .5000644          0          1
-------------+---------------------------------------------------------
        we20 |      2,462    .5544273    .4971298          0          1
        we21 |      2,462    .6746548    .4685989          0          1
        we22 |      2,462    .7168968    .4505976          0          1
        we23 |      2,462    .7981316     .401476          0          1
        we24 |      2,462     .792039    .4059312          0          1
-------------+---------------------------------------------------------
        we25 |      2,462    .7761982    .4168754          0          1
        we26 |      2,462    .7441105    .4364487          0          1
        we27 |      2,462    .7217709    .4482179          0          1
        we28 |      2,462    .7002437    .4582442          0          1
        we29 |      2,462    .6819659    .4658074          0          1
-------------+---------------------------------------------------------
        we30 |      2,462    .6701868    .4702406          0          1
        we31 |      2,462    .6571893    .4747453          0          1
        we32 |      2,462    .6445979    .4787322          0          1
        we33 |      2,462    .6397238     .480178          0          1
        we34 |      2,462    .6283509    .4833435          0          1
-------------+---------------------------------------------------------
        we35 |      2,462    .6202275    .4854287          0          1
        we36 |      2,462    .6064175    .4886433          0          1
        we37 |      2,462    .5897644    .4919763          0          1
        we38 |      2,462    .5796101    .4937218          0          1
        we39 |      2,462    .5670187    .4955888          0          1
-------------+---------------------------------------------------------
        we40 |      2,462    .5540211    .4971741          0          1
        we41 |      2,462      .54671    .4979145          0          1
        we42 |      2,462    .5316816    .4990966          0          1
        we43 |      2,462    .5121852     .499953          0          1
        we44 |      2,462    .4959383    .5000851          0          1
-------------+---------------------------------------------------------
        we45 |      2,462    .4748172    .4994669          0          1
        we46 |      2,462    .4484159     .497433          0          1
        we47 |      2,462    .4301381    .4951958          0          1
        we48 |      2,462    .4179529    .4933225          0          1
        we49 |      2,462    .3980504    .4895954          0          1
-------------+---------------------------------------------------------
        we50 |      2,462    .3797725    .4854287          0          1
        we51 |      2,462    .3610885    .4804137          0          1
        we52 |      2,462    .3354996    .4722607          0          1
        we53 |      2,462      .31316    .4638731          0          1
        we54 |      2,462    .2977254     .457351          0          1
-------------+---------------------------------------------------------
        we55 |      2,462    .2749797    .4465948          0          1
        we56 |      2,462    .2506093    .4334519          0          1
        we57 |      2,462    .2286759    .4200653          0          1
        we58 |      2,462    .2063363    .4047569          0          1
        we59 |      2,462    .1844029    .3878912          0          1
-------------+---------------------------------------------------------
        we60 |      2,462    .1506905    .3578196          0          1
        we61 |      2,462    .1064175    .3084339          0          1
        we62 |      2,462    .0922015    .2893689          0          1
        we63 |      2,462    .0796101    .2707436          0          1
        we64 |      2,462    .0605199     .238496          0          1
-------------+---------------------------------------------------------
        we65 |      2,462    .0471162    .2119304          0          1
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de

                           workexp
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            2              0
10%            5              0       Obs               2,462
25%           11              0       Sum of Wgt.       2,462

50%           21                      Mean           22.52356
                        Largest       Std. Dev.      13.76529
75%           34             51
90%           42             51       Variance       189.4832
95%           46             51       Skewness       .2105237
99%           50             51       Kurtosis       1.934104
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
.         sum workexp
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
empsinceyear: 623 missing values generated
empsinceyear: 120 missing values generated
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
empsincemo~h: 623 missing values generated
empsincemo~h: 120 missing values generated
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
(801 missing values generated)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
1932m10
.         disp %tm r(max)
 2007m3
.         
.         gen emptenure=(svyym-empym)
(801 missing values generated)
.         label var emptenure "Tenure months" 
.         sum emptenure, de

                        Tenure months
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0             -2
 5%            4             -2
10%           10             -1       Obs               1,661
25%           33             -1       Sum of Wgt.       1,661

50%          109                      Mean           162.9229
                        Largest       Std. Dev.      156.9247
75%          261            849
90%          405            860       Variance       24625.36
95%          453            861       Skewness       1.206071
99%          621            891       Kurtosis       4.395068
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
.         sum emptenure
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPSnew2007.dta saved

. 
. *}
. 
end of do-file
Current survey year: 2012

. /* Title: DataCleaning */
. /// Date: Oct 12th, 2018
> /// Written by Ayaka Nakamura
> /// This file creates data cleaned by year
> /// 1. Rename variable names
> /// 2. Generate main variables
> 
. clear all

. set more off

. set trace off

. pause off

. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. * Set survey year
. local SvyY $SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPSnew2012

. 
. *qui{
. 
. * Read original data files
. disp "`original'/`currentData'`SvyY'.csv"
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Original
> Data/KHPSnew2012.csv

. import delimited "`original'/`currentData'`SvyY'.csv", clear 
(1,875 vars, 1,012 obs)

. count
  1,012

. 
. 
. * 1. Rename variable names
. do "`path'\Code\Renamevar_`currentData'`SvyY'.do"

. *******************************************************
. * Title: Renamevar_KHPSnew2012
. * Date: Oct 6th, 2018
. * Written by Ayaka Nakamura
. * 
. * This file shows variables to be named in KHPSnew 2012
. ********************************************************
. set mat 11000

. 
. * set list of variables
. ** list of variable name to be changed
. *** common variable with other years
. local varList ///
>                                 id marital sex byear bmonth ///
>                                 head earnif earnmost ///
>                                 edbg workstatus ///
>                                 occ owner ind size employed regular ///
>                                 empsinceyear empsincemonth union ///
>                                 paymethod monthlypaid dailypaid hourlypaid year
> lypaid bonus ///
>                                 workdaypermonth workhourperweek overworkperweek

. *** variables of working experience
. global ExpList ///
>                                 cas* full* self* side* fmw*     

. disp "`varList'" "$ExpList"
id marital sex byear bmonth                                 head earnif earnmost 
>                                 edbg workstatus                                
>  occ owner ind size employed regular                                 empsinceye
> ar empsincemonth union                                 paymethod monthlypaid da
> ilypaid hourlypaid yearlypaid bonus                                 workdayperm
> onth workhourperweek overworkperweekcas* full* self* side* fmw*

. 
. ** variable number of principal
. *** common variable with other years
. local renameListPri ///
>                                 v1 v4 v5 v6 v7 ///
>                                 v85 v86 v87 ///
>                                 v150 v171 ///
>                                 v218 v219 v220 v221 v224 v225 ///
>                                 v233 v234 v235 ///
>                                 v239 v240 v241 v242 v243 v244 ///
>                                 v249 v250 v251

. *** variables of working experience
. global CasPri v427-v480

. global FullPri v481-v534

. global SelfPri v535-v588

. global SidePri v589-v642

. global FmwPri v643-v696

. sum `renameListPri' $CasPri $FullPri $SelfPri $SidePri $FmwPri

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      1,012      7506.5    292.2835       7001       8012
          v4 |      1,012      1.3083    .4620197          1          2
          v5 |      1,012    1.497036    .5002384          1          2
          v6 |      1,012    1966.252    14.07774       1942       1992
          v7 |      1,012    6.414032    3.541686          1         12
-------------+---------------------------------------------------------
         v85 |      1,012    3.065217    11.79556          1         99
         v86 |      1,012    2.073123    1.196181          1          9
         v87 |      1,012    77.33992    28.35488          1         99
        v150 |      1,012    3.072134    1.393689          1          9
        v171 |      1,012    2.486166    2.062526          1          6
-------------+---------------------------------------------------------
        v218 |      1,012    27.20751    35.74224          1         99
        v219 |      1,012    3.589921    2.745524          1          9
        v220 |      1,012    29.53557    34.44251          1         99
        v221 |      1,012    4.536561    2.484302          1          9
        v224 |      1,012    5.435771    1.816189          1          9
-------------+---------------------------------------------------------
        v225 |      1,012    4.755929    3.058079          1          9
        v233 |      1,012    3970.292    3161.973       1960       9999
        v234 |      1,012    29.87451    38.18629          1         99
        v235 |      1,012     3.87253    2.896595          1          9
        v239 |      1,012    3.589921    3.114183          1          9
-------------+---------------------------------------------------------
        v240 |      1,012    43791.84    44619.66         10      99999
        v241 |      1,012    863703.8    146698.4       2800     888888
        v242 |      1,012    783705.7    287273.4        650     999999
        v243 |      1,012    86445.87    14484.83         10      88888
        v244 |      1,012    28115.99    42139.46          0      99999
-------------+---------------------------------------------------------
        v249 |      1,012    39.62549    31.07362          3         99
        v250 |      1,012    301.8913    399.2814          1        999
        v251 |      1,012    464.2184    471.3215          0        999
        v427 |      1,012    8.944664    .6633706          1          9
        v428 |      1,012    8.873518    .9984212          1          9
-------------+---------------------------------------------------------
        v429 |      1,012    8.770751    1.335365          1          9
        v430 |      1,012      8.6917    1.540682          1          9
        v431 |      1,012    8.478261    1.976249          1          9
        v432 |      1,012    8.375494     2.14723          1          9
        v433 |      1,012    8.233202    2.356246          1          9
-------------+---------------------------------------------------------
        v434 |      1,012    8.225296    2.367066          1          9
        v435 |      1,012    8.256917    2.323322          1          9
        v436 |      1,012    8.343874    2.196196          1          9
        v437 |      1,012    8.383399     2.13474          1          9
        v438 |      1,012    8.454545    2.017458          1          9
-------------+---------------------------------------------------------
        v439 |      1,012    8.486166    1.962257          1          9
        v440 |      1,012    8.541502    1.860426          1          9
        v441 |      1,012    8.525692    1.890246          1          9
        v442 |      1,012    8.581028    1.783082          1          9
        v443 |      1,012    8.557312    1.829983          1          9
-------------+---------------------------------------------------------
        v444 |      1,012    8.541502    1.860426          1          9
        v445 |      1,012    8.486166    1.962257          1          9
        v446 |      1,012     8.43083    2.057569          1          9
        v447 |      1,012    8.422925    2.070706          1          9
        v448 |      1,012    8.383399     2.13474          1          9
-------------+---------------------------------------------------------
        v449 |      1,012    8.375494     2.14723          1          9
        v450 |      1,012    8.383399     2.13474          1          9
        v451 |      1,012    8.343874    2.196196          1          9
        v452 |      1,012    8.359684    2.171908          1          9
        v453 |      1,012    8.335968    2.208197          1          9
-------------+---------------------------------------------------------
        v454 |      1,012    8.328063    2.220105          1          9
        v455 |      1,012    8.328063    2.220105          1          9
        v456 |      1,012    8.351779      2.1841          1          9
        v457 |      1,012    8.351779      2.1841          1          9
        v458 |      1,012    8.391304    2.122146          1          9
-------------+---------------------------------------------------------
        v459 |      1,012    8.391304    2.122146          1          9
        v460 |      1,012     8.41502     2.08373          1          9
        v461 |      1,012     8.44664    2.030947          1          9
        v462 |      1,012     8.43083    2.057569          1          9
        v463 |      1,012     8.44664    2.030947          1          9
-------------+---------------------------------------------------------
        v464 |      1,012    8.509881    1.919472          1          9
        v465 |      1,012    8.588933    1.767101          1          9
        v466 |      1,012    8.628458    1.684367          1          9
        v467 |      1,012    8.652174    1.632256          1          9
        v468 |      1,012      8.6917    1.540682          1          9
-------------+---------------------------------------------------------
        v469 |      1,012     8.72332    1.462532          1          9
        v470 |      1,012     8.73913    1.421584          1          9
        v471 |      1,012    8.762846    1.357502          1          9
        v472 |      1,012    8.778656    1.312806          1          9
        v473 |      1,012    8.762846    1.357502          1          9
-------------+---------------------------------------------------------
        v474 |      1,012    8.778656    1.312806          1          9
        v475 |      1,012    8.841897    1.114025          1          9
        v476 |      1,012    8.865613    1.028632          1          9
        v477 |      1,012    8.913043    .8299225          1          9
        v478 |      1,012    8.952569    .6144673          1          9
-------------+---------------------------------------------------------
        v479 |      1,012    8.960474     .561208          1          9
        v480 |      1,012    8.976285    .4351414          1          9
        v481 |      1,012    8.802372    1.242375          1          9
        v482 |      1,012    8.699605    1.521582          1          9
        v483 |      1,012    8.596838    1.750939          1          9
-------------+---------------------------------------------------------
        v484 |      1,012    7.648221    2.999302          1          9
        v485 |      1,012    6.130435    3.838838          1          9
        v486 |      1,012    5.782609    3.924633          1          9
        v487 |      1,012    4.944664    4.001595          1          9
        v488 |      1,012    4.573123    3.979123          1          9
-------------+---------------------------------------------------------
        v489 |      1,012    4.035573    3.883914          1          9
        v490 |      1,012    4.051383    3.887809          1          9
        v491 |      1,012    4.083004    3.895396          1          9
        v492 |      1,012    4.256917    3.932316          1          9
        v493 |      1,012    4.588933    3.980789          1          9
-------------+---------------------------------------------------------
        v494 |      1,012     4.73913    3.993458          1          9
        v495 |      1,012    4.936759    4.001478          1          9
        v496 |      1,012    5.181818    3.997841          1          9
        v497 |      1,012    5.458498      3.9756          1          9
        v498 |      1,012    5.664032    3.946448          1          9
-------------+---------------------------------------------------------
        v499 |      1,012    5.774704    3.926203          1          9
        v500 |      1,012     5.86166    3.908022          1          9
        v501 |      1,012    5.964427    3.883914          1          9
        v502 |      1,012    6.035573    3.865534          1          9
        v503 |      1,012    6.185771    3.822091          1          9
-------------+---------------------------------------------------------
        v504 |      1,012    6.256917    3.799266          1          9
        v505 |      1,012    6.391304    3.752091          1          9
        v506 |      1,012    6.438735    3.734142          1          9
        v507 |      1,012    6.588933    3.672686          1          9
        v508 |      1,012    6.699605    3.622749          1          9
-------------+---------------------------------------------------------
        v509 |      1,012    6.778656    3.584561          1          9
        v510 |      1,012    6.841897    3.552448          1          9
        v511 |      1,012    6.920949     3.51029          1          9
        v512 |      1,012    7.039526     3.44268          1          9
        v513 |      1,012    7.079051    3.418932          1          9
-------------+---------------------------------------------------------
        v514 |      1,012    7.189723    3.349059          1          9
        v515 |      1,012    7.300395    3.273954          1          9
        v516 |      1,012    7.379447    3.216902          1          9
        v517 |      1,012    7.450593    3.162986          1          9
        v518 |      1,012    7.537549     3.09359          1          9
-------------+---------------------------------------------------------
        v519 |      1,012    7.624506    3.020096          1          9
        v520 |      1,012    7.711462    2.942197          1          9
        v521 |      1,012    7.837945    2.820271          1          9
        v522 |      1,012    7.932806     2.72139          1          9
        v523 |      1,012    8.011858    2.633546          1          9
-------------+---------------------------------------------------------
        v524 |      1,012    8.106719    2.520828          1          9
        v525 |      1,012    8.217391     2.37781          1          9
        v526 |      1,012    8.272727    2.300975          1          9
        v527 |      1,012    8.620553    1.701309          1          9
        v528 |      1,012     8.72332    1.462532          1          9
-------------+---------------------------------------------------------
        v529 |      1,012    8.818182    1.192851          1          9
        v530 |      1,012    8.849802    1.086365          1          9
        v531 |      1,012    8.889328    .9348748          1          9
        v532 |      1,012    8.944664    .6633706          1          9
        v533 |      1,012    8.968379    .5022089          1          9
-------------+---------------------------------------------------------
        v534 |      1,012    8.976285    .4351414          1          9
        v535 |      1,012    8.968379    .5022089          1          9
        v536 |      1,012    8.960474     .561208          1          9
        v537 |      1,012    8.936759    .7088201          1          9
        v538 |      1,012    8.913043    .8299225          1          9
-------------+---------------------------------------------------------
        v539 |      1,012    8.849802    1.086365          1          9
        v540 |      1,012    8.818182    1.192851          1          9
        v541 |      1,012    8.794466    1.266337          1          9
        v542 |      1,012    8.747036    1.400594          1          9
        v543 |      1,012    8.683794    1.559507          1          9
-------------+---------------------------------------------------------
        v544 |      1,012    8.628458    1.684367          1          9
        v545 |      1,012    8.620553    1.701309          1          9
        v546 |      1,012    8.612648    1.718048          1          9
        v547 |      1,012    8.612648    1.718048          1          9
        v548 |      1,012    8.565217    1.814519          1          9
-------------+---------------------------------------------------------
        v549 |      1,012    8.533597    1.875412          1          9
        v550 |      1,012    8.525692    1.890246          1          9
        v551 |      1,012    8.478261    1.976249          1          9
        v552 |      1,012     8.43083    2.057569          1          9
        v553 |      1,012    8.454545    2.017458          1          9
-------------+---------------------------------------------------------
        v554 |      1,012    8.486166    1.962257          1          9
        v555 |      1,012     8.43083    2.057569          1          9
        v556 |      1,012    8.438735    2.044317          1          9
        v557 |      1,012    8.486166    1.962257          1          9
        v558 |      1,012    8.517787    1.904931          1          9
-------------+---------------------------------------------------------
        v559 |      1,012    8.501976    1.933871          1          9
        v560 |      1,012    8.525692    1.890246          1          9
        v561 |      1,012    8.533597    1.875412          1          9
        v562 |      1,012    8.533597    1.875412          1          9
        v563 |      1,012    8.557312    1.829983          1          9
-------------+---------------------------------------------------------
        v564 |      1,012    8.573123    1.798887          1          9
        v565 |      1,012    8.596838    1.750939          1          9
        v566 |      1,012    8.596838    1.750939          1          9
        v567 |      1,012    8.596838    1.750939          1          9
        v568 |      1,012    8.612648    1.718048          1          9
-------------+---------------------------------------------------------
        v569 |      1,012    8.620553    1.701309          1          9
        v570 |      1,012    8.620553    1.701309          1          9
        v571 |      1,012    8.620553    1.701309          1          9
        v572 |      1,012    8.628458    1.684367          1          9
        v573 |      1,012    8.628458    1.684367          1          9
-------------+---------------------------------------------------------
        v574 |      1,012    8.652174    1.632256          1          9
        v575 |      1,012    8.683794    1.559507          1          9
        v576 |      1,012    8.683794    1.559507          1          9
        v577 |      1,012    8.675889    1.578068          1          9
        v578 |      1,012      8.6917    1.540682          1          9
-------------+---------------------------------------------------------
        v579 |      1,012    8.715415    1.482519          1          9
        v580 |      1,012    8.747036    1.400594          1          9
        v581 |      1,012    8.794466    1.266337          1          9
        v582 |      1,012    8.857708    1.057922          1          9
        v583 |      1,012    8.905138    .8663927          1          9
-------------+---------------------------------------------------------
        v584 |      1,012    8.913043    .8299225          1          9
        v585 |      1,012    8.944664    .6633706          1          9
        v586 |      1,012    8.968379    .5022089          1          9
        v587 |      1,012     8.98419    .3554674          1          9
        v588 |      1,012    8.992095    .2514778          1          9
-------------+---------------------------------------------------------
        v589 |      1,012           9           0          9          9
        v590 |      1,012           9           0          9          9
        v591 |      1,012           9           0          9          9
        v592 |      1,012           9           0          9          9
        v593 |      1,012     8.98419    .3554674          1          9
-------------+---------------------------------------------------------
        v594 |      1,012     8.98419    .3554674          1          9
        v595 |      1,012    8.960474     .561208          1          9
        v596 |      1,012    8.968379    .5022089          1          9
        v597 |      1,012    8.944664    .6633706          1          9
        v598 |      1,012    8.952569    .6144673          1          9
-------------+---------------------------------------------------------
        v599 |      1,012    8.928854    .7514427          1          9
        v600 |      1,012    8.905138    .8663927          1          9
        v601 |      1,012    8.913043    .8299225          1          9
        v602 |      1,012    8.905138    .8663927          1          9
        v603 |      1,012    8.897233    .9013191          1          9
-------------+---------------------------------------------------------
        v604 |      1,012    8.873518    .9984212          1          9
        v605 |      1,012    8.857708    1.057922          1          9
        v606 |      1,012    8.865613    1.028632          1          9
        v607 |      1,012    8.881423    .9672024          1          9
        v608 |      1,012    8.857708    1.057922          1          9
-------------+---------------------------------------------------------
        v609 |      1,012    8.873518    .9984212          1          9
        v610 |      1,012    8.881423    .9672024          1          9
        v611 |      1,012    8.897233    .9013191          1          9
        v612 |      1,012    8.905138    .8663927          1          9
        v613 |      1,012    8.905138    .8663927          1          9
-------------+---------------------------------------------------------
        v614 |      1,012    8.889328    .9348748          1          9
        v615 |      1,012    8.928854    .7514427          1          9
        v616 |      1,012    8.944664    .6633706          1          9
        v617 |      1,012    8.944664    .6633706          1          9
        v618 |      1,012    8.960474     .561208          1          9
-------------+---------------------------------------------------------
        v619 |      1,012    8.960474     .561208          1          9
        v620 |      1,012    8.960474     .561208          1          9
        v621 |      1,012    8.960474     .561208          1          9
        v622 |      1,012    8.952569    .6144673          1          9
        v623 |      1,012    8.952569    .6144673          1          9
-------------+---------------------------------------------------------
        v624 |      1,012    8.960474     .561208          1          9
        v625 |      1,012    8.960474     .561208          1          9
        v626 |      1,012    8.960474     .561208          1          9
        v627 |      1,012    8.960474     .561208          1          9
        v628 |      1,012    8.976285    .4351414          1          9
-------------+---------------------------------------------------------
        v629 |      1,012    8.976285    .4351414          1          9
        v630 |      1,012     8.98419    .3554674          1          9
        v631 |      1,012     8.98419    .3554674          1          9
        v632 |      1,012    8.976285    .4351414          1          9
        v633 |      1,012    8.992095    .2514778          1          9
-------------+---------------------------------------------------------
        v634 |      1,012    8.992095    .2514778          1          9
        v635 |      1,012    8.992095    .2514778          1          9
        v636 |      1,012     8.98419    .3554674          1          9
        v637 |      1,012    8.992095    .2514778          1          9
        v638 |      1,012    8.992095    .2514778          1          9
-------------+---------------------------------------------------------
        v639 |      1,012    8.992095    .2514778          1          9
        v640 |      1,012    8.992095    .2514778          1          9
        v641 |      1,012           9           0          9          9
        v642 |      1,012           9           0          9          9
        v643 |      1,012           9           0          9          9
-------------+---------------------------------------------------------
        v644 |      1,012           9           0          9          9
        v645 |      1,012           9           0          9          9
        v646 |      1,012     8.98419    .3554674          1          9
        v647 |      1,012    8.913043    .8299225          1          9
        v648 |      1,012    8.905138    .8663927          1          9
-------------+---------------------------------------------------------
        v649 |      1,012    8.849802    1.086365          1          9
        v650 |      1,012    8.826087    1.167221          1          9
        v651 |      1,012    8.786561    1.289805          1          9
        v652 |      1,012     8.72332    1.462532          1          9
        v653 |      1,012    8.747036    1.400594          1          9
-------------+---------------------------------------------------------
        v654 |      1,012    8.731225    1.442225          1          9
        v655 |      1,012    8.731225    1.442225          1          9
        v656 |      1,012    8.754941    1.379239          1          9
        v657 |      1,012     8.73913    1.421584          1          9
        v658 |      1,012     8.72332    1.462532          1          9
-------------+---------------------------------------------------------
        v659 |      1,012    8.715415    1.482519          1          9
        v660 |      1,012    8.699605    1.521582          1          9
        v661 |      1,012     8.70751    1.502198          1          9
        v662 |      1,012     8.70751    1.502198          1          9
        v663 |      1,012     8.73913    1.421584          1          9
-------------+---------------------------------------------------------
        v664 |      1,012    8.747036    1.400594          1          9
        v665 |      1,012    8.762846    1.357502          1          9
        v666 |      1,012    8.754941    1.379239          1          9
        v667 |      1,012    8.754941    1.379239          1          9
        v668 |      1,012    8.731225    1.442225          1          9
-------------+---------------------------------------------------------
        v669 |      1,012    8.778656    1.312806          1          9
        v670 |      1,012    8.770751    1.335365          1          9
        v671 |      1,012    8.802372    1.242375          1          9
        v672 |      1,012    8.826087    1.167221          1          9
        v673 |      1,012    8.841897    1.114025          1          9
-------------+---------------------------------------------------------
        v674 |      1,012    8.841897    1.114025          1          9
        v675 |      1,012    8.865613    1.028632          1          9
        v676 |      1,012    8.865613    1.028632          1          9
        v677 |      1,012    8.873518    .9984212          1          9
        v678 |      1,012    8.873518    .9984212          1          9
-------------+---------------------------------------------------------
        v679 |      1,012    8.897233    .9013191          1          9
        v680 |      1,012    8.905138    .8663927          1          9
        v681 |      1,012    8.913043    .8299225          1          9
        v682 |      1,012    8.913043    .8299225          1          9
        v683 |      1,012    8.913043    .8299225          1          9
-------------+---------------------------------------------------------
        v684 |      1,012    8.920949    .7916952          1          9
        v685 |      1,012    8.920949    .7916952          1          9
        v686 |      1,012    8.928854    .7514427          1          9
        v687 |      1,012    8.928854    .7514427          1          9
        v688 |      1,012    8.936759    .7088201          1          9
-------------+---------------------------------------------------------
        v689 |      1,012    8.960474     .561208          1          9
        v690 |      1,012    8.960474     .561208          1          9
        v691 |      1,012    8.960474     .561208          1          9
        v692 |      1,012    8.976285    .4351414          1          9
        v693 |      1,012    8.976285    .4351414          1          9
-------------+---------------------------------------------------------
        v694 |      1,012    8.992095    .2514778          1          9
        v695 |      1,012    8.992095    .2514778          1          9
        v696 |      1,012           9           0          9          9

. 
. ** variable number of spouse
. *** common variable with other years
. gen relno=.
(1,012 missing values generated)

. gen dsex=.
(1,012 missing values generated)

. gen bYear=.
(1,012 missing values generated)

. gen bMonth=.
(1,012 missing values generated)

. local renameListSpo ///
>                                 v1 v4 v14 v15 v16 ///
>                                 v85 v86 v87 ///
>                                 v864 v885 ///
>                                 v932 v933 v934 v935 v938 v939 ///
>                                 v947 v948 v949 ///
>                                 v953 v954 v955 v956 v957 v958 ///
>                                 v963 v964 v965

. *** variables of working experience
. global CasSpo v1141-v1194

. global FullSpo v1195-v1248

. global SelfSpo v1249-v1302

. global SideSpo v1303-v1356

. global FmwSpo v1357-v1410

. sum `renameListSpo' $CasSpo $FullSpo $SelfSpo $SideSpo $FmwSpo

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |      1,012      7506.5    292.2835       7001       8012
          v4 |      1,012      1.3083    .4620197          1          2
         v14 |      1,012    1.800395     1.57681          1          8
         v15 |      1,012     2502.43    1908.592       1914       9999
         v16 |      1,012    12.78458     22.9348          1         99
-------------+---------------------------------------------------------
         v85 |      1,012    3.065217    11.79556          1         99
         v86 |      1,012    2.073123    1.196181          1          9
         v87 |      1,012    77.33992    28.35488          1         99
        v864 |      1,012    4.460474    2.599441          1          9
        v885 |      1,012    4.338933     3.03601          1          9
-------------+---------------------------------------------------------
        v932 |      1,012     47.6413    40.91743          1         99
        v933 |      1,012    5.076087    3.081026          1          9
        v934 |      1,012    49.12549    39.41437          1         99
        v935 |      1,012    5.698617    2.620976          1          9
        v938 |      1,012    6.253953    1.969032          1          9
-------------+---------------------------------------------------------
        v939 |      1,012    5.948617    2.847827          1          9
        v947 |      1,012    5631.384    3471.074       1959       9999
        v948 |      1,012    50.43676    41.63264          1         99
        v949 |      1,012    5.315217    3.034657          1          9
        v953 |      1,012    5.189723    3.268949          1          9
-------------+---------------------------------------------------------
        v954 |      1,012    61326.44    41363.93         10      99999
        v955 |      1,012    875990.9    106168.3       3000     999999
        v956 |      1,012    815301.2    245131.6        647     999999
        v957 |      1,012    87056.81     12585.8         50      88888
        v958 |      1,012       50383    44775.85          0      99999
-------------+---------------------------------------------------------
        v963 |      1,012    55.97036    34.24458          2         99
        v964 |      1,012    507.9249    428.3149          1        999
        v965 |      1,012    618.7372    430.1085          0        999
       v1141 |      1,012    8.644269    .7495048          1          9
       v1142 |      1,012    8.596838    .9516033          1          9
-------------+---------------------------------------------------------
       v1143 |      1,012    8.573123    1.037186          1          9
       v1144 |      1,012    8.517787    1.211828          1          9
       v1145 |      1,012    8.407115    1.495218          1          9
       v1146 |      1,012    8.407115    1.495218          1          9
       v1147 |      1,012    8.296443    1.725777          1          9
-------------+---------------------------------------------------------
       v1148 |      1,012    8.328063    1.663919          1          9
       v1149 |      1,012    8.256917     1.79933          1          9
       v1150 |      1,012    8.288538    1.740808          1          9
       v1151 |      1,012    8.296443    1.725777          1          9
       v1152 |      1,012    8.343874    1.631882          1          9
-------------+---------------------------------------------------------
       v1153 |      1,012    8.343874    1.631882          1          9
       v1154 |      1,012    8.375494    1.565362          1          9
       v1155 |      1,012    8.383399    1.548185          1          9
       v1156 |      1,012    8.391304    1.530774          1          9
       v1157 |      1,012    8.407115    1.495218          1          9
-------------+---------------------------------------------------------
       v1158 |      1,012    8.343874    1.631882          1          9
       v1159 |      1,012    8.296443    1.725777          1          9
       v1160 |      1,012    8.288538    1.740808          1          9
       v1161 |      1,012    8.256917     1.79933          1          9
       v1162 |      1,012    8.217391    1.869156          1          9
-------------+---------------------------------------------------------
       v1163 |      1,012    8.193676    1.909433          1          9
       v1164 |      1,012     8.12253    2.023797          1          9
       v1165 |      1,012    8.075099    2.095233          1          9
       v1166 |      1,012    8.059289    2.118274          1          9
       v1167 |      1,012    8.106719    2.048008          1          9
-------------+---------------------------------------------------------
       v1168 |      1,012    8.083004    2.083572          1          9
       v1169 |      1,012     8.12253    2.023797          1          9
       v1170 |      1,012    8.193676    1.909433          1          9
       v1171 |      1,012    8.233202    1.841645          1          9
       v1172 |      1,012    8.288538    1.740808          1          9
-------------+---------------------------------------------------------
       v1173 |      1,012    8.272727    1.770381          1          9
       v1174 |      1,012    8.288538    1.740808          1          9
       v1175 |      1,012    8.312253    1.695204          1          9
       v1176 |      1,012    8.328063    1.663919          1          9
       v1177 |      1,012    8.375494    1.565362          1          9
-------------+---------------------------------------------------------
       v1178 |      1,012    8.359684    1.599046          1          9
       v1179 |      1,012     8.41502    1.477056          1          9
       v1180 |      1,012    8.454545    1.381991          1          9
       v1181 |      1,012    8.478261    1.321107          1          9
       v1182 |      1,012    8.517787    1.211828          1          9
-------------+---------------------------------------------------------
       v1183 |      1,012    8.517787    1.211828          1          9
       v1184 |      1,012    8.533597    1.164874          1          9
       v1185 |      1,012    8.533597    1.164874          1          9
       v1186 |      1,012    8.565217    1.064068          1          9
       v1187 |      1,012    8.501976    1.256829          1          9
-------------+---------------------------------------------------------
       v1188 |      1,012    8.525692    1.188609          1          9
       v1189 |      1,012    8.541502     1.14059          1          9
       v1190 |      1,012    8.565217    1.064068          1          9
       v1191 |      1,012    8.588933    .9810247          1          9
       v1192 |      1,012    8.612648     .889636          1          9
-------------+---------------------------------------------------------
       v1193 |      1,012    8.628458     .822712          1          9
       v1194 |      1,012    8.652174    .7099444          1          9
       v1195 |      1,012    8.478261    1.321107          1          9
       v1196 |      1,012    8.359684    1.599046          1          9
       v1197 |      1,012    8.320158    1.679653          1          9
-------------+---------------------------------------------------------
       v1198 |      1,012     7.55336    2.707304          1          9
       v1199 |      1,012    6.312253    3.483084          1          9
       v1200 |      1,012     6.15415    3.538673          1          9
       v1201 |      1,012     5.55336    3.680907          1          9
       v1202 |      1,012    5.371542    3.703702          1          9
-------------+---------------------------------------------------------
       v1203 |      1,012    4.881423    3.720419          1          9
       v1204 |      1,012    4.810277    3.717467          1          9
       v1205 |      1,012    4.905138    3.721099          1          9
       v1206 |      1,012    5.055336    3.721898          1          9
       v1207 |      1,012    5.213439    3.716179          1          9
-------------+---------------------------------------------------------
       v1208 |      1,012    5.387352     3.70208          1          9
       v1209 |      1,012    5.426877    3.697727          1          9
       v1210 |      1,012     5.55336    3.680907          1          9
       v1211 |      1,012    5.711462    3.653616          1          9
       v1212 |      1,012    5.766798    3.642393          1          9
-------------+---------------------------------------------------------
       v1213 |      1,012    5.940711    3.601357          1          9
       v1214 |      1,012    6.043478    3.572907          1          9
       v1215 |      1,012    6.106719    3.553808          1          9
       v1216 |      1,012    6.217391    3.517397          1          9
       v1217 |      1,012    6.335968    3.474048          1          9
-------------+---------------------------------------------------------
       v1218 |      1,012     6.41502    3.442576          1          9
       v1219 |      1,012    6.462451    3.422676          1          9
       v1220 |      1,012    6.517787    3.398475          1          9
       v1221 |      1,012    6.628458    3.346803          1          9
       v1222 |      1,012     6.70751    3.307131          1          9
-------------+---------------------------------------------------------
       v1223 |      1,012    6.786561    3.265062          1          9
       v1224 |      1,012    6.857708    3.225073          1          9
       v1225 |      1,012    6.913043    3.192528          1          9
       v1226 |      1,012     6.98419    3.148759          1          9
       v1227 |      1,012    7.031621    3.118337          1          9
-------------+---------------------------------------------------------
       v1228 |      1,012    7.071146      3.0922          1          9
       v1229 |      1,012    7.221344    2.986024          1          9
       v1230 |      1,012     7.29249    2.931702          1          9
       v1231 |      1,012    7.332016     2.90033          1          9
       v1232 |      1,012    7.387352    2.854909          1          9
-------------+---------------------------------------------------------
       v1233 |      1,012    7.442688    2.807662          1          9
       v1234 |      1,012    7.466403    2.786831          1          9
       v1235 |      1,012    7.513834     2.74408          1          9
       v1236 |      1,012    7.616601     2.64617          1          9
       v1237 |      1,012    7.679842     2.58204          1          9
-------------+---------------------------------------------------------
       v1238 |      1,012    7.798419    2.452895          1          9
       v1239 |      1,012    7.869565    2.369185          1          9
       v1240 |      1,012    7.956522    2.259629          1          9
       v1241 |      1,012    8.320158    1.679653          1          9
       v1242 |      1,012    8.359684    1.599046          1          9
-------------+---------------------------------------------------------
       v1243 |      1,012     8.44664    1.401609          1          9
       v1244 |      1,012    8.517787    1.211828          1          9
       v1245 |      1,012    8.549407    1.115722          1          9
       v1246 |      1,012    8.596838    .9516033          1          9
       v1247 |      1,012    8.596838    .9516033          1          9
-------------+---------------------------------------------------------
       v1248 |      1,012    8.628458     .822712          1          9
       v1249 |      1,012    8.675889    .5745094          1          9
       v1250 |      1,012    8.675889    .5745094          1          9
       v1251 |      1,012    8.660079    .6679517          1          9
       v1252 |      1,012    8.644269    .7495048          1          9
-------------+---------------------------------------------------------
       v1253 |      1,012    8.604743    .9211748          1          9
       v1254 |      1,012    8.604743    .9211748          1          9
       v1255 |      1,012    8.573123    1.037186          1          9
       v1256 |      1,012    8.541502     1.14059          1          9
       v1257 |      1,012    8.509881    1.234559          1          9
-------------+---------------------------------------------------------
       v1258 |      1,012    8.462451    1.362045          1          9
       v1259 |      1,012    8.454545    1.381991          1          9
       v1260 |      1,012    8.438735    1.420913          1          9
       v1261 |      1,012    8.407115    1.495218          1          9
       v1262 |      1,012    8.383399    1.548185          1          9
-------------+---------------------------------------------------------
       v1263 |      1,012    8.383399    1.548185          1          9
       v1264 |      1,012    8.375494    1.565362          1          9
       v1265 |      1,012    8.391304    1.530774          1          9
       v1266 |      1,012    8.375494    1.565362          1          9
       v1267 |      1,012    8.351779    1.615567          1          9
-------------+---------------------------------------------------------
       v1268 |      1,012    8.335968    1.647998          1          9
       v1269 |      1,012    8.296443    1.725777          1          9
       v1270 |      1,012    8.296443    1.725777          1          9
       v1271 |      1,012    8.304348    1.710577          1          9
       v1272 |      1,012    8.280632    1.755675          1          9
-------------+---------------------------------------------------------
       v1273 |      1,012    8.280632    1.755675          1          9
       v1274 |      1,012    8.288538    1.740808          1          9
       v1275 |      1,012    8.320158    1.679653          1          9
       v1276 |      1,012    8.335968    1.647998          1          9
       v1277 |      1,012    8.320158    1.679653          1          9
-------------+---------------------------------------------------------
       v1278 |      1,012    8.320158    1.679653          1          9
       v1279 |      1,012    8.320158    1.679653          1          9
       v1280 |      1,012    8.328063    1.663919          1          9
       v1281 |      1,012    8.359684    1.599046          1          9
       v1282 |      1,012    8.375494    1.565362          1          9
-------------+---------------------------------------------------------
       v1283 |      1,012    8.383399    1.548185          1          9
       v1284 |      1,012    8.375494    1.565362          1          9
       v1285 |      1,012    8.407115    1.495218          1          9
       v1286 |      1,012    8.422925    1.458624          1          9
       v1287 |      1,012    8.438735    1.420913          1          9
-------------+---------------------------------------------------------
       v1288 |      1,012     8.44664    1.401609          1          9
       v1289 |      1,012    8.454545    1.381991          1          9
       v1290 |      1,012    8.478261    1.321107          1          9
       v1291 |      1,012    8.501976    1.256829          1          9
       v1292 |      1,012    8.509881    1.234559          1          9
-------------+---------------------------------------------------------
       v1293 |      1,012    8.525692    1.188609          1          9
       v1294 |      1,012    8.533597    1.164874          1          9
       v1295 |      1,012    8.565217    1.064068          1          9
       v1296 |      1,012    8.581028    1.009527          1          9
       v1297 |      1,012    8.596838    .9516033          1          9
-------------+---------------------------------------------------------
       v1298 |      1,012    8.612648     .889636          1          9
       v1299 |      1,012    8.628458     .822712          1          9
       v1300 |      1,012    8.644269    .7495048          1          9
       v1301 |      1,012    8.644269    .7495048          1          9
       v1302 |      1,012    8.652174    .7099444          1          9
-------------+---------------------------------------------------------
       v1303 |      1,012      8.6917    .4620197          8          9
       v1304 |      1,012      8.6917    .4620197          8          9
       v1305 |      1,012      8.6917    .4620197          8          9
       v1306 |      1,012      8.6917    .4620197          8          9
       v1307 |      1,012    8.683794    .5213676          1          9
-------------+---------------------------------------------------------
       v1308 |      1,012    8.683794    .5213676          1          9
       v1309 |      1,012    8.683794    .5213676          1          9
       v1310 |      1,012    8.675889    .5745094          1          9
       v1311 |      1,012    8.667984    .6230351          1          9
       v1312 |      1,012    8.667984    .6230351          1          9
-------------+---------------------------------------------------------
       v1313 |      1,012    8.660079    .6679517          1          9
       v1314 |      1,012    8.652174    .7099444          1          9
       v1315 |      1,012    8.628458     .822712          1          9
       v1316 |      1,012    8.628458     .822712          1          9
       v1317 |      1,012    8.628458     .822712          1          9
-------------+---------------------------------------------------------
       v1318 |      1,012    8.636364    .7869998          1          9
       v1319 |      1,012    8.636364    .7869998          1          9
       v1320 |      1,012    8.636364    .7869998          1          9
       v1321 |      1,012    8.652174    .7099444          1          9
       v1322 |      1,012    8.652174    .7099444          1          9
-------------+---------------------------------------------------------
       v1323 |      1,012    8.644269    .7495048          1          9
       v1324 |      1,012    8.652174    .7099444          1          9
       v1325 |      1,012    8.652174    .7099444          1          9
       v1326 |      1,012    8.660079    .6679517          1          9
       v1327 |      1,012    8.660079    .6679517          1          9
-------------+---------------------------------------------------------
       v1328 |      1,012    8.667984    .6230351          1          9
       v1329 |      1,012    8.675889    .5745094          1          9
       v1330 |      1,012    8.675889    .5745094          1          9
       v1331 |      1,012    8.675889    .5745094          1          9
       v1332 |      1,012    8.675889    .5745094          1          9
-------------+---------------------------------------------------------
       v1333 |      1,012    8.675889    .5745094          1          9
       v1334 |      1,012    8.683794    .5213676          1          9
       v1335 |      1,012    8.675889    .5745094          1          9
       v1336 |      1,012    8.675889    .5745094          1          9
       v1337 |      1,012    8.675889    .5745094          1          9
-------------+---------------------------------------------------------
       v1338 |      1,012    8.675889    .5745094          1          9
       v1339 |      1,012    8.683794    .5213676          1          9
       v1340 |      1,012    8.683794    .5213676          1          9
       v1341 |      1,012    8.683794    .5213676          1          9
       v1342 |      1,012    8.683794    .5213676          1          9
-------------+---------------------------------------------------------
       v1343 |      1,012    8.683794    .5213676          1          9
       v1344 |      1,012    8.683794    .5213676          1          9
       v1345 |      1,012    8.683794    .5213676          1          9
       v1346 |      1,012    8.683794    .5213676          1          9
       v1347 |      1,012      8.6917    .4620197          8          9
-------------+---------------------------------------------------------
       v1348 |      1,012      8.6917    .4620197          8          9
       v1349 |      1,012      8.6917    .4620197          8          9
       v1350 |      1,012      8.6917    .4620197          8          9
       v1351 |      1,012      8.6917    .4620197          8          9
       v1352 |      1,012      8.6917    .4620197          8          9
-------------+---------------------------------------------------------
       v1353 |      1,012      8.6917    .4620197          8          9
       v1354 |      1,012      8.6917    .4620197          8          9
       v1355 |      1,012      8.6917    .4620197          8          9
       v1356 |      1,012      8.6917    .4620197          8          9
       v1357 |      1,012      8.6917    .4620197          8          9
-------------+---------------------------------------------------------
       v1358 |      1,012      8.6917    .4620197          8          9
       v1359 |      1,012      8.6917    .4620197          8          9
       v1360 |      1,012      8.6917    .4620197          8          9
       v1361 |      1,012    8.667984    .6230351          1          9
       v1362 |      1,012    8.660079    .6679517          1          9
-------------+---------------------------------------------------------
       v1363 |      1,012    8.628458     .822712          1          9
       v1364 |      1,012    8.588933    .9810247          1          9
       v1365 |      1,012    8.565217    1.064068          1          9
       v1366 |      1,012    8.509881    1.234559          1          9
       v1367 |      1,012    8.494071    1.278663          1          9
-------------+---------------------------------------------------------
       v1368 |      1,012    8.478261    1.321107          1          9
       v1369 |      1,012     8.44664    1.401609          1          9
       v1370 |      1,012    8.422925    1.458624          1          9
       v1371 |      1,012    8.407115    1.495218          1          9
       v1372 |      1,012    8.407115    1.495218          1          9
-------------+---------------------------------------------------------
       v1373 |      1,012     8.41502    1.477056          1          9
       v1374 |      1,012    8.438735    1.420913          1          9
       v1375 |      1,012    8.438735    1.420913          1          9
       v1376 |      1,012    8.422925    1.458624          1          9
       v1377 |      1,012    8.422925    1.458624          1          9
-------------+---------------------------------------------------------
       v1378 |      1,012    8.438735    1.420913          1          9
       v1379 |      1,012     8.41502    1.477056          1          9
       v1380 |      1,012    8.422925    1.458624          1          9
       v1381 |      1,012    8.422925    1.458624          1          9
       v1382 |      1,012     8.43083    1.439914          1          9
-------------+---------------------------------------------------------
       v1383 |      1,012    8.470356    1.341755          1          9
       v1384 |      1,012    8.478261    1.321107          1          9
       v1385 |      1,012    8.486166    1.300082          1          9
       v1386 |      1,012    8.509881    1.234559          1          9
       v1387 |      1,012    8.517787    1.211828          1          9
-------------+---------------------------------------------------------
       v1388 |      1,012    8.517787    1.211828          1          9
       v1389 |      1,012    8.525692    1.188609          1          9
       v1390 |      1,012    8.533597    1.164874          1          9
       v1391 |      1,012    8.533597    1.164874          1          9
       v1392 |      1,012    8.541502     1.14059          1          9
-------------+---------------------------------------------------------
       v1393 |      1,012    8.541502     1.14059          1          9
       v1394 |      1,012    8.549407    1.115722          1          9
       v1395 |      1,012    8.565217    1.064068          1          9
       v1396 |      1,012    8.581028    1.009527          1          9
       v1397 |      1,012    8.588933    .9810247          1          9
-------------+---------------------------------------------------------
       v1398 |      1,012    8.596838    .9516033          1          9
       v1399 |      1,012    8.604743    .9211748          1          9
       v1400 |      1,012    8.612648     .889636          1          9
       v1401 |      1,012    8.612648     .889636          1          9
       v1402 |      1,012    8.644269    .7495048          1          9
-------------+---------------------------------------------------------
       v1403 |      1,012    8.644269    .7495048          1          9
       v1404 |      1,012    8.652174    .7099444          1          9
       v1405 |      1,012    8.667984    .6230351          1          9
       v1406 |      1,012    8.683794    .5213676          1          9
       v1407 |      1,012      8.6917    .4620197          8          9
-------------+---------------------------------------------------------
       v1408 |      1,012      8.6917    .4620197          8          9
       v1409 |      1,012      8.6917    .4620197          8          9
       v1410 |      1,012      8.6917    .4620197          8          9

. 
. ** variable list to be convert to matrix
. local matVarList `varList' dhead dearnmost $ExpList

. 
. * set survey year
. local SvyY=$SVYY

. local currentData $CurrentData

. disp "Current data set is `currentData'`SvyY'"
Current data set is KHPSnew2012

. 
. * 1. rename varname and make head dummy
. local renameList renameListPri renameListSpo

. local n: word count `renameList' /* set counter of renameList */

. forvalues i = 1/`n' { /* loop within rename list */
  2.         /* select list */
.         local currentRenameList: word `i' of `renameList'
  3.         dis " ** Rename variables of `currentRenameList' "
  4.         
.         * rename varname
.         ** rename common variable
.         rename ( ``currentRenameList'' ) ( `varList' )
  5.         
.         ** rename variable of experience
.         dis " rename variable of experience "
  6.         global Resp_i `i'
  7.         global Age_t 15
  8.         do "$Path\Code\Renamevar_Exp.do"
  9.         
.         if `i'==1 {
 10.                 dis " replace id of principle "
 11.                 ** replace id (KHPS)
.                 replace id = id+20000
 12.         }
 13.         else {
 14.                 dis " replace id of spouse and drop not married "
 15.                 ** replace id (spouse)
.                 replace id = id+10000
 16.                 ** keep sample of spouse
.                 keep if marital==1
 17.                 count
 18.         }
 19.         
.         dis " make household head dummy  "
 20.         ** make household head dummy
.         *** Q = Are you head of household?
.         gen dhead=.
 21.         replace dhead=0 if head!=`i'
 22.         replace dhead=1 if head==`i'
 23.         label var dhead "HH head dummy"
 24.         tab head marital, sum(dhead) mean miss
 25.         
.         *** Q = Are you main breadwinner?
.         ge dearnmost=.
 26.         replace earnmost=1 if dhead==1&earnif==2
 27.         replace dearnmost=1 if earnmost==`i'
 28.         replace dearnmost=0 if dearnmost!=1
 29.         label var dearnmost "Breadwinner dummy"
 30.         tab earnmost marital, sum(dearnmost) mean miss
 31.         
.         sum id
 32.         
.         ** save variable as matrix
.         if `i'==1{
 33.                 local matName pri
 34.         }
 35.         else {
 36.                 local matName spo
 37.         }
 38.         mkmat `matVarList', matrix(`matName')
 39.         mat dir
 40.         
.         ** restore variable names
.         rename ( `varList' ) ( ``currentRenameList'' )
 41.         drop dhead dearnmost
 42.         drop $ExpList
 43. }
 ** Rename variables of renameListPri 
 rename variable of experience 

. *******************************************************
. *Title: Renamevar_Exp
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables of working experience
. * 
. * 1. rename vars. of experience
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. * set list of variables
. ** of principal
. local casPri $CasPri

. local fullPri $FullPri

. local selfPri $SelfPri

. local sidePri $SidePri

. local fmwPri $FmwPri

. ** of spouse
. local casSpo $CasSpo

. local fullSpo $FullSpo

. local selfSpo $SelfSpo

. local sideSpo $SideSpo

. local fmwSpo $FmwSpo

. 
. * 1. rename vars. of experience
. local empStatus cas full self side fmw

. local num_m: word count `empStatus'

. local resp_i $Resp_i

. local age_t $Age_t

. 
. if `resp_i'==1{
.         local expVar casPri fullPri selfPri sidePri fmwPri
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. else {
.         local expVar casSpo fullSpo selfSpo sideSpo fmwSpo
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. sum $ExpList

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       cas15 |      1,012    8.944664    .6633706          1          9
       cas16 |      1,012    8.873518    .9984212          1          9
       cas17 |      1,012    8.770751    1.335365          1          9
       cas18 |      1,012      8.6917    1.540682          1          9
       cas19 |      1,012    8.478261    1.976249          1          9
-------------+---------------------------------------------------------
       cas20 |      1,012    8.375494     2.14723          1          9
       cas21 |      1,012    8.233202    2.356246          1          9
       cas22 |      1,012    8.225296    2.367066          1          9
       cas23 |      1,012    8.256917    2.323322          1          9
       cas24 |      1,012    8.343874    2.196196          1          9
-------------+---------------------------------------------------------
       cas25 |      1,012    8.383399     2.13474          1          9
       cas26 |      1,012    8.454545    2.017458          1          9
       cas27 |      1,012    8.486166    1.962257          1          9
       cas28 |      1,012    8.541502    1.860426          1          9
       cas29 |      1,012    8.525692    1.890246          1          9
-------------+---------------------------------------------------------
       cas30 |      1,012    8.581028    1.783082          1          9
       cas31 |      1,012    8.557312    1.829983          1          9
       cas32 |      1,012    8.541502    1.860426          1          9
       cas33 |      1,012    8.486166    1.962257          1          9
       cas34 |      1,012     8.43083    2.057569          1          9
-------------+---------------------------------------------------------
       cas35 |      1,012    8.422925    2.070706          1          9
       cas36 |      1,012    8.383399     2.13474          1          9
       cas37 |      1,012    8.375494     2.14723          1          9
       cas38 |      1,012    8.383399     2.13474          1          9
       cas39 |      1,012    8.343874    2.196196          1          9
-------------+---------------------------------------------------------
       cas40 |      1,012    8.359684    2.171908          1          9
       cas41 |      1,012    8.335968    2.208197          1          9
       cas42 |      1,012    8.328063    2.220105          1          9
       cas43 |      1,012    8.328063    2.220105          1          9
       cas44 |      1,012    8.351779      2.1841          1          9
-------------+---------------------------------------------------------
       cas45 |      1,012    8.351779      2.1841          1          9
       cas46 |      1,012    8.391304    2.122146          1          9
       cas47 |      1,012    8.391304    2.122146          1          9
       cas48 |      1,012     8.41502     2.08373          1          9
       cas49 |      1,012     8.44664    2.030947          1          9
-------------+---------------------------------------------------------
       cas50 |      1,012     8.43083    2.057569          1          9
       cas51 |      1,012     8.44664    2.030947          1          9
       cas52 |      1,012    8.509881    1.919472          1          9
       cas53 |      1,012    8.588933    1.767101          1          9
       cas54 |      1,012    8.628458    1.684367          1          9
-------------+---------------------------------------------------------
       cas55 |      1,012    8.652174    1.632256          1          9
       cas56 |      1,012      8.6917    1.540682          1          9
       cas57 |      1,012     8.72332    1.462532          1          9
       cas58 |      1,012     8.73913    1.421584          1          9
       cas59 |      1,012    8.762846    1.357502          1          9
-------------+---------------------------------------------------------
       cas60 |      1,012    8.778656    1.312806          1          9
       cas61 |      1,012    8.762846    1.357502          1          9
       cas62 |      1,012    8.778656    1.312806          1          9
       cas63 |      1,012    8.841897    1.114025          1          9
       cas64 |      1,012    8.865613    1.028632          1          9
-------------+---------------------------------------------------------
       cas65 |      1,012    8.913043    .8299225          1          9
       cas66 |      1,012    8.952569    .6144673          1          9
       cas67 |      1,012    8.960474     .561208          1          9
       cas68 |      1,012    8.976285    .4351414          1          9
      full15 |      1,012    8.802372    1.242375          1          9
-------------+---------------------------------------------------------
      full16 |      1,012    8.699605    1.521582          1          9
      full17 |      1,012    8.596838    1.750939          1          9
      full18 |      1,012    7.648221    2.999302          1          9
      full19 |      1,012    6.130435    3.838838          1          9
      full20 |      1,012    5.782609    3.924633          1          9
-------------+---------------------------------------------------------
      full21 |      1,012    4.944664    4.001595          1          9
      full22 |      1,012    4.573123    3.979123          1          9
      full23 |      1,012    4.035573    3.883914          1          9
      full24 |      1,012    4.051383    3.887809          1          9
      full25 |      1,012    4.083004    3.895396          1          9
-------------+---------------------------------------------------------
      full26 |      1,012    4.256917    3.932316          1          9
      full27 |      1,012    4.588933    3.980789          1          9
      full28 |      1,012     4.73913    3.993458          1          9
      full29 |      1,012    4.936759    4.001478          1          9
      full30 |      1,012    5.181818    3.997841          1          9
-------------+---------------------------------------------------------
      full31 |      1,012    5.458498      3.9756          1          9
      full32 |      1,012    5.664032    3.946448          1          9
      full33 |      1,012    5.774704    3.926203          1          9
      full34 |      1,012     5.86166    3.908022          1          9
      full35 |      1,012    5.964427    3.883914          1          9
-------------+---------------------------------------------------------
      full36 |      1,012    6.035573    3.865534          1          9
      full37 |      1,012    6.185771    3.822091          1          9
      full38 |      1,012    6.256917    3.799266          1          9
      full39 |      1,012    6.391304    3.752091          1          9
      full40 |      1,012    6.438735    3.734142          1          9
-------------+---------------------------------------------------------
      full41 |      1,012    6.588933    3.672686          1          9
      full42 |      1,012    6.699605    3.622749          1          9
      full43 |      1,012    6.778656    3.584561          1          9
      full44 |      1,012    6.841897    3.552448          1          9
      full45 |      1,012    6.920949     3.51029          1          9
-------------+---------------------------------------------------------
      full46 |      1,012    7.039526     3.44268          1          9
      full47 |      1,012    7.079051    3.418932          1          9
      full48 |      1,012    7.189723    3.349059          1          9
      full49 |      1,012    7.300395    3.273954          1          9
      full50 |      1,012    7.379447    3.216902          1          9
-------------+---------------------------------------------------------
      full51 |      1,012    7.450593    3.162986          1          9
      full52 |      1,012    7.537549     3.09359          1          9
      full53 |      1,012    7.624506    3.020096          1          9
      full54 |      1,012    7.711462    2.942197          1          9
      full55 |      1,012    7.837945    2.820271          1          9
-------------+---------------------------------------------------------
      full56 |      1,012    7.932806     2.72139          1          9
      full57 |      1,012    8.011858    2.633546          1          9
      full58 |      1,012    8.106719    2.520828          1          9
      full59 |      1,012    8.217391     2.37781          1          9
      full60 |      1,012    8.272727    2.300975          1          9
-------------+---------------------------------------------------------
      full61 |      1,012    8.620553    1.701309          1          9
      full62 |      1,012     8.72332    1.462532          1          9
      full63 |      1,012    8.818182    1.192851          1          9
      full64 |      1,012    8.849802    1.086365          1          9
      full65 |      1,012    8.889328    .9348748          1          9
-------------+---------------------------------------------------------
      full66 |      1,012    8.944664    .6633706          1          9
      full67 |      1,012    8.968379    .5022089          1          9
      full68 |      1,012    8.976285    .4351414          1          9
      self15 |      1,012    8.968379    .5022089          1          9
      self16 |      1,012    8.960474     .561208          1          9
-------------+---------------------------------------------------------
      self17 |      1,012    8.936759    .7088201          1          9
      self18 |      1,012    8.913043    .8299225          1          9
      self19 |      1,012    8.849802    1.086365          1          9
      self20 |      1,012    8.818182    1.192851          1          9
      self21 |      1,012    8.794466    1.266337          1          9
-------------+---------------------------------------------------------
      self22 |      1,012    8.747036    1.400594          1          9
      self23 |      1,012    8.683794    1.559507          1          9
      self24 |      1,012    8.628458    1.684367          1          9
      self25 |      1,012    8.620553    1.701309          1          9
      self26 |      1,012    8.612648    1.718048          1          9
-------------+---------------------------------------------------------
      self27 |      1,012    8.612648    1.718048          1          9
      self28 |      1,012    8.565217    1.814519          1          9
      self29 |      1,012    8.533597    1.875412          1          9
      self30 |      1,012    8.525692    1.890246          1          9
      self31 |      1,012    8.478261    1.976249          1          9
-------------+---------------------------------------------------------
      self32 |      1,012     8.43083    2.057569          1          9
      self33 |      1,012    8.454545    2.017458          1          9
      self34 |      1,012    8.486166    1.962257          1          9
      self35 |      1,012     8.43083    2.057569          1          9
      self36 |      1,012    8.438735    2.044317          1          9
-------------+---------------------------------------------------------
      self37 |      1,012    8.486166    1.962257          1          9
      self38 |      1,012    8.517787    1.904931          1          9
      self39 |      1,012    8.501976    1.933871          1          9
      self40 |      1,012    8.525692    1.890246          1          9
      self41 |      1,012    8.533597    1.875412          1          9
-------------+---------------------------------------------------------
      self42 |      1,012    8.533597    1.875412          1          9
      self43 |      1,012    8.557312    1.829983          1          9
      self44 |      1,012    8.573123    1.798887          1          9
      self45 |      1,012    8.596838    1.750939          1          9
      self46 |      1,012    8.596838    1.750939          1          9
-------------+---------------------------------------------------------
      self47 |      1,012    8.596838    1.750939          1          9
      self48 |      1,012    8.612648    1.718048          1          9
      self49 |      1,012    8.620553    1.701309          1          9
      self50 |      1,012    8.620553    1.701309          1          9
      self51 |      1,012    8.620553    1.701309          1          9
-------------+---------------------------------------------------------
      self52 |      1,012    8.628458    1.684367          1          9
      self53 |      1,012    8.628458    1.684367          1          9
      self54 |      1,012    8.652174    1.632256          1          9
      self55 |      1,012    8.683794    1.559507          1          9
      self56 |      1,012    8.683794    1.559507          1          9
-------------+---------------------------------------------------------
      self57 |      1,012    8.675889    1.578068          1          9
      self58 |      1,012      8.6917    1.540682          1          9
      self59 |      1,012    8.715415    1.482519          1          9
      self60 |      1,012    8.747036    1.400594          1          9
      self61 |      1,012    8.794466    1.266337          1          9
-------------+---------------------------------------------------------
      self62 |      1,012    8.857708    1.057922          1          9
      self63 |      1,012    8.905138    .8663927          1          9
      self64 |      1,012    8.913043    .8299225          1          9
      self65 |      1,012    8.944664    .6633706          1          9
      self66 |      1,012    8.968379    .5022089          1          9
-------------+---------------------------------------------------------
      self67 |      1,012     8.98419    .3554674          1          9
      self68 |      1,012    8.992095    .2514778          1          9
      side15 |      1,012           9           0          9          9
      side16 |      1,012           9           0          9          9
      side17 |      1,012           9           0          9          9
-------------+---------------------------------------------------------
      side18 |      1,012           9           0          9          9
      side19 |      1,012     8.98419    .3554674          1          9
      side20 |      1,012     8.98419    .3554674          1          9
      side21 |      1,012    8.960474     .561208          1          9
      side22 |      1,012    8.968379    .5022089          1          9
-------------+---------------------------------------------------------
      side23 |      1,012    8.944664    .6633706          1          9
      side24 |      1,012    8.952569    .6144673          1          9
      side25 |      1,012    8.928854    .7514427          1          9
      side26 |      1,012    8.905138    .8663927          1          9
      side27 |      1,012    8.913043    .8299225          1          9
-------------+---------------------------------------------------------
      side28 |      1,012    8.905138    .8663927          1          9
      side29 |      1,012    8.897233    .9013191          1          9
      side30 |      1,012    8.873518    .9984212          1          9
      side31 |      1,012    8.857708    1.057922          1          9
      side32 |      1,012    8.865613    1.028632          1          9
-------------+---------------------------------------------------------
      side33 |      1,012    8.881423    .9672024          1          9
      side34 |      1,012    8.857708    1.057922          1          9
      side35 |      1,012    8.873518    .9984212          1          9
      side36 |      1,012    8.881423    .9672024          1          9
      side37 |      1,012    8.897233    .9013191          1          9
-------------+---------------------------------------------------------
      side38 |      1,012    8.905138    .8663927          1          9
      side39 |      1,012    8.905138    .8663927          1          9
      side40 |      1,012    8.889328    .9348748          1          9
      side41 |      1,012    8.928854    .7514427          1          9
      side42 |      1,012    8.944664    .6633706          1          9
-------------+---------------------------------------------------------
      side43 |      1,012    8.944664    .6633706          1          9
      side44 |      1,012    8.960474     .561208          1          9
      side45 |      1,012    8.960474     .561208          1          9
      side46 |      1,012    8.960474     .561208          1          9
      side47 |      1,012    8.960474     .561208          1          9
-------------+---------------------------------------------------------
      side48 |      1,012    8.952569    .6144673          1          9
      side49 |      1,012    8.952569    .6144673          1          9
      side50 |      1,012    8.960474     .561208          1          9
      side51 |      1,012    8.960474     .561208          1          9
      side52 |      1,012    8.960474     .561208          1          9
-------------+---------------------------------------------------------
      side53 |      1,012    8.960474     .561208          1          9
      side54 |      1,012    8.976285    .4351414          1          9
      side55 |      1,012    8.976285    .4351414          1          9
      side56 |      1,012     8.98419    .3554674          1          9
      side57 |      1,012     8.98419    .3554674          1          9
-------------+---------------------------------------------------------
      side58 |      1,012    8.976285    .4351414          1          9
      side59 |      1,012    8.992095    .2514778          1          9
      side60 |      1,012    8.992095    .2514778          1          9
      side61 |      1,012    8.992095    .2514778          1          9
      side62 |      1,012     8.98419    .3554674          1          9
-------------+---------------------------------------------------------
      side63 |      1,012    8.992095    .2514778          1          9
      side64 |      1,012    8.992095    .2514778          1          9
      side65 |      1,012    8.992095    .2514778          1          9
      side66 |      1,012    8.992095    .2514778          1          9
      side67 |      1,012           9           0          9          9
-------------+---------------------------------------------------------
      side68 |      1,012           9           0          9          9
       fmw15 |      1,012           9           0          9          9
       fmw16 |      1,012           9           0          9          9
       fmw17 |      1,012           9           0          9          9
       fmw18 |      1,012     8.98419    .3554674          1          9
-------------+---------------------------------------------------------
       fmw19 |      1,012    8.913043    .8299225          1          9
       fmw20 |      1,012    8.905138    .8663927          1          9
       fmw21 |      1,012    8.849802    1.086365          1          9
       fmw22 |      1,012    8.826087    1.167221          1          9
       fmw23 |      1,012    8.786561    1.289805          1          9
-------------+---------------------------------------------------------
       fmw24 |      1,012     8.72332    1.462532          1          9
       fmw25 |      1,012    8.747036    1.400594          1          9
       fmw26 |      1,012    8.731225    1.442225          1          9
       fmw27 |      1,012    8.731225    1.442225          1          9
       fmw28 |      1,012    8.754941    1.379239          1          9
-------------+---------------------------------------------------------
       fmw29 |      1,012     8.73913    1.421584          1          9
       fmw30 |      1,012     8.72332    1.462532          1          9
       fmw31 |      1,012    8.715415    1.482519          1          9
       fmw32 |      1,012    8.699605    1.521582          1          9
       fmw33 |      1,012     8.70751    1.502198          1          9
-------------+---------------------------------------------------------
       fmw34 |      1,012     8.70751    1.502198          1          9
       fmw35 |      1,012     8.73913    1.421584          1          9
       fmw36 |      1,012    8.747036    1.400594          1          9
       fmw37 |      1,012    8.762846    1.357502          1          9
       fmw38 |      1,012    8.754941    1.379239          1          9
-------------+---------------------------------------------------------
       fmw39 |      1,012    8.754941    1.379239          1          9
       fmw40 |      1,012    8.731225    1.442225          1          9
       fmw41 |      1,012    8.778656    1.312806          1          9
       fmw42 |      1,012    8.770751    1.335365          1          9
       fmw43 |      1,012    8.802372    1.242375          1          9
-------------+---------------------------------------------------------
       fmw44 |      1,012    8.826087    1.167221          1          9
       fmw45 |      1,012    8.841897    1.114025          1          9
       fmw46 |      1,012    8.841897    1.114025          1          9
       fmw47 |      1,012    8.865613    1.028632          1          9
       fmw48 |      1,012    8.865613    1.028632          1          9
-------------+---------------------------------------------------------
       fmw49 |      1,012    8.873518    .9984212          1          9
       fmw50 |      1,012    8.873518    .9984212          1          9
       fmw51 |      1,012    8.897233    .9013191          1          9
       fmw52 |      1,012    8.905138    .8663927          1          9
       fmw53 |      1,012    8.913043    .8299225          1          9
-------------+---------------------------------------------------------
       fmw54 |      1,012    8.913043    .8299225          1          9
       fmw55 |      1,012    8.913043    .8299225          1          9
       fmw56 |      1,012    8.920949    .7916952          1          9
       fmw57 |      1,012    8.920949    .7916952          1          9
       fmw58 |      1,012    8.928854    .7514427          1          9
-------------+---------------------------------------------------------
       fmw59 |      1,012    8.928854    .7514427          1          9
       fmw60 |      1,012    8.936759    .7088201          1          9
       fmw61 |      1,012    8.960474     .561208          1          9
       fmw62 |      1,012    8.960474     .561208          1          9
       fmw63 |      1,012    8.960474     .561208          1          9
-------------+---------------------------------------------------------
       fmw64 |      1,012    8.976285    .4351414          1          9
       fmw65 |      1,012    8.976285    .4351414          1          9
       fmw66 |      1,012    8.992095    .2514778          1          9
       fmw67 |      1,012    8.992095    .2514778          1          9
       fmw68 |      1,012           9           0          9          9

. 
end of do-file
 replace id of principle 
(1,012 real changes made)
 make household head dummy  
(1,012 missing values generated)
(548 real changes made)
(464 real changes made)

                          Means of HH head dummy

           |       marital
      head |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
         6 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total | .49142857  .38461538 | .45849802
(1,012 missing values generated)
(421 real changes made)
(468 real changes made)
(544 real changes made)

                        Means of Breadwinner dummy

           |       marital
  earnmost |         1          2 |     Total
-----------+----------------------+----------
         1 |         1          1 |         1
         2 |         0          0 |         0
         3 |         0          0 |         0
         4 |         0          0 |         0
         5 |         0          0 |         0
        88 |         0          0 |         0
        99 |         0          0 |         0
-----------+----------------------+----------
     Total |       .48  .42307692 | .46245059

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |      1,012     27506.5    292.2835      27001      28012
          pri[1012,300]
 ** Rename variables of renameListSpo 
 rename variable of experience 

. *******************************************************
. *Title: Renamevar_Exp
. *Date: Oct 19th, 2018
. *Written by Ayaka Nakamura
. *
. *This file rename variables of working experience
. * 
. * 1. rename vars. of experience
. * 2. bind observations of principal and spouse
. ********************************************************
. 
. * set list of variables
. ** of principal
. local casPri $CasPri

. local fullPri $FullPri

. local selfPri $SelfPri

. local sidePri $SidePri

. local fmwPri $FmwPri

. ** of spouse
. local casSpo $CasSpo

. local fullSpo $FullSpo

. local selfSpo $SelfSpo

. local sideSpo $SideSpo

. local fmwSpo $FmwSpo

. 
. * 1. rename vars. of experience
. local empStatus cas full self side fmw

. local num_m: word count `empStatus'

. local resp_i $Resp_i

. local age_t $Age_t

. 
. if `resp_i'==1{
.         local expVar casPri fullPri selfPri sidePri fmwPri
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. else {
.         local expVar casSpo fullSpo selfSpo sideSpo fmwSpo
.         forvalues k=1/`num_m' {
  2.                 local renamelist: word `k' of `expVar'
  3.                 local currentEmpStatus: word `k' of `empStatus'
  4.                 rename ( ``renamelist'' ) ( `currentEmpStatus'# ), addnum(`a
> ge_t')
  5.         }
. }

. sum $ExpList

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       cas15 |      1,012    8.644269    .7495048          1          9
       cas16 |      1,012    8.596838    .9516033          1          9
       cas17 |      1,012    8.573123    1.037186          1          9
       cas18 |      1,012    8.517787    1.211828          1          9
       cas19 |      1,012    8.407115    1.495218          1          9
-------------+---------------------------------------------------------
       cas20 |      1,012    8.407115    1.495218          1          9
       cas21 |      1,012    8.296443    1.725777          1          9
       cas22 |      1,012    8.328063    1.663919          1          9
       cas23 |      1,012    8.256917     1.79933          1          9
       cas24 |      1,012    8.288538    1.740808          1          9
-------------+---------------------------------------------------------
       cas25 |      1,012    8.296443    1.725777          1          9
       cas26 |      1,012    8.343874    1.631882          1          9
       cas27 |      1,012    8.343874    1.631882          1          9
       cas28 |      1,012    8.375494    1.565362          1          9
       cas29 |      1,012    8.383399    1.548185          1          9
-------------+---------------------------------------------------------
       cas30 |      1,012    8.391304    1.530774          1          9
       cas31 |      1,012    8.407115    1.495218          1          9
       cas32 |      1,012    8.343874    1.631882          1          9
       cas33 |      1,012    8.296443    1.725777          1          9
       cas34 |      1,012    8.288538    1.740808          1          9
-------------+---------------------------------------------------------
       cas35 |      1,012    8.256917     1.79933          1          9
       cas36 |      1,012    8.217391    1.869156          1          9
       cas37 |      1,012    8.193676    1.909433          1          9
       cas38 |      1,012     8.12253    2.023797          1          9
       cas39 |      1,012    8.075099    2.095233          1          9
-------------+---------------------------------------------------------
       cas40 |      1,012    8.059289    2.118274          1          9
       cas41 |      1,012    8.106719    2.048008          1          9
       cas42 |      1,012    8.083004    2.083572          1          9
       cas43 |      1,012     8.12253    2.023797          1          9
       cas44 |      1,012    8.193676    1.909433          1          9
-------------+---------------------------------------------------------
       cas45 |      1,012    8.233202    1.841645          1          9
       cas46 |      1,012    8.288538    1.740808          1          9
       cas47 |      1,012    8.272727    1.770381          1          9
       cas48 |      1,012    8.288538    1.740808          1          9
       cas49 |      1,012    8.312253    1.695204          1          9
-------------+---------------------------------------------------------
       cas50 |      1,012    8.328063    1.663919          1          9
       cas51 |      1,012    8.375494    1.565362          1          9
       cas52 |      1,012    8.359684    1.599046          1          9
       cas53 |      1,012     8.41502    1.477056          1          9
       cas54 |      1,012    8.454545    1.381991          1          9
-------------+---------------------------------------------------------
       cas55 |      1,012    8.478261    1.321107          1          9
       cas56 |      1,012    8.517787    1.211828          1          9
       cas57 |      1,012    8.517787    1.211828          1          9
       cas58 |      1,012    8.533597    1.164874          1          9
       cas59 |      1,012    8.533597    1.164874          1          9
-------------+---------------------------------------------------------
       cas60 |      1,012    8.565217    1.064068          1          9
       cas61 |      1,012    8.501976    1.256829          1          9
       cas62 |      1,012    8.525692    1.188609          1          9
       cas63 |      1,012    8.541502     1.14059          1          9
       cas64 |      1,012    8.565217    1.064068          1          9
-------------+---------------------------------------------------------
       cas65 |      1,012    8.588933    .9810247          1          9
       cas66 |      1,012    8.612648     .889636          1          9
       cas67 |      1,012    8.628458     .822712          1          9
       cas68 |      1,012    8.652174    .7099444          1          9
      full15 |      1,012    8.478261    1.321107          1          9
-------------+---------------------------------------------------------
      full16 |      1,012    8.359684    1.599046          1          9
      full17 |      1,012    8.320158    1.679653          1          9
      full18 |      1,012     7.55336    2.707304          1          9
      full19 |      1,012    6.312253    3.483084          1          9
      full20 |      1,012     6.15415    3.538673          1          9
-------------+---------------------------------------------------------
      full21 |      1,012     5.55336    3.680907          1          9
      full22 |      1,012    5.371542    3.703702          1          9
      full23 |      1,012    4.881423    3.720419          1          9
      full24 |      1,012    4.810277    3.717467          1          9
      full25 |      1,012    4.905138    3.721099          1          9
-------------+---------------------------------------------------------
      full26 |      1,012    5.055336    3.721898          1          9
      full27 |      1,012    5.213439    3.716179          1          9
      full28 |      1,012    5.387352     3.70208          1          9
      full29 |      1,012    5.426877    3.697727          1          9
      full30 |      1,012     5.55336    3.680907          1          9
-------------+---------------------------------------------------------
      full31 |      1,012    5.711462    3.653616          1          9
      full32 |      1,012    5.766798    3.642393          1          9
      full33 |      1,012    5.940711    3.601357          1          9
      full34 |      1,012    6.043478    3.572907          1          9
      full35 |      1,012    6.106719    3.553808          1          9
-------------+---------------------------------------------------------
      full36 |      1,012    6.217391    3.517397          1          9
      full37 |      1,012    6.335968    3.474048          1          9
      full38 |      1,012     6.41502    3.442576          1          9
      full39 |      1,012    6.462451    3.422676          1          9
      full40 |      1,012    6.517787    3.398475          1          9
-------------+---------------------------------------------------------
      full41 |      1,012    6.628458    3.346803          1          9
      full42 |      1,012     6.70751    3.307131          1          9
      full43 |      1,012    6.786561    3.265062          1          9
      full44 |      1,012    6.857708    3.225073          1          9
      full45 |      1,012    6.913043    3.192528          1          9
-------------+---------------------------------------------------------
      full46 |      1,012     6.98419    3.148759          1          9
      full47 |      1,012    7.031621    3.118337          1          9
      full48 |      1,012    7.071146      3.0922          1          9
      full49 |      1,012    7.221344    2.986024          1          9
      full50 |      1,012     7.29249    2.931702          1          9
-------------+---------------------------------------------------------
      full51 |      1,012    7.332016     2.90033          1          9
      full52 |      1,012    7.387352    2.854909          1          9
      full53 |      1,012    7.442688    2.807662          1          9
      full54 |      1,012    7.466403    2.786831          1          9
      full55 |      1,012    7.513834     2.74408          1          9
-------------+---------------------------------------------------------
      full56 |      1,012    7.616601     2.64617          1          9
      full57 |      1,012    7.679842     2.58204          1          9
      full58 |      1,012    7.798419    2.452895          1          9
      full59 |      1,012    7.869565    2.369185          1          9
      full60 |      1,012    7.956522    2.259629          1          9
-------------+---------------------------------------------------------
      full61 |      1,012    8.320158    1.679653          1          9
      full62 |      1,012    8.359684    1.599046          1          9
      full63 |      1,012     8.44664    1.401609          1          9
      full64 |      1,012    8.517787    1.211828          1          9
      full65 |      1,012    8.549407    1.115722          1          9
-------------+---------------------------------------------------------
      full66 |      1,012    8.596838    .9516033          1          9
      full67 |      1,012    8.596838    .9516033          1          9
      full68 |      1,012    8.628458     .822712          1          9
      self15 |      1,012    8.675889    .5745094          1          9
      self16 |      1,012    8.675889    .5745094          1          9
-------------+---------------------------------------------------------
      self17 |      1,012    8.660079    .6679517          1          9
      self18 |      1,012    8.644269    .7495048          1          9
      self19 |      1,012    8.604743    .9211748          1          9
      self20 |      1,012    8.604743    .9211748          1          9
      self21 |      1,012    8.573123    1.037186          1          9
-------------+---------------------------------------------------------
      self22 |      1,012    8.541502     1.14059          1          9
      self23 |      1,012    8.509881    1.234559          1          9
      self24 |      1,012    8.462451    1.362045          1          9
      self25 |      1,012    8.454545    1.381991          1          9
      self26 |      1,012    8.438735    1.420913          1          9
-------------+---------------------------------------------------------
      self27 |      1,012    8.407115    1.495218          1          9
      self28 |      1,012    8.383399    1.548185          1          9
      self29 |      1,012    8.383399    1.548185          1          9
      self30 |      1,012    8.375494    1.565362          1          9
      self31 |      1,012    8.391304    1.530774          1          9
-------------+---------------------------------------------------------
      self32 |      1,012    8.375494    1.565362          1          9
      self33 |      1,012    8.351779    1.615567          1          9
      self34 |      1,012    8.335968    1.647998          1          9
      self35 |      1,012    8.296443    1.725777          1          9
      self36 |      1,012    8.296443    1.725777          1          9
-------------+---------------------------------------------------------
      self37 |      1,012    8.304348    1.710577          1          9
      self38 |      1,012    8.280632    1.755675          1          9
      self39 |      1,012    8.280632    1.755675          1          9
      self40 |      1,012    8.288538    1.740808          1          9
      self41 |      1,012    8.320158    1.679653          1          9
-------------+---------------------------------------------------------
      self42 |      1,012    8.335968    1.647998          1          9
      self43 |      1,012    8.320158    1.679653          1          9
      self44 |      1,012    8.320158    1.679653          1          9
      self45 |      1,012    8.320158    1.679653          1          9
      self46 |      1,012    8.328063    1.663919          1          9
-------------+---------------------------------------------------------
      self47 |      1,012    8.359684    1.599046          1          9
      self48 |      1,012    8.375494    1.565362          1          9
      self49 |      1,012    8.383399    1.548185          1          9
      self50 |      1,012    8.375494    1.565362          1          9
      self51 |      1,012    8.407115    1.495218          1          9
-------------+---------------------------------------------------------
      self52 |      1,012    8.422925    1.458624          1          9
      self53 |      1,012    8.438735    1.420913          1          9
      self54 |      1,012     8.44664    1.401609          1          9
      self55 |      1,012    8.454545    1.381991          1          9
      self56 |      1,012    8.478261    1.321107          1          9
-------------+---------------------------------------------------------
      self57 |      1,012    8.501976    1.256829          1          9
      self58 |      1,012    8.509881    1.234559          1          9
      self59 |      1,012    8.525692    1.188609          1          9
      self60 |      1,012    8.533597    1.164874          1          9
      self61 |      1,012    8.565217    1.064068          1          9
-------------+---------------------------------------------------------
      self62 |      1,012    8.581028    1.009527          1          9
      self63 |      1,012    8.596838    .9516033          1          9
      self64 |      1,012    8.612648     .889636          1          9
      self65 |      1,012    8.628458     .822712          1          9
      self66 |      1,012    8.644269    .7495048          1          9
-------------+---------------------------------------------------------
      self67 |      1,012    8.644269    .7495048          1          9
      self68 |      1,012    8.652174    .7099444          1          9
      side15 |      1,012      8.6917    .4620197          8          9
      side16 |      1,012      8.6917    .4620197          8          9
      side17 |      1,012      8.6917    .4620197          8          9
-------------+---------------------------------------------------------
      side18 |      1,012      8.6917    .4620197          8          9
      side19 |      1,012    8.683794    .5213676          1          9
      side20 |      1,012    8.683794    .5213676          1          9
      side21 |      1,012    8.683794    .5213676          1          9
      side22 |      1,012    8.675889    .5745094          1          9
-------------+---------------------------------------------------------
      side23 |      1,012    8.667984    .6230351          1          9
      side24 |      1,012    8.667984    .6230351          1          9
      side25 |      1,012    8.660079    .6679517          1          9
      side26 |      1,012    8.652174    .7099444          1          9
      side27 |      1,012    8.628458     .822712          1          9
-------------+---------------------------------------------------------
      side28 |      1,012    8.628458     .822712          1          9
      side29 |      1,012    8.628458     .822712          1          9
      side30 |      1,012    8.636364    .7869998          1          9
      side31 |      1,012    8.636364    .7869998          1          9
      side32 |      1,012    8.636364    .7869998          1          9
-------------+---------------------------------------------------------
      side33 |      1,012    8.652174    .7099444          1          9
      side34 |      1,012    8.652174    .7099444          1          9
      side35 |      1,012    8.644269    .7495048          1          9
      side36 |      1,012    8.652174    .7099444          1          9
      side37 |      1,012    8.652174    .7099444          1          9
-------------+---------------------------------------------------------
      side38 |      1,012    8.660079    .6679517          1          9
      side39 |      1,012    8.660079    .6679517          1          9
      side40 |      1,012    8.667984    .6230351          1          9
      side41 |      1,012    8.675889    .5745094          1          9
      side42 |      1,012    8.675889    .5745094          1          9
-------------+---------------------------------------------------------
      side43 |      1,012    8.675889    .5745094          1          9
      side44 |      1,012    8.675889    .5745094          1          9
      side45 |      1,012    8.675889    .5745094          1          9
      side46 |      1,012    8.683794    .5213676          1          9
      side47 |      1,012    8.675889    .5745094          1          9
-------------+---------------------------------------------------------
      side48 |      1,012    8.675889    .5745094          1          9
      side49 |      1,012    8.675889    .5745094          1          9
      side50 |      1,012    8.675889    .5745094          1          9
      side51 |      1,012    8.683794    .5213676          1          9
      side52 |      1,012    8.683794    .5213676          1          9
-------------+---------------------------------------------------------
      side53 |      1,012    8.683794    .5213676          1          9
      side54 |      1,012    8.683794    .5213676          1          9
      side55 |      1,012    8.683794    .5213676          1          9
      side56 |      1,012    8.683794    .5213676          1          9
      side57 |      1,012    8.683794    .5213676          1          9
-------------+---------------------------------------------------------
      side58 |      1,012    8.683794    .5213676          1          9
      side59 |      1,012      8.6917    .4620197          8          9
      side60 |      1,012      8.6917    .4620197          8          9
      side61 |      1,012      8.6917    .4620197          8          9
      side62 |      1,012      8.6917    .4620197          8          9
-------------+---------------------------------------------------------
      side63 |      1,012      8.6917    .4620197          8          9
      side64 |      1,012      8.6917    .4620197          8          9
      side65 |      1,012      8.6917    .4620197          8          9
      side66 |      1,012      8.6917    .4620197          8          9
      side67 |      1,012      8.6917    .4620197          8          9
-------------+---------------------------------------------------------
      side68 |      1,012      8.6917    .4620197          8          9
       fmw15 |      1,012      8.6917    .4620197          8          9
       fmw16 |      1,012      8.6917    .4620197          8          9
       fmw17 |      1,012      8.6917    .4620197          8          9
       fmw18 |      1,012      8.6917    .4620197          8          9
-------------+---------------------------------------------------------
       fmw19 |      1,012    8.667984    .6230351          1          9
       fmw20 |      1,012    8.660079    .6679517          1          9
       fmw21 |      1,012    8.628458     .822712          1          9
       fmw22 |      1,012    8.588933    .9810247          1          9
       fmw23 |      1,012    8.565217    1.064068          1          9
-------------+---------------------------------------------------------
       fmw24 |      1,012    8.509881    1.234559          1          9
       fmw25 |      1,012    8.494071    1.278663          1          9
       fmw26 |      1,012    8.478261    1.321107          1          9
       fmw27 |      1,012     8.44664    1.401609          1          9
       fmw28 |      1,012    8.422925    1.458624          1          9
-------------+---------------------------------------------------------
       fmw29 |      1,012    8.407115    1.495218          1          9
       fmw30 |      1,012    8.407115    1.495218          1          9
       fmw31 |      1,012     8.41502    1.477056          1          9
       fmw32 |      1,012    8.438735    1.420913          1          9
       fmw33 |      1,012    8.438735    1.420913          1          9
-------------+---------------------------------------------------------
       fmw34 |      1,012    8.422925    1.458624          1          9
       fmw35 |      1,012    8.422925    1.458624          1          9
       fmw36 |      1,012    8.438735    1.420913          1          9
       fmw37 |      1,012     8.41502    1.477056          1          9
       fmw38 |      1,012    8.422925    1.458624          1          9
-------------+---------------------------------------------------------
       fmw39 |      1,012    8.422925    1.458624          1          9
       fmw40 |      1,012     8.43083    1.439914          1          9
       fmw41 |      1,012    8.470356    1.341755          1          9
       fmw42 |      1,012    8.478261    1.321107          1          9
       fmw43 |      1,012    8.486166    1.300082          1          9
-------------+---------------------------------------------------------
       fmw44 |      1,012    8.509881    1.234559          1          9
       fmw45 |      1,012    8.517787    1.211828          1          9
       fmw46 |      1,012    8.517787    1.211828          1          9
       fmw47 |      1,012    8.525692    1.188609          1          9
       fmw48 |      1,012    8.533597    1.164874          1          9
-------------+---------------------------------------------------------
       fmw49 |      1,012    8.533597    1.164874          1          9
       fmw50 |      1,012    8.541502     1.14059          1          9
       fmw51 |      1,012    8.541502     1.14059          1          9
       fmw52 |      1,012    8.549407    1.115722          1          9
       fmw53 |      1,012    8.565217    1.064068          1          9
-------------+---------------------------------------------------------
       fmw54 |      1,012    8.581028    1.009527          1          9
       fmw55 |      1,012    8.588933    .9810247          1          9
       fmw56 |      1,012    8.596838    .9516033          1          9
       fmw57 |      1,012    8.604743    .9211748          1          9
       fmw58 |      1,012    8.612648     .889636          1          9
-------------+---------------------------------------------------------
       fmw59 |      1,012    8.612648     .889636          1          9
       fmw60 |      1,012    8.644269    .7495048          1          9
       fmw61 |      1,012    8.644269    .7495048          1          9
       fmw62 |      1,012    8.652174    .7099444          1          9
       fmw63 |      1,012    8.667984    .6230351          1          9
-------------+---------------------------------------------------------
       fmw64 |      1,012    8.683794    .5213676          1          9
       fmw65 |      1,012      8.6917    .4620197          8          9
       fmw66 |      1,012      8.6917    .4620197          8          9
       fmw67 |      1,012      8.6917    .4620197          8          9
       fmw68 |      1,012      8.6917    .4620197          8          9

. 
end of do-file
 replace id of spouse and drop not married 
variable id was int now long
(1,012 real changes made)
(312 observations deleted)
  700
 make household head dummy  
(700 missing values generated)
(379 real changes made)
(321 real changes made)

                          Means of HH head dummy

           |  marital
      head |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
         6 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .45857143 | .45857143
(700 missing values generated)
(277 real changes made)
(20 real changes made)
(680 real changes made)

                        Means of Breadwinner dummy

           |  marital
  earnmost |         1 |     Total
-----------+-----------+----------
         1 |         0 |         0
         2 |         1 |         1
         3 |         0 |         0
         4 |         0 |         0
         5 |         0 |         0
        88 |         0 |         0
        99 |         0 |         0
-----------+-----------+----------
     Total | .02857143 | .02857143

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          id |        700     37350.5    202.2169      37001      37700
          spo[700,300]
          pri[1012,300]

. 
. 
. * 2. bind observations of principal and spouse
. mat ps = pri \ spo

. mat dir
           ps[1712,300]
          spo[700,300]
          pri[1012,300]

. 
. ** save matrix as dta
. drop _all

. svmat double ps, name(col)
number of observations will be reset to 1712
Press any key to continue, or Break to abort
number of observations (_N) was 0, now 1,712

. qui sum

. save "$Inter/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPSnew2012.dta saved

. mat drop _all

. 
end of do-file

. tab sex   /* Check that data are read correctly */

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        867       50.64       50.64
          2 |        845       49.36      100.00
------------+-----------------------------------
      Total |      1,712      100.00

. 
. 
. * 2. Generate main variables
. ** Survey year & month
. ge year=`SvyY'

. sum year /* check that correct variable are generated */

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      1,712        2012           0       2012       2012

. ge month = 1

. gen svyym=ym(year, month) /* date and time function */

. /* format of the survey date = 1, SvyY */
. format svyym %tmM,_CY

. qui sum

. /* comfirm: min and max of the survey date -> must be SvyY/1 */
. disp %tm r(min)
 2012m1

. disp %tm r(max)
 2012m1

. 
. ** Age
. /* Recode missing values */
. mvdecode byear, mv(9999)
       byear: 5 missing values generated

. mvdecode bmonth, mv(99)
      bmonth: 5 missing values generated

. sum byear

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       byear |      1,707    1964.589    13.64083       1927       1992

. gen bym=ym(byear, bmonth)
(5 missing values generated)

. format bym %tmM,_CY

. qui sum bym

. disp %tm r(min)
 1927m3

. disp %tm r(max)
 1992m1

. 
. ge age = floor((svyym-bym)/12) /* Assumed birth day is 1st. */
(5 missing values generated)

. sum age, de

                             age
-------------------------------------------------------------
      Percentiles      Smallest
 1%           20             20
 5%           24             20
10%           28             20       Obs               1,707
25%           36             20       Sum of Wgt.       1,707

50%           46                      Mean            46.5126
                        Largest       Std. Dev.      13.64713
75%           59             78
90%           64             78       Variance       186.2441
95%           68             83       Skewness      -.0153037
99%           71             84       Kurtosis        2.00825

. 
. ** Initial working experience and employer tenure
. /// The first year survey creates variables from responses
> /// and creates missing values ​​for other years 
> local isInitialExp "`currentData'`SvyY'"=="JHPS2010" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** working experience
. if "`isInitialExp'"{
.         /* construct initial workexp for initial survey year */
.         **** recode missing value (9) to 0 for each employment status
.         local empStatus cas full self side fmw
.         local num_m: word count `empStatus'
.         dis " recode missing value (9) to 0 for each employment status "
 recode missing value (9) to 0 for each employment status 
.         qui forvalues status_j = 1/`num_m'{
.         
.         **** make experience dummy in each year
.         /// experience of that year takes 1
>         /// if individual takes 1 in at least one employment status that year
>         local age_t $Age_t
.         qui forvalues x=`age_t'/65{
.         qui forvalues x=`age_t'/65{
.         sum we*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        we15 |      1,712     .041472    .1994374          0          1
        we16 |      1,712    .0671729    .2503943          0          1
        we17 |      1,712    .0899533    .2861984          0          1
        we18 |      1,712    .2295561    .4206702          0          1
        we19 |      1,712    .4731308    .4994234          0          1
-------------+---------------------------------------------------------
        we20 |      1,712    .5186916    .4997965          0          1
        we21 |      1,712    .6524533    .4763303          0          1
        we22 |      1,712    .7021028    .4574677          0          1
        we23 |      1,712    .7955607    .4034091          0          1
        we24 |      1,712     .807243    .3945791          0          1
-------------+---------------------------------------------------------
        we25 |      1,712    .7955607    .4034091          0          1
        we26 |      1,712    .7721963    .4195378          0          1
        we27 |      1,712    .7418224      .43776          0          1
        we28 |      1,712    .7190421    .4495983          0          1
        we29 |      1,712    .7038551    .4566891          0          1
-------------+---------------------------------------------------------
        we30 |      1,712    .6775701    .4675431          0          1
        we31 |      1,712    .6507009    .4768879          0          1
        we32 |      1,712    .6401869    .4800857          0          1
        we33 |      1,712    .6238318    .4845646          0          1
        we34 |      1,712    .6156542    .4865824          0          1
-------------+---------------------------------------------------------
        we35 |      1,712    .6098131    .4879346          0          1
        we36 |      1,712    .5998832    .4900649          0          1
        we37 |      1,712    .5776869    .4940722          0          1
        we38 |      1,712    .5695093    .4952896          0          1
        we39 |      1,712    .5613318    .4963691          0          1
-------------+---------------------------------------------------------
        we40 |      1,712    .5543224    .4971855          0          1
        we41 |      1,712    .5204439    .4997278          0          1
        we42 |      1,712    .5064252    .5001048          0          1
        we43 |      1,712    .4889019    .5000229          0          1
        we44 |      1,712    .4661215    .4989967          0          1
-------------+---------------------------------------------------------
        we45 |      1,712    .4503505    .4976742          0          1
        we46 |      1,712    .4293224    .4951241          0          1
        we47 |      1,712    .4182243    .4934115          0          1
        we48 |      1,712    .4030374    .4906515          0          1
        we49 |      1,712    .3773364    .4848618          0          1
-------------+---------------------------------------------------------
        we50 |      1,712    .3650701    .4815905          0          1
        we51 |      1,712    .3481308    .4765169          0          1
        we52 |      1,712    .3311916    .4707793          0          1
        we53 |      1,712    .3089953    .4622142          0          1
        we54 |      1,712    .2885514    .4532212          0          1
-------------+---------------------------------------------------------
        we55 |      1,712    .2686916    .4434087          0          1
        we56 |      1,712    .2459112     .430752          0          1
        we57 |      1,712    .2307243    .4214194          0          1
        we58 |      1,712    .2108645    .4080416          0          1
        we59 |      1,712    .1915888    .3936662          0          1
-------------+---------------------------------------------------------
        we60 |      1,712     .171729    .3772549          0          1
        we61 |      1,712    .1185748    .3233819          0          1
        we62 |      1,712     .098715    .2983661          0          1
        we63 |      1,712    .0735981    .2611921          0          1
        we64 |      1,712    .0584112    .2345879          0          1
-------------+---------------------------------------------------------
        we65 |      1,712    .0438084    .2047284          0          1
.         
.         **** total experience dummy to make workexp
.         egen workexp=rowtotal(we`age_t'-we65)
.         sum workexp, de

                           workexp
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            2              0
10%            5              0       Obs               1,712
25%           10              0       Sum of Wgt.       1,712

50%         20.5                      Mean           22.20502
                        Largest       Std. Dev.      13.83444
75%           34             51
90%           42             51       Variance       191.3916
95%           45             51       Skewness       .2503946
99%           50             51       Kurtosis        1.94168
.         drop cas* full* self* side* fmw* we*
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge workexp=.
.         sum workexp
.         }

. 
. 
. local isInitialEmp "`currentData'`SvyY'"=="JHPS2009" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPS2004" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2007" | ///
>                                                                 "`currentData'`
> SvyY'"=="KHPSnew2012"

. *** employer tenure
. if "`isInitialEmp'"{
.         /* construct initial emptenure for initial survey year */
.         **** recode missing value
.         foreach x of num 8888 9999{
  2.                 mvdecode empsinceyear, mv(`x')
  3.         }
empsinceyear: 445 missing values generated
empsinceyear: 57 missing values generated
.         foreach x of num 88 99{
  2.                 mvdecode empsincemonth, mv(`x')
  3.         }
empsincemo~h: 445 missing values generated
empsincemo~h: 81 missing values generated
.         
.         **** initial employer tenure
.         gen empym=ym(empsinceyear,empsincemonth)
(526 missing values generated)
.         format empym %tmM,_CY
.         label var empym "Employment start year, month"
.         qui sum empym
.         disp %tm r(min)
 1959m4
.         disp %tm r(max)
 2012m2
.         
.         gen emptenure=(svyym-empym)
(526 missing values generated)
.         label var emptenure "Tenure months" 
.         sum emptenure, de

                        Tenure months
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0             -1
 5%            5             -1
10%           11              0       Obs               1,186
25%           41              0       Sum of Wgt.       1,186

50%        110.5                      Mean           151.1383
                        Largest       Std. Dev.      136.3495
75%          238            549
90%          368            561       Variance       18591.19
95%          426            621       Skewness       .9560924
99%          525            633       Kurtosis       3.058022
.         
.         **** generate switch dummy
.         gen switch=0
. }

. else { 
.         /* making missing value for years other than initial year */
.         ge emptenure=.
.         sum emptenure
.         }

.         
. 
. * Save Data
. save "`inter'/`currentData'`SvyY'.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate/KHPSnew2012.dta saved

. 
. *}
. 
end of do-file

. 
. ***** ***** ***** ***** ***** ***** kokokara ***** ***** ***** ***** ***** ****
> * 
. * 2: Bind data of the all years
. use "$Inter\JHPS2009.dta",  clear

. *** JHPS
. forvalues year_t = 2010/2014{
  2.         append using "$Inter\JHPS`year_t'.dta"
  3. }
(note: variable switch was float, now double to accommodate using data's
       values)

. *** KHPS
. forvalues year_t = 2004/2014{
  2.         append using "$Inter\KHPS`year_t'.dta"
  3. }

. *** new cohort
. foreach year_t of num 2007 2012{
  2.         append using "$Inter\KHPSnew`year_t'.dta"
  3. }

. 
. qui sum

. save "$Inter\JHPSKHPS_2004_2014.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate\JHPSKHPS_2004_2014.dta saved

. 
. * 3: Merge schooling and clean data
. do "$Path\Code\MergeSchooling.do"

. *******************************************************
. *Title: MergeVar
. *Date: Oct 24th, 2018
. *Written by Ayaka Nakamura
. * 
. * This file merges schooling
. * 
. * 1. Select id, schooling from initial survey
. * 2. Merge 1 to other survey years
. ********************************************************
. 
. * Define folder location
. local path $Path

. local original $Original

. local input $Input

. local output $Output

. local inter $Inter

. disp "`path', `original', `input', `output', `inter' "
C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion, C:\User
> s\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\OriginalData,
>  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Input
> , C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Outp
> ut, C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\In
> termediate 

. 
. 
. * 1. Select id, schooling from initial survey
. ** schooling
. local schoolingData JHPS2009 KHPS2004 KHPSnew2007 KHPSnew2012

. local num_k: word count `schoolingData'

. 
. forvalues data_i = 1/`num_k' { /* loop within data set */
  2.         local currentSchoolingData: word `data_i' of `schoolingData'
  3.         use "`inter'/`currentSchoolingData'.dta", clear
  4.         keep id edbg
  5.         *** save data
.         qui sum
  6.         save "$Inter\Schooling`currentSchoolingData'.dta", replace
  7. }
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate\SchoolingJHPS2009.dta saved
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate\SchoolingKHPS2004.dta saved
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate\SchoolingKHPSnew2007.dta saved
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate\SchoolingKHPSnew2012.dta saved

. 
. *** bind all data
. use "`inter'/SchoolingJHPS2009.dta", clear

. forvalues data_i = 2/`num_k' { /* loop within data set */
  2.         local currentSchoolingData: word `data_i' of `schoolingData'
  3.         append using "`inter'/Schooling`currentSchoolingData'.dta"
  4. }

. sort id

. 
. *** recod missing variable and make schooling dummies
. foreach x of num 9 99 {
  2.         mvdecode edbg, mv(`x')
  3. }
        edbg: 86 missing values generated
        edbg: 28 missing values generated

. gen schooling=9 if edbg==1
(16,465 missing values generated)

. replace schooling=12 if edbg==2
(9,798 real changes made)

. replace schooling=14 if edbg==3 | edbg==6
(2,915 real changes made)

. replace schooling=16 if edbg==4 | edbg==5
(3,607 real changes made)

. tab edbg schooling

           |                  schooling
      edbg |         9         12         14         16 |     Total
-----------+--------------------------------------------+----------
         1 |     1,544          0          0          0 |     1,544 
         2 |         0      9,798          0          0 |     9,798 
         3 |         0          0      2,127          0 |     2,127 
         4 |         0          0          0      3,372 |     3,372 
         5 |         0          0          0        235 |       235 
         6 |         0          0        788          0 |       788 
-----------+--------------------------------------------+----------
     Total |     1,544      9,798      2,915      3,607 |    17,864 


. keep id schooling

. save "`inter'\Schooling.dta", replace
file C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submittion\Int
> ermediate\Schooling.dta saved

. 
. 
. * 2. Merge 1 to other survey years
. use "`inter'\JHPSKHPS_2004_2014.dta", clear

. 
. ** merge schooling using id
. merge m:1 id using "`inter'\Schooling.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                         1,311
        from master                     1,311  (_merge==1)
        from using                          0  (_merge==2)

    matched                            96,587  (_merge==3)
    -----------------------------------------

. drop _merge

. 
. 
. * 3. Recode missing values and make dummy variables
. {
. *marital
. gen dmarital=marital
. replace dmarital=0 if marital==2
(13,944 real changes made)
. tab marital dmarital

           |       dmarital
   marital |         0          1 |     Total
-----------+----------------------+----------
         1 |         0     83,954 |    83,954 
         2 |    13,944          0 |    13,944 
-----------+----------------------+----------
     Total |    13,944     83,954 |    97,898 

. 
. *empstlmonth /* Employment situation of last month 0=Not working/1=Worked */
. mvdecode workstatus, mv(9)
  workstatus: 572 missing values generated
. gen dworkstatus=workstatus
(572 missing values generated)
. replace dworkstatus=1 if workstatus<=3
(13,469 real changes made)
. replace dworkstatus=0 if workstatus>3
(30,416 real changes made)
. tab workstatus dworkstatus

           |      dworkstatus
workstatus |         0          1 |     Total
-----------+----------------------+----------
         1 |         0     54,013 |    54,013 
         2 |         0        444 |       444 
         3 |         0     13,025 |    13,025 
         4 |     1,646          0 |     1,646 
         5 |     1,790          0 |     1,790 
         6 |    26,408          0 |    26,408 
-----------+----------------------+----------
     Total |    29,844     67,482 |    97,326 

. 
. *occ
. foreach x of num 88 99 {
  2.         mvdecode occ, mv(`x')
  3. }
         occ: 28771 missing values generated
         occ: 1333 missing values generated
. sum occ

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         occ |     67,794    6.328038     2.68772          1         12
. 
. *owner
. foreach x of num 8 9 {
  2.         mvdecode owner, mv(`x')
  3. }
       owner: 28771 missing values generated
       owner: 1227 missing values generated
. tab owner

      owner |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     20,682       30.46       30.46
          2 |     35,248       51.91       82.37
          3 |      6,549        9.65       92.02
          4 |      5,421        7.98      100.00
------------+-----------------------------------
      Total |     67,900      100.00
. 
. *ind
. foreach x of num 88 99 {
  2.         mvdecode ind, mv(`x')
  3. }
         ind: 28490 missing values generated
         ind: 935 missing values generated
. sum ind

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         ind |     68,473    9.381201    4.843077          1         18
. 
. *size
. ** 1=1~4, 2=5~29, 3=30~99, 4=100~499, 5=500~, 6: government
. ** large firm=500~, mediam firm=100~499, small firm=~99
. foreach x of num 8 9 88 99 {
  2.         mvdecode size, mv(`x')
  3. }
        size: 27434 missing values generated
        size: 1510 missing values generated
. gen dsize=size
(30,974 missing values generated)
. replace dsize=0 if size<4
(37,878 real changes made)
. replace dsize=1 if size==4
(11,181 real changes made)
. replace dsize=2 if size>4
(48,839 real changes made)
. tab size dsize

           |              dsize
      size |         0          1          2 |     Total
-----------+---------------------------------+----------
         1 |    16,968          0          0 |    16,968 
         2 |    12,392          0          0 |    12,392 
         3 |     8,518          0          0 |     8,518 
         4 |         0     11,181          0 |    11,181 
         5 |         0          0     14,035 |    14,035 
         6 |         0          0      3,830 |     3,830 
-----------+---------------------------------+----------
     Total |    37,878     11,181     17,865 |    66,924 

. 
. *switch
. foreach x of num 88 99 {
  2.         mvdecode switch, mv(`x')
  3. }
      switch: 1757 missing values generated
. gen dswitch=switch
(1,757 missing values generated)
. replace dswitch=0 if switch<=3 | switch>=7
(73,124 real changes made)
. replace dswitch=1 if switch>=4&switch<=6
(6,765 real changes made)
. tab switch dswitch

           |        dswitch
    switch |         0          1 |     Total
-----------+----------------------+----------
         0 |    18,009          0 |    18,009 
         1 |    48,116          0 |    48,116 
         2 |     2,056          0 |     2,056 
         3 |       259          0 |       259 
         4 |         0      2,443 |     2,443 
         5 |         0      2,146 |     2,146 
         6 |         0      2,176 |     2,176 
         7 |       373          0 |       373 
         8 |    20,563          0 |    20,563 
-----------+----------------------+----------
     Total |    89,376      6,765 |    96,141 

. 
. *employed
. foreach x of num 8 9 {
  2.         mvdecode employed, mv(`x')
  3. }
    employed: 28774 missing values generated
    employed: 871 missing values generated
. gen demployed=employed
(29,645 missing values generated)
. replace demployed=0 if employed<=4 | employed>=6
(46,736 real changes made)
. replace demployed=1 if employed==5
(51,162 real changes made)
. tab employed demployed

           |       demployed
  employed |         0          1 |     Total
-----------+----------------------+----------
         1 |     8,828          0 |     8,828 
         2 |     1,059          0 |     1,059 
         3 |     4,003          0 |     4,003 
         4 |       656          0 |       656 
         5 |         0     51,162 |    51,162 
         6 |     2,513          0 |     2,513 
         7 |        32          0 |        32 
-----------+----------------------+----------
     Total |    17,091     51,162 |    68,253 

. 
. *regular /* 0=non-regular/1=regular */
. foreach x of num 8 9 {
  2.         mvdecode regular, mv(`x')
  3. }
     regular: 46723 missing values generated
     regular: 914 missing values generated
. gen dregular=regular
(47,637 missing values generated)
. replace dregular=0 if regular>=4 & regular!=.
(18,134 real changes made)
. replace dregular=1 if regular<=3 & regular!=.
(13,287 real changes made)
. tab regular dregular

           |       dregular
   regular |         0          1 |     Total
-----------+----------------------+----------
         1 |         0     18,840 |    18,840 
         2 |         0     12,522 |    12,522 
         3 |         0        765 |       765 
         4 |     2,876          0 |     2,876 
         5 |    13,200          0 |    13,200 
         6 |       780          0 |       780 
         7 |     1,278          0 |     1,278 
-----------+----------------------+----------
     Total |    18,134     32,127 |    50,261 

. 
. *union
. foreach x of num 8 9 {
  2.         mvdecode union, mv(`x')
  3. }
       union: 28772 missing values generated
       union: 3831 missing values generated
. gen dunion=union
(32,603 missing values generated)
. replace dunion=0 if union<=2 | union==5
(53,277 real changes made)
. replace dunion=1 if union==3 | union==4
(12,018 real changes made)
. tab union dunion

           |        dunion
     union |         0          1 |     Total
-----------+----------------------+----------
         1 |    32,293          0 |    32,293 
         2 |     8,591          0 |     8,591 
         3 |         0     11,671 |    11,671 
         4 |         0        347 |       347 
         5 |    12,393          0 |    12,393 
-----------+----------------------+----------
     Total |    53,277     12,018 |    65,295 

. 
. *paymethod
. foreach x of num 8 9 {
  2.         mvdecode paymethod, mv(`x')
  3. }
   paymethod: 28773 missing values generated
   paymethod: 5081 missing values generated
. tab paymethod

  paymethod |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     44,761       69.89       69.89
          2 |         96        0.15       70.04
          3 |      3,465        5.41       75.45
          4 |     12,136       18.95       94.40
          5 |      3,586        5.60      100.00
------------+-----------------------------------
      Total |     64,044      100.00
. 
. *monthlypaid
. foreach x of num 88888 99999 {
  2.         mvdecode monthlypaid, mv(`x')
  3. }
 monthlypaid: 53040 missing values generated
 monthlypaid: 1327 missing values generated
. sum monthlypaid

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
 monthlypaid |     43,531    304.2767     213.203          0       8000
. 
. *dailypaid
. foreach x of num 888888 999999 {
  2.         mvdecode dailypaid, mv(`x')
  3. }
   dailypaid: 94432 missing values generated
   dailypaid: 95 missing values generated
. sum dailypaid

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   dailypaid |      3,371    10161.09    4883.396        320      60000
. 
. *hourlypaid
. foreach x of num 888888 999999 {
  2.         mvdecode hourlypaid, mv(`x')
  3. }
  hourlypaid: 85761 missing values generated
  hourlypaid: 109 missing values generated
. sum hourlypaid

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  hourlypaid |     12,028    964.8848    619.5942        100      30000
. 
. *yearlypaid
. foreach x of num 88888 99999 {
  2.         mvdecode yearlypaid, mv(`x')
  3. }
  yearlypaid: 94311 missing values generated
  yearlypaid: 190 missing values generated
. sum yearlypaid

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  yearlypaid |      3,397    498.4722    442.7743          0       4700
. 
. *bonus
. foreach x of num 88888 99999 {
  2.         mvdecode bonus, mv(`x')
  3. }
       bonus: 28774 missing values generated
       bonus: 4992 missing values generated
. sum bonus

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       bonus |     64,132     46.0341    78.05327          0       2100
. 
. *workdaypermonth
. foreach x of num 88 99 {
  2.         mvdecode workdaypermonth, mv(`x')
  3. }
workdayper~h: 28773 missing values generated
workdayper~h: 3396 missing values generated
. sum workdaypermonth

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
workdayper~h |     65,729    20.35677    5.358794          1         31
. 
. *workhourperweek
. foreach x of num 888 999 {
  2.         mvdecode workhourperweek, mv(`x')
  3. }
workhourpe~k: 28773 missing values generated
workhourpe~k: 5192 missing values generated
. sum workhourperweek

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
workhourpe~k |     63,933    38.96346    19.37424          1        700
. 
. *overworkperweek
. foreach x of num 888 999 {
  2.         mvdecode overworkperweek, mv(`x')
  3. }
overworkpe~k: 28773 missing values generated
overworkpe~k: 22997 missing values generated
. }

. 
. ** constract real hourly wage
. {
. *** annual working hour = workhourperweek*52
. gen workinghour=workhourperweek*52
(33,965 missing values generated)
. sum workinghour, de

                         workinghour
-------------------------------------------------------------
      Percentiles      Smallest
 1%          156             52
 5%          364             52
10%          520             52       Obs              63,933
25%         1300             52       Sum of Wgt.      63,933

50%         2080                      Mean             2026.1
                        Largest       Std. Dev.       1007.46
75%         2600           7800
90%         3120           8320       Variance        1014976
95%         3640          10400       Skewness       .8782321
99%         4680          36400       Kurtosis       25.03359
. 
. *** working 800 hours or more dummy
. gen morethan800=0 if workinghour<800|workinghour==.
(54,081 missing values generated)
. replace morethan800=1 if morethan800==.
(54,081 real changes made)
. sum morethan800

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
 morethan800 |     97,898    .5524219    .4972469          0          1
. tab morethan800, sum(workinghour) miss

            |       Summary of workinghour
morethan800 |        Mean   Std. Dev.       Freq.
------------+------------------------------------
          0 |   454.05522   183.99402       9,852
          1 |   2312.4813   813.31667      54,081
------------+------------------------------------
      Total |      2026.1   1007.4602      63,933
. 
. *** adjust the unit of wage data (yen)
. gen omonthlypaid=monthlypaid
(54,367 missing values generated)
. gen obonus=bonus
(33,766 missing values generated)
. gen oyearlypaid=yearlypaid
(94,501 missing values generated)
. replace monthlypaid=omonthlypaid*1000
(43,528 real changes made)
. replace bonus=obonus*10000
(31,604 real changes made)
. replace oyearlypaid=oyearlypaid*10000
(3,391 real changes made)
. sum monthlypaid omonthlypaid

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
 monthlypaid |     43,531    304276.7      213203          0    8000000
omonthlypaid |     43,531    304.2767     213.203          0       8000
. sum bonus obonus

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       bonus |     64,132      460341    780532.7          0   2.10e+07
      obonus |     64,132     46.0341    78.05327          0       2100
. sum yearlypaid oyearlypaid

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  yearlypaid |      3,397    498.4722    442.7743          0       4700
 oyearlypaid |      3,397     4984722     4427743          0   4.70e+07
. 
. ** annual income according to the pay method
. gen annualIncome=0
. *** monthly: monthlypaid*12+bonus
. replace annualIncome=monthlypaid*12+bonus if paymethod==1|paymethod==2
(44,854 real changes made, 2,361 to missing)
. sum annualIncome if paymethod==1|paymethod==2

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
annualIncome |     42,496     4307307     3030942          0   9.60e+07
. *** daily: dailypaid*workdaypermonth*12+bonus
. replace annualIncome=dailypaid*workdaypermonth*12+bonus if paymethod==3
(3,465 real changes made, 263 to missing)
. sum annualIncome if paymethod==3

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
annualIncome |      3,202     2472630     1487597      12000   1.80e+07
. *** hourly: hourlypaid*workhourperweek*52+bonus
. replace annualIncome=hourlypaid*workinghour+bonus if paymethod==4
(12,136 real changes made, 700 to missing)
. sum annualIncome if paymethod==4

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
annualIncome |     11,436     1248178    957946.8      31200   2.73e+07
. *** yearly: yearlypaid+bonus
. replace annualIncome=yearlypaid+bonus if paymethod==5
(3,580 real changes made, 396 to missing)
. sum annualIncome if paymethod==5

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
annualIncome |      3,190    255885.7    847404.1          0   1.20e+07
. *** unknown method: missing value
. replace annualIncome=. if paymethod==.
(33,854 real changes made, 33,854 to missing)
. misstable sum annualIncome paymethod
                                                               Obs<.
                                                +------------------------------
               |                                | Unique
      Variable |     Obs=.     Obs>.     Obs<.  | values        Min         Max
  -------------+--------------------------------+------------------------------
  annualIncome |    37,574              60,324  |   >500          0    9.60e+07
     paymethod |    33,854              64,044  |      5          1           5
  -----------------------------------------------------------------------------
. sum annualIncome, de

                        annualIncome
-------------------------------------------------------------
      Percentiles      Smallest
 1%          120              0
 5%       140400              0
10%       576000              0       Obs              60,324
25%      1179800              0       Sum of Wgt.      60,324

50%      2810000                      Mean            3415740
                        Largest       Std. Dev.       2970998
75%      4800000       6.00e+07
90%      7120000       6.14e+07       Variance       8.83e+12
95%      8600000       9.60e+07       Skewness       3.283218
99%     1.20e+07       9.60e+07       Kurtosis       51.97119
. 
. ** hourly wage: annualIncome/workinghour
. gen hourlywage=annualIncome/workinghour
(39,836 missing values generated)
. sum hourlywage, de

                         hourlywage
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0801282              0
 5%     230.7692              0
10%          620              0       Obs              58,062
25%          850              0       Sum of Wgt.      58,062

50%     1302.378                      Mean           2013.652
                        Largest       Std. Dev.      3100.487
75%     2263.736       115384.6
90%     3685.897         150000       Variance        9613019
95%     5538.461       164835.2       Skewness       18.93743
99%     13076.92       230769.2       Kurtosis       882.3999
. 
. ** Realize hourly wage + merge unemployment rate and inflation rate
. local inter $Inter
. gen realwage=0
. merge m:1 year using "`inter'\InflateUnempRate.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                            97,898  (_merge==3)
    -----------------------------------------
. replace realwage=hourlywage/infrate*100
(97,889 real changes made, 39,836 to missing)
. sum realwage hourlywage annualIncome

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    realwage |     58,062     2000.96    3077.249          0   229121.8
  hourlywage |     58,062    2013.652    3100.487          0   230769.2
annualIncome |     60,324     3415740     2970998          0   9.60e+07
. drop if _merge==2
(0 observations deleted)
. drop _merge lagunemprate infrate
. 
. *** make missing value if realwage is less than Y250/h
. replace realwage=. if realwage<250
(2,993 real changes made, 2,993 to missing)
. sum realwage, de

                          realwage
-------------------------------------------------------------
      Percentiles      Smallest
 1%     370.2712       250.7975
 5%      615.157       251.1216
10%     718.6957       251.2786       Obs              55,069
25%     892.3003       251.9965       Sum of Wgt.      55,069

50%     1373.321                      Mean           2108.137
                        Largest       Std. Dev.      3124.267
75%     2307.508       114908.9
90%     3760.567       145934.3       Variance        9761042
95%     5728.046       163634.1       Skewness       18.90461
99%      13336.8       229121.8       Kurtosis       867.3061
. *** Logarize real hourly wage
. gen orealwage=realwage
(42,829 missing values generated)
. replace realwage=log(orealwage)
(55,069 real changes made)
. sum orealwage realwage

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   orealwage |     55,069    2108.137    3124.267   250.7975   229121.8
    realwage |     55,069    7.324788    .7174717   5.524646   12.34201
. }

. 
. 
end of do-file

. log close 
      name:  <unnamed>
       log:  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submit
> tion\Log\DataCleaning.log
  log type:  text
 closed on:  29 Oct 2018, 14:50:41
---------------------------------------------------------------------------------
