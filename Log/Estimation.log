---------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Submit
> tion\Log\Estimation.log
  log type:  text
 opened on:   8 Nov 2018, 00:06:07

. /*
> 
> 
> 
> * 1. OLS->AS / 1-4 dimenational polynomial
> {
> ** OLS
> *** reading data
> do "$Code\ReadData.do"
> 
> foreach ten_i of local isIncOcc{
>         forvalues poly_x=1/4{
>                 dis "/* OLS `ten_i' `poly_x'th order */"
>                 reg ///
>                                 `commonVar' ///
>                                 ``ten_i'`poly_x'' ///
>                                 , vce(r)
>                 est sto ols`ten_i'`poly_x'
>         }
> }
> 
> ** AS
> foreach ten_i of local isIncOcc{
>         forvalues poly_x=1/4{
>                 qui {
>                         do "$Code\ReadData.do"
>                         do "$Code\ConstructIV.do"
>                         ivregress 2sls ///
>                                                 `commonVar' ///
>                                                 (``ten_i'`poly_x'' = ``ten_i'iv
> `poly_x'') ///
>                                                 , vce(r)
>                         est sto isv`ten_i'`poly_x'
>                         drop if _est_isv`ten_i'`poly_x'==0
>                         drop *iv *iv? avg*
>                         **** re-build iv
>                         do "$Code\ConstructIV.do"
>                 }
>                 dis "/* AS's IV `ten_i' `poly_x'th order */"
>                 ivregress 2sls ///
>                                 `commonVar' ///
>                                 (``ten_i'`poly_x'' = ``ten_i'iv`poly_x'') ///
>                                 , vce(r)
>                 est sto isv`ten_i'`poly_x'
>         }
> }
> 
> ** culc. return
> qui{
>         local culcemp1 _b[oj]+emptenure*_b[emptenure]
>         local culcemp2 _b[oj]+emptenure*_b[emptenure] ///
>                                                         +(emptenure^2)*_b[c.emp
> tenure#c.emptenure]
>         local culcemp3 _b[oj]+emptenure*_b[emptenure] ///
>                                                         +(emptenure^2)*_b[c.emp
> tenure#c.emptenure] ///
>                                                         +(emptenure^3)*_b[c.emp
> tenure#c.emptenure#c.emptenure]
>         local culcemp4 _b[oj]+emptenure*_b[emptenure] ///
>                                                         +(emptenure^2)*_b[c.emp
> tenure#c.emptenure] ///
>                                                         +(emptenure^3)*_b[c.emp
> tenure#c.emptenure#c.emptenure] ///
>                                                         +(emptenure^4)*_b[c.emp
> tenure#c.emptenure#c.emptenure#c.emptenure]
> }
> 
> foreach ten_i of local isIncOcc{ /* loop within emp and empocc */
>         forvalues poly_x=1/4{ /* loop within ten_inomial */
>                 *** culculation
>                 dis "/* `ten_i' `poly_x'th order */"
>                 est res ols`ten_i'`poly_x'
>                 margins, exp(`culcemp`poly_x'') ///
>                 at(emptenure=(0(1)25)) noe post
>                 est sto ols`ten_i'r`poly_x'
>                 est res isv`ten_i'`poly_x'
>                 margins, exp(`culcemp`poly_x'') ///
>                 at(emptenure=(0(1)25)) noe post
>                 est sto isv`ten_i'r`poly_x'
>                 
>                 *** plot
>                 qui coefplot (ols`ten_i'r`poly_x', label(OLS)) (isv`ten_i'r`pol
> y_x', label(IV)), ///
>                 at ciopts(recast(rline) lpattern(dash)) recast(connected) ///
>                 xtitle("Employer Tenure") ytitle("Returns to Tenure on Earnings
>  (%)") ///
>                 yline(0) rescale(100)
>                 graph export "$Output\plot_as_`ten_i'_`poly_x'.pdf", replace
>         }
> }
> 
> ** output tex all results
> {
> qui{
> local labelVar emptenure "Employer tenure" ///
>                                                 c.emptenure#c.emptenure "Emp.te
> n.$^{2}\times 100$" ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure "Emp.ten.$^{3}\times 100$" ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure#c.emptenure "Emp.ten.$^{4}\times 1000$" ///
>                                                 oj "Old job" ///
>                                                 workexp "Total experience" c.wo
> rkexp#c.workexp "Experience$^{2}$" ///
>                                                 c.workexp#c.workexp#c.workexp "
> Exp.$^{3}\times 100$" ///
>                                                 c.workexp#c.workexp#c.workexp#c
> .workexp "Exp.$^{4}\times 10000$"
> local transVar c.emptenure#c.emptenure 100*@ 100 ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure 100*@ 100 ///
>                                                 c.emptenure#c.emptenurec.empten
> ure#c.emptenure 10000*@ 10000 ///
>                                                 c.workexp#c.workexp#c.workexp 1
> 00*@ 100 ///
>                                                 c.workexp#c.workexp#c.workexp 1
> 0000*@ 10000 ///
>                                                 c.occtenure#c.occtenure 100*@ 1
> 00 ///
>                                                 c.occtenure#c.occtenure#c.occte
> nure 100*@ 100 ///
>                                                 c.occtenure#c.occtenure#c.occte
> nure#c.occtenure 10000*@ 10000
> 
> *** coefficients / emp+occ
> local keepVar emptenure c.emptenure#c.emptenure ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure#c.emptenure ///
>                                                 oj ///
>                                                 occtenure c.occtenure#c.occtenu
> re ///
>                                                 c.occtenure#c.occtenure#c.occte
> nure ///
>                                                 c.occtenure#c.occtenure#c.occte
> nure#c.occtenure ///
>                                                 workexp c.workexp#c.workexp ///
>                                                 c.workexp#c.workexp#c.workexp /
> //
>                                                 c.workexp#c.workexp#c.workexp#c
> .workexp
> 
> esttab olsempocc2 olsempocc3 olsempocc4 isvempocc2 isvempocc3 isvempocc4 ///
> using "$Output\as_empocc.tex", ///
> se star(* 0.1 ** 0.05 *** 0.01) b(4) ///
> keep(`keepVar') ///
> order(`keepVar') ///
> coeflabel(`labelVar' ///
>                                 occtenure "Occupation tenure" ///
>                                 c.occtenure#c.occtenure "Occ.ten.$^{2}\times 10
> 0$" ///
>                                 c.occtenure#c.occtenure#c.occtenure "Occ.ten.$^
> {3}\times 100$" ///
>                                 c.occtenure#c.occtenure#c.occtenure#c.occtenure
>  "Occ.ten.$^{4}\times 10000$" ///
>                                 ) ///
> transform(`transVar') ///
> nodep nonote nomtitles ///
> title(Earnings Function Estimates, using Sample up to 64-year-old, ///
> including Non-regular Workers and Specialists, ///
> Variables of Occupation Tenure are Controlled.) ///
> mgroups("OLS" "IV" ///
> pattern(1 0 0 1 0 0) ///
> prefix(\multicolumn{@span}{c}{) suffix(}) span erepeat(\cmidrule(lr){@span})) /
> //
> replace
> 
> *** coefficients / emptenure
> local keepVar emptenure c.emptenure#c.emptenure ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure#c.emptenure ///
>                                                 oj workexp c.workexp#c.workexp 
> ///
>                                                 c.workexp#c.workexp#c.workexp /
> //
>                                                 c.workexp#c.workexp#c.workexp#c
> .workexp
> 
> esttab olsemp2 olsemp3 olsemp4 isvemp2 isvemp3 isvemp4 ///
> using "$Output\as_emp.tex", ///
> se star(* 0.1 ** 0.05 *** 0.01) b(4) ///
> keep(`keepVar') ///
> order(`keepVar') ///
> coeflabel(`labelVar') ///
> transform(`transVar') ///
> nodep nonote nomtitles ///
> title(Earnings Function Estimates, using Sample up to 64-year-old, ///
> including Non-regular Workers and Specialists, ///
> Variables of Occupation Tenure are not Controlled.) ///
> mgroups("OLS" "IV" ///
> pattern(1 0 0 1 0 0) ///
> prefix(\multicolumn{@span}{c}{) suffix(}) span erepeat(\cmidrule(lr){@span})) /
> //
> replace
> 
> *** main table
> esttab olsemp2 olsempocc2 isvemp2 isvempocc2 ///
> using "$Output\as_main.tex", ///
> se star(* 0.1 ** 0.05 *** 0.01) b(4) ///
> keep(`keepVar') ///
> order(`keepVar') ///
> coeflabel(`labelVar') ///
> transform(`transVar') ///
> nodep nonote nomtitles ///
> title(Earnings Function Estimates, using Sample up to 64-year-old, ///
> including Non-regular Workers and Specialists.) ///
> mgroups("OLS" "IV" ///
> pattern(1 0 1 0) ///
> prefix(\multicolumn{@span}{c}{) suffix(}) span erepeat(\cmidrule(lr){@span})) /
> //
> replace
> 
> *** return
> esttab olsempr2 olsempoccr2 isvempr2 isvempoccr2 ///
> using "$Output\as_return.tex", ///
> se star(* 0.1 ** 0.05 *** 0.01) b(4) ///
> keep(3._at 6._at 11._at 16._at 21._at 26._at) ///
> coeflabel(3._at "2 Years" ///
> 6._at "5 Years" 11._at "10 Years" ///
> 16._at "15 Years" ///
> 21._at "20 Years" 26._at "25 Years") ///
> nodep nonote nomtitles ///
> title(Estimated Returns to Employer Tenure, using Sample up to 64-year-old, ///
> including Non-regular Workers and Specialists.) ///
> mgroups("OLS" "IV" ///
> pattern(1 0 1 0) ///
> prefix(\multicolumn{@span}{c}{) suffix(}) span erepeat(\cmidrule(lr){@span})) /
> //
> replace
> }
> }
> }
> 
> 
> 
> * 2. OLS->AS / under 60-year-old, firm size, non-specialist, regular employee
> {
> local subSample Yn Pr La Sm Rg
> foreach sub_i of local subSample{ /* loop within subsample */
>         do "$Code\ReadData.do"
>         /// criterion for making subsamples
>         if "`sub_i'"=="Yn"{ /* under 59-year-old */
>                 dis "/* under 59-year-old */"
>                 drop if age>=60
>                 sum age
>         }
>         else if "`sub_i'"=="Pr"{ /* non-professional */
>                 dis "/* non-professional */"
>                 drop if occ==10
>                 tab occ
>         }
>         else if "`sub_i'"=="La"{ /* large firm */
>                 dis "/* large firm */"
>                 keep if dsize==2
>                 tab dsize
>         }
>         else if "`sub_i'"=="Sm"{ /* small firm */
>                 dis "/* small firm */"
>                 drop if dsize==2
>                 tab dsize
>         }
>         else if "`sub_i'"=="Rg"{ /* regular employee */
>                 dis "/* regular employee */"
>                 drop if dregular==0
>         tab dregular
>         }
>         *** OLS
>         reg ///
>                 `commonVar' ///
>                 `emp2' ///
>                 , vce(r)
>                 est sto olsrob`sub_i'
>         
>         *** AS
>         qui {
>                 do "$Code\ConstructIV.do"
>                 ivregress 2sls ///
>                                                         `commonVar' ///
>                                                         (`emp2' = `empiv2') ///
>                                                         , vce(r)
>                 est sto isvrob`sub_i'
>                 drop if _est_isvrob`sub_i'==0
>                 drop *iv *iv? avg*
>                 **** re-build iv
>                 do "$Code\ConstructIV.do"
>         }
>         ivregress 2sls ///
>                                                 `commonVar' ///
>                                                 (`emp2' = `empiv2') ///
>                                                 , vce(r)
>         est sto isvrob`sub_i'
>         
>         *** culculation
>         est res olsrob`sub_i'
>         margins, exp(`culcemp2') ///
>         at(emptenure=(0(1)25)) noe post
>         est sto olsrobn`sub_i'
>         est res isvrob`sub_i'
>         margins, exp(`culcemp2') ///
>         at(emptenure=(0(1)25)) noe post
>         est sto isvrobn`sub_i'
> }
> *** plot
> qui coefplot (olsrobnYn, label(OLS)) (isvrobnYn, label(IV)), bylabel(Under 60-y
> ear-old) ///
> || (olsrobnRg, label(OLS)) (isvrobnRg, label(IV)), bylabel(Regular Employee) //
> /
> || (olsrobnPr, label(OLS)) (isvrobnPr, label(IV)), bylabel(Non-Professional) //
> /
> || (olsrobnLa, label(OLS)) (isvrobnLa, label(IV)), bylabel(Large Firm (Size>=50
> 0)) ///
> || (olsrobnSm, label(OLS)) (isvrobnSm, label(IV)), bylabel(Small Firm (Size<500
> )) ///
> ||, at ciopts(recast(rline) lpattern(dash)) recast(connected) ///
> xtitle("Employer Tenure") ytitle("Returns to Tenure on Earnings (%)") ///
> yline(0) rescale(100)
> graph export "$Output\plot_as_emp_rob.pdf", replace
> 
> 
> ** output tex all results
> qui{
> local keepVar emptenure c.emptenure#c.emptenure ///
>                                                 oj workexp c.workexp#c.workexp
> ** coefficients
> esttab olsrobYn isvrobYn olsrobLa isvrobLa ///
> olsrobSm isvrobSm olsrobPr isvrobPr olsrobRg isvrobRg ///
> using "$Output\as_emp_rob.tex", ///
> se star(* 0.1 ** 0.05 *** 0.01) b(4) ///
> keep(`keepVar') ///
> order(`keepVar') ///
> coeflabel(`labelVar') ///
> transform(`transVar') ///
> nodep nonote nomtitles ///
> title(Earnings Function Estimates, using Various Subsamples.) ///
> mgroups("Under 59-year-old" "Large firms ($\geq500$)" ///
> "Small Firms ($<500$)" "Non-Professional" "Regular Employee" ///
> pattern(1 0 1 0 1 0 1 0 1 0) ///
> prefix(\multicolumn{@span}{c}{) suffix(}) span erepeat(\cmidrule(lr){@span})) /
> //
> replace
> 
> **** return
> esttab olsrobnYn isvrobnYn olsrobnLa isvrobnLa ///
> olsrobnSm isvrobnSm olsrobnPr isvrobnPr olsrobnRg isvrobnRg ///
> using "$Output\as_return_rob.tex", ///
> se star(* 0.1 ** 0.05 *** 0.01) b(4) ///
> keep(3._at 6._at 11._at 16._at 21._at 26._at) ///
> coeflabel(3._at "2 Years" ///
> 6._at "5 Years" 11._at "10 Years" ///
> 16._at "15 Years" ///
> 21._at "20 Years" 26._at "25 Years") ///
> nodep nonote nomtitles ///
> title(Estimated Returns to Employer Tenure, using Various Subsamples.) ///
> mgroups("Under 59-year-old" "Large firms ($\geq500$)" ///
> "Small Firms ($<500$)" "Non-Professional" "Regular Employee" ///
> pattern(1 0 1 0 1 0 1 0 1 0) ///
> prefix(\multicolumn{@span}{c}{) suffix(}) span erepeat(\cmidrule(lr){@span})) /
> //
> replace
> }
> }
> 
> 
> 
> * 3. OLS->AS / tenure as dummy
> {
> ** tenure>=1, >=3, >=5, >=10, >=15
> *** simple dummy
> do "$Code\ReadData.do"
> sort empid year
> replace emptenure=40 if emptenure>=40
> est sto olsrobRg
> dis " /* simple dummy */ "
> reg ///
>         `commonVar' ///
>         i.emptenure c.workexp##c.workexp ///
>         , vce(r)
> est sto Dm
> 
> *** same equation as AS
> do "$Code\ReadData.do"
> sort empid year
> numlist "1 2 5 10 15 20 25 30"
> local tendm "`r(numlist)'"
> **** make emptenure dummy
> foreach i of local tendm {
>         gen emp`i'=1 if emptenure>=`i'
>         replace emp`i'=0 if emp`i'==.
> }
> dis " /* OLS dummy */ "
> reg ///
>         `commonVar' ///
>         emp1 emp2 emp5 emp10 emp15 emp20 emp25 emp30 ///
>         c.workexp##c.workexp ///
>         , vce(r)
> est sto olsempD
> 
> *** AS
> qui {
>         do "$Code\ConstructIV.do"
>         foreach i of local tendm {
>                 bysort empid (year): egen avgemp`i'=mean(emp`i')
>                 gen empiv`i'=emp`i'-avgemp`i'
>         }       
>         ivregress 2sls ///
>                         `commonVar' ///
>                         (emp1 emp2 emp5 emp10 emp15 emp20 emp25 emp30 ///
>                         c.workexp##c.workexp = ///
>                         empiv1 empiv2 empiv5 empiv10 empiv15 empiv20 empiv25 em
> piv30 ///
>                         workexpiv workexpiv2) ///
>                         , vce(r)
>         est sto isvempD
>         drop if _est_isvempD==0
>         drop *iv* avg*
>         **** re-build iv
>         do "$Code\ConstructIV.do"
>         foreach i of local tendm {
>                 bysort empid (year): egen avgemp`i'=mean(emp`i')
>                 gen empiv`i'=emp`i'-avgemp`i'
>         }
> }
> dis " /* AS's IV dummy */ "
> ivregress 2sls ///
>                 `commonVar' ///
>                 (emp1 emp2 emp5 emp10 emp15 emp20 emp25 emp30 ///
>                 c.workexp##c.workexp = ///
>                 empiv1 empiv2 empiv5 empiv10 empiv15 empiv20 empiv25 empiv30 //
> /
>                 workexpiv workexpiv2) ///
>                 , vce(r)
> est sto isvempD
>  
> *** output tex all results
> qui{
> local keepVar emp1 emp2 emp5 emp10 emp15 emp20 emp25 emp30 ///
>                                                 workexp c.workexp#c.workexp
> *** coefficients
> esttab olsempD isvempD ///
> using "$Output\as_emp_dm.tex", ///
> se star(* 0.1 ** 0.05 *** 0.01) b(4) ///
> keep(`keepVar') ///
> order(`keepVar') ///
> coeflabel(emp1 "$ T_{ij}\geq1$" emp2 "$ T_{ij}\geq2$" ///
> emp5 "$ T_{ij}\geq5$" emp10 "$ T_{ij}\geq10$" ///
> emp15 "$ T_{ij}\geq15$" emp20 "$ T_{ij}\geq20$" ///
> emp25 "$ T_{ij}\geq25$" emp30 "$ T_{ij}\geq30$" ///
> workexp "Total experience" c.workexp#c.workexp "Experience$^{2}$") ///
> nodep nonote nomtitles ///
> title(Estimated Returns to Employer Tenure, Employer Tenure is Treated as Dummy
>  Variables) ///
> mgroups("OLS" "IV" ///
> pattern(1 1) ///
> prefix(\multicolumn{@span}{c}{) suffix(}) span erepeat(\cmidrule(lr){@span})) /
> //
> replace
> 
> *** simple dummy
> est res Dm
> qui coefplot, vertical yline(0) nolabel keep(*.emptenure) ///
> ciopts(recast(rline) lpattern(dash)) recast(connected)  rescale(100) ///
> xtitle("Employer Tenure") ytitle("Returns to Tenure on Earnings (%)") ///
> rename(1.emptenure=1 2.emptenure=2 3.emptenure=3 4.emptenure=4 5.emptenure=5 //
> /
> 6.emptenure=6 7.emptenure=7 8.emptenure=8 9.emptenure=9 10.emptenure=10 ///
> 11.emptenure=11 12.emptenure=12 13.emptenure=13 14.emptenure=14 15.emptenure=15
>  ///
> 16.emptenure=16 17.emptenure=17 18.emptenure=18 19.emptenure=19 20.emptenure=20
>  ///
> 21.emptenure=21 22.emptenure=22 23.emptenure=23 24.emptenure=24 25.emptenure=25
>  ///
> 26.emptenure=26 27.emptenure=27 28.emptenure=28 29.emptenure=29 30.emptenure=30
>  ///
> 31.emptenure=31 32.emptenure=32 33.emptenure=33 34.emptenure=34 35.emptenure=35
>  ///
> 36.emptenure=36 37.emptenure=37 38.emptenure=38 39.emptenure=39 40.emptenure=40
> )  ///
> title("Estimated Returns to Employer Tenure, Employer Tenure is Treated as Dumm
> y Variables")
> graph export "$Output\plot_as_dm.pdf", replace
> }
> }
> */
. 
. 
. * 4. Topel / 1-4 dimenational polynomial
. {
. qui{
. 
. do "$Code\ReadData.do"

. /* Title: ReadData */
. /// Date: Nov 5th, 2018
> /// Written by Ayaka Nakamura
> /// 
> /// This file reads data set
> 
. local inputfd "C:\Users\AyakaNakamura\Dropbox\materials\Works\Master\program\Su
> bmittion\Input"

. 
. qui {

. 
end of do-file
. do "$Code\EstTopel.do"

. qui{

. 
. 
. * estimation
. forvalues i=1/4 {
  2.         **** 1st step
.         qui $FstReg ///
>                                 `contrl`i'' ///
>                                 if fst==1
  3.         est sto fst`i'
  4.         gen emptenB`i'=`LHSterm`i'' ///
>                                                                 $DmYear
  5.         gen intwemp`i'=realwage-emptenB`i'
  6.         
.         **** 2nd step
.         qui $SndReg
  7.         est sto snd`i'
  8. }
(1,076 missing values generated)
(2,498 missing values generated)
(1,157 missing values generated)
(2,567 missing values generated)
(1,157 missing values generated)
(2,567 missing values generated)
(1,157 missing values generated)
(2,567 missing values generated)

. 
. * calc. return
. ** linear
. capture program drop coef

. program coef, rclass
  1.         suest fst1 snd1
  2.         lincom [fst1_mean]_b[_cons]-[snd1_mean]_b[initialemp]
  3.         return scalar diffse =r(se)
  4. end

. coef

Simultaneous results for fst1, snd1

                                                Number of obs     =      8,811

------------------------------------------------------------------------------
             |               Robust
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
fst1_mean    |
        year |
       2006  |  -.1355276   .0339191    -4.00   0.000    -.2020079   -.0690473
       2007  |  -.1072483   .0327447    -3.28   0.001    -.1714267   -.0430699
       2008  |  -.1196748   .0307359    -3.89   0.000     -.179916   -.0594336
       2009  |  -.0895905    .031242    -2.87   0.004    -.1508236   -.0283573
       2010  |   -.157366   .0281885    -5.58   0.000    -.2126144   -.1021175
       2011  |  -.1152635   .0280391    -4.11   0.000    -.1702192   -.0603078
       2012  |  -.1071254   .0270173    -3.97   0.000    -.1600785   -.0541724
       2013  |  -.1285062   .0280654    -4.58   0.000    -.1835133   -.0734991
       2014  |  -.0803182   .0286144    -2.81   0.005    -.1364013    -.024235
             |
       _cons |   .1196458   .0228226     5.24   0.000     .0749144    .1643772
-------------+----------------------------------------------------------------
fst1_lnvar   |
       _cons |  -1.559038   .0420012   -37.12   0.000    -1.641359   -1.476717
-------------+----------------------------------------------------------------
snd1_mean    |
  1.dmarital |  -.3126046   .0321813    -9.71   0.000    -.3756787   -.2495304
             |
   schooling |
         12  |   .9479987   .0757376    12.52   0.000     .7995557    1.096442
         14  |    1.29761    .082265    15.77   0.000     1.136373    1.458846
         16  |   1.597697   .0776922    20.56   0.000     1.445423    1.749971
             |
  1.dregular |   .5829381   .0487051    11.97   0.000     .4874778    .6783983
    1.dunion |  -.0023279   .0273232    -0.09   0.932    -.0558804    .0512246
             |
         occ |
          2  |  -.0465269    .872118    -0.05   0.957    -1.755847    1.662793
          3  |   .5002182   .8100333     0.62   0.537    -1.087418    2.087854
          4  |   .3159621   .8146669     0.39   0.698    -1.280756     1.91268
          5  |  -.0075188   .8133659    -0.01   0.993    -1.601687    1.586649
          6  |   .3065009   .8134035     0.38   0.706    -1.287741    1.900742
          7  |   .5652502   .8148382     0.69   0.488    -1.031803    2.162304
          8  |   .5912122   .8141042     0.73   0.468    -1.004403    2.186827
          9  |   .7754054   .8145516     0.95   0.341    -.8210865    2.371897
         10  |    .639868   .8136929     0.79   0.432    -.9549407    2.234677
         11  |   .2817478   .8158623     0.35   0.730    -1.317313    1.880809
         12  |   .4111381   .8197253     0.50   0.616    -1.195494     2.01777
             |
         ind |
          2  |   2.867268   .5261519     5.45   0.000     1.836029    3.898507
          3  |   4.316679   .8604828     5.02   0.000     2.630164    6.003195
          4  |    3.27098   .8199815     3.99   0.000     1.663846    4.878114
          5  |   3.238815   .8199597     3.95   0.000     1.631723    4.845906
          6  |   3.227249   .8175193     3.95   0.000     1.624941    4.829558
          7  |   3.643225   .8241483     4.42   0.000     2.027924    5.258526
          8  |    3.52156   .8204521     4.29   0.000     1.913504    5.129617
          9  |   3.427201    .823233     4.16   0.000     1.813694    5.040708
         10  |   3.271057   .8209875     3.98   0.000     1.661951    4.880163
         11  |   3.368008   .8211427     4.10   0.000     1.758598    4.977418
         12  |   3.340817   .8221768     4.06   0.000      1.72938    4.952254
         13  |   3.436981   .8223937     4.18   0.000     1.825119    5.048843
         14  |   3.488259   .8207186     4.25   0.000      1.87968    5.096838
         15  |   3.392773   .8216148     4.13   0.000     1.782437    5.003108
         16  |   3.334749   .8203066     4.07   0.000     1.726978     4.94252
         17  |    3.28364   .8540952     3.84   0.000     1.609644    4.957636
         18  |   3.317226   .8307932     3.99   0.000     1.688901    4.945551
             |
       dsize |
          1  |  -.0125562   .0296132    -0.42   0.672    -.0705971    .0454846
          2  |  -.0118434   .0292155    -0.41   0.685    -.0691047    .0454179
             |
  initialemp |    .062538   .0011709    53.41   0.000      .060243     .064833
-------------+----------------------------------------------------------------
snd1_lnvar   |
       _cons |  -.0072358    .016688    -0.43   0.665    -.0399437    .0254721
------------------------------------------------------------------------------

 ( 1)  [fst1_mean]_cons - [snd1_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0571078    .022894     2.49   0.013     .0122363    .1019793
------------------------------------------------------------------------------

. capture program drop emprtn

. program emprtn, rclass
  1.         qui suest fst1 snd1
  2.         foreach X of numlist 2 5 10 15 20 25 {
  3.         lincom ([fst1_mean]_b[_cons]-[snd1_mean]_b[initialemp])*`X'
  4.         return scalar rtn`X' =r(se)
  5.         }
  6. end

. emprtn

 ( 1)  2*[fst1_mean]_cons - 2*[snd1_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1142156   .0457881     2.49   0.013     .0244726    .2039586
------------------------------------------------------------------------------

 ( 1)  5*[fst1_mean]_cons - 5*[snd1_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    .285539   .1144702     2.49   0.013     .0611815    .5098966
------------------------------------------------------------------------------

 ( 1)  10*[fst1_mean]_cons - 10*[snd1_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .5710781   .2289405     2.49   0.013      .122363    1.019793
------------------------------------------------------------------------------

 ( 1)  15*[fst1_mean]_cons - 15*[snd1_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .8566171   .3434107     2.49   0.013     .1835445     1.52969
------------------------------------------------------------------------------

 ( 1)  20*[fst1_mean]_cons - 20*[snd1_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.142156   .4578809     2.49   0.013      .244726    2.039586
------------------------------------------------------------------------------

 ( 1)  25*[fst1_mean]_cons - 25*[snd1_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.427695   .5723511     2.49   0.013     .3059076    2.549483
------------------------------------------------------------------------------

. 
. ** qadratic
. capture program drop coef

. program coef, rclass
  1.         suest fst2 snd2
  2.         lincom [fst2_mean]_b[_cons]-[snd2_mean]_b[initialemp]
  3.         return scalar diffse =r(se)
  4. end

. coef

Simultaneous results for fst2, snd2

                                                Number of obs     =      8,807

------------------------------------------------------------------------------
             |               Robust
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
fst2_mean    |
        year |
       2006  |  -.1256347   .0330861    -3.80   0.000    -.1904823   -.0607871
       2007  |  -.0911161   .0318609    -2.86   0.004    -.1535624   -.0286698
       2008  |  -.1041338   .0299519    -3.48   0.001    -.1628384   -.0454291
       2009  |   -.072156   .0301879    -2.39   0.017    -.1313231   -.0129889
       2010  |  -.1440133    .027422    -5.25   0.000    -.1977595   -.0902672
       2011  |  -.1005874   .0271651    -3.70   0.000      -.15383   -.0473449
       2012  |   -.083618   .0261756    -3.19   0.001    -.1349211   -.0323148
       2013  |  -.1065084   .0273259    -3.90   0.000    -.1600661   -.0529507
       2014  |  -.0417741    .027959    -1.49   0.135    -.0965726    .0130245
             |
  emptendif2 |  -.0006725   .0002541    -2.65   0.008    -.0011704   -.0001745
  empexpdif2 |  -.0025336   .0002808    -9.02   0.000     -.003084   -.0019833
       _cons |   .2535385   .0276271     9.18   0.000     .1993903    .3076866
-------------+----------------------------------------------------------------
fst2_lnvar   |
       _cons |  -1.587859   .0414821   -38.28   0.000    -1.669163   -1.506556
-------------+----------------------------------------------------------------
snd2_mean    |
  1.dmarital |  -.3126046   .0321813    -9.71   0.000    -.3756787   -.2495304
             |
   schooling |
         12  |   .9479987   .0757376    12.52   0.000     .7995557    1.096442
         14  |    1.29761    .082265    15.77   0.000     1.136373    1.458846
         16  |   1.597697   .0776922    20.56   0.000     1.445423    1.749971
             |
  1.dregular |   .5829381   .0487051    11.97   0.000     .4874778    .6783983
    1.dunion |  -.0023279   .0273232    -0.09   0.932    -.0558804    .0512246
             |
         occ |
          2  |  -.0465269    .872118    -0.05   0.957    -1.755847    1.662793
          3  |   .5002182   .8100333     0.62   0.537    -1.087418    2.087854
          4  |   .3159621   .8146669     0.39   0.698    -1.280756     1.91268
          5  |  -.0075188   .8133659    -0.01   0.993    -1.601687    1.586649
          6  |   .3065009   .8134035     0.38   0.706    -1.287741    1.900742
          7  |   .5652502   .8148382     0.69   0.488    -1.031803    2.162304
          8  |   .5912122   .8141042     0.73   0.468    -1.004403    2.186827
          9  |   .7754054   .8145517     0.95   0.341    -.8210865    2.371897
         10  |    .639868   .8136929     0.79   0.432    -.9549408    2.234677
         11  |   .2817478   .8158623     0.35   0.730    -1.317313    1.880809
         12  |   .4111381   .8197253     0.50   0.616    -1.195494     2.01777
             |
         ind |
          2  |   2.867268   .5261519     5.45   0.000     1.836029    3.898507
          3  |   4.316679   .8604828     5.02   0.000     2.630164    6.003195
          4  |    3.27098   .8199816     3.99   0.000     1.663846    4.878115
          5  |   3.238815   .8199597     3.95   0.000     1.631723    4.845906
          6  |   3.227249   .8175193     3.95   0.000     1.624941    4.829558
          7  |   3.643225   .8241484     4.42   0.000     2.027924    5.258526
          8  |    3.52156   .8204521     4.29   0.000     1.913504    5.129617
          9  |   3.427201    .823233     4.16   0.000     1.813694    5.040708
         10  |   3.271057   .8209875     3.98   0.000     1.661951    4.880163
         11  |   3.368008   .8211427     4.10   0.000     1.758598    4.977418
         12  |   3.340817   .8221768     4.06   0.000      1.72938    4.952254
         13  |   3.436981   .8223937     4.18   0.000     1.825119    5.048844
         14  |   3.488259   .8207186     4.25   0.000      1.87968    5.096838
         15  |   3.392773   .8216148     4.13   0.000     1.782437    5.003108
         16  |   3.334749   .8203066     4.07   0.000     1.726978    4.942521
         17  |    3.28364   .8540952     3.84   0.000     1.609644    4.957636
         18  |   3.317226   .8307932     3.99   0.000     1.688901    4.945551
             |
       dsize |
          1  |  -.0125562   .0296132    -0.42   0.672    -.0705971    .0454847
          2  |  -.0118434   .0292155    -0.41   0.685    -.0691047    .0454179
             |
  initialemp |    .062538   .0011709    53.41   0.000      .060243     .064833
-------------+----------------------------------------------------------------
snd2_lnvar   |
       _cons |  -.0072358    .016688    -0.43   0.665    -.0399437    .0254721
------------------------------------------------------------------------------

 ( 1)  [fst2_mean]_cons - [snd2_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1910005   .0276861     6.90   0.000     .1367367    .2452642
------------------------------------------------------------------------------

. capture program drop emprtn

. program emprtn, rclass
  1.         qui suest fst2 snd2
  2.         foreach X of numlist 2 5 10 15 20 25 {
  3.         lincom ([fst2_mean]_b[_cons]-[snd2_mean]_b[initialemp])*`X' ///
>                                 +[fst2_mean]_b[emptendif2]*`X'*`X'
  4.         return scalar rtn`X' =r(se)
  5.         }
  6. end

. emprtn

 ( 1)  4*[fst2_mean]emptendif2 + 2*[fst2_mean]_cons - 2*[snd2_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    .379311   .0551449     6.88   0.000      .271229     .487393
------------------------------------------------------------------------------

 ( 1)  25*[fst2_mean]emptendif2 + 5*[fst2_mean]_cons - 5*[snd2_mean]initialemp =
       0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .9381904   .1370938     6.84   0.000     .6694914    1.206889
------------------------------------------------------------------------------

 ( 1)  100*[fst2_mean]emptendif2 + 10*[fst2_mean]_cons - 10*[snd2_mean]initialemp
       = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.842757   .2720818     6.77   0.000     1.309486    2.376027
------------------------------------------------------------------------------

 ( 1)  225*[fst2_mean]emptendif2 + 15*[fst2_mean]_cons - 15*[snd2_mean]initialemp
       = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   2.713699   .4058349     6.69   0.000     1.918278    3.509121
------------------------------------------------------------------------------

 ( 1)  400*[fst2_mean]emptendif2 + 20*[fst2_mean]_cons - 20*[snd2_mean]initialemp
       = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   3.551018    .539244     6.59   0.000     2.494119    4.607917
------------------------------------------------------------------------------

 ( 1)  625*[fst2_mean]emptendif2 + 25*[fst2_mean]_cons - 25*[snd2_mean]initialemp
       = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   4.354713   .6732102     6.47   0.000     3.035245    5.674181
------------------------------------------------------------------------------

. 
. ** cubic
. capture program drop coef

. program coef, rclass
  1.         suest fst3 snd3
  2.         lincom [fst3_mean]_b[_cons]-[snd3_mean]_b[initialemp]
  3.         return scalar diffse =r(se)
  4. end

. coef

Simultaneous results for fst3, snd3

                                                Number of obs     =      8,807

------------------------------------------------------------------------------
             |               Robust
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
fst3_mean    |
        year |
       2006  |  -.1200358   .0322921    -3.72   0.000    -.1833273   -.0567444
       2007  |  -.0847899    .031172    -2.72   0.007    -.1458859   -.0236939
       2008  |  -.0997646    .029008    -3.44   0.001    -.1566193   -.0429099
       2009  |  -.0690091    .029145    -2.37   0.018    -.1261322    -.011886
       2010  |  -.1335462   .0265789    -5.02   0.000    -.1856398   -.0814526
       2011  |  -.0905703   .0264498    -3.42   0.001     -.142411   -.0387296
       2012  |  -.0727585   .0253973    -2.86   0.004    -.1225362   -.0229808
       2013  |  -.0965051    .026441    -3.65   0.000    -.1483284   -.0446818
       2014  |  -.0155775   .0274696    -0.57   0.571    -.0694169    .0382619
             |
  emptendif2 |   .0000226   .0009502     0.02   0.981    -.0018398     .001885
  empexpdif2 |  -.0119881   .0014441    -8.30   0.000    -.0148185   -.0091576
  emptendif3 |  -3.13e-06    .000017    -0.18   0.854    -.0000364    .0000302
  empexpdif3 |   .0001387   .0000184     7.55   0.000     .0001027    .0001747
       _cons |   .3955184   .0372029    10.63   0.000      .322602    .4684347
-------------+----------------------------------------------------------------
fst3_lnvar   |
       _cons |  -1.614855   .0406083   -39.77   0.000    -1.694445   -1.535264
-------------+----------------------------------------------------------------
snd3_mean    |
  1.dmarital |  -.3126046   .0321813    -9.71   0.000    -.3756787   -.2495304
             |
   schooling |
         12  |   .9479987   .0757376    12.52   0.000     .7995557    1.096442
         14  |    1.29761    .082265    15.77   0.000     1.136373    1.458846
         16  |   1.597697   .0776922    20.56   0.000     1.445423    1.749971
             |
  1.dregular |   .5829381   .0487051    11.97   0.000     .4874778    .6783983
    1.dunion |  -.0023279   .0273232    -0.09   0.932    -.0558804    .0512246
             |
         occ |
          2  |  -.0465269    .872118    -0.05   0.957    -1.755847    1.662793
          3  |   .5002182   .8100333     0.62   0.537    -1.087418    2.087854
          4  |   .3159621   .8146669     0.39   0.698    -1.280756     1.91268
          5  |  -.0075188   .8133659    -0.01   0.993    -1.601687    1.586649
          6  |   .3065009   .8134035     0.38   0.706    -1.287741    1.900742
          7  |   .5652502   .8148382     0.69   0.488    -1.031803    2.162304
          8  |   .5912122   .8141042     0.73   0.468    -1.004403    2.186827
          9  |   .7754054   .8145517     0.95   0.341    -.8210865    2.371897
         10  |    .639868   .8136929     0.79   0.432    -.9549408    2.234677
         11  |   .2817478   .8158623     0.35   0.730    -1.317313    1.880809
         12  |   .4111381   .8197253     0.50   0.616    -1.195494     2.01777
             |
         ind |
          2  |   2.867268   .5261519     5.45   0.000     1.836029    3.898507
          3  |   4.316679   .8604828     5.02   0.000     2.630164    6.003195
          4  |    3.27098   .8199816     3.99   0.000     1.663846    4.878115
          5  |   3.238815   .8199597     3.95   0.000     1.631723    4.845906
          6  |   3.227249   .8175193     3.95   0.000     1.624941    4.829558
          7  |   3.643225   .8241484     4.42   0.000     2.027924    5.258526
          8  |    3.52156   .8204521     4.29   0.000     1.913504    5.129617
          9  |   3.427201    .823233     4.16   0.000     1.813694    5.040708
         10  |   3.271057   .8209875     3.98   0.000     1.661951    4.880163
         11  |   3.368008   .8211427     4.10   0.000     1.758598    4.977418
         12  |   3.340817   .8221768     4.06   0.000      1.72938    4.952254
         13  |   3.436981   .8223937     4.18   0.000     1.825119    5.048844
         14  |   3.488259   .8207186     4.25   0.000      1.87968    5.096838
         15  |   3.392773   .8216148     4.13   0.000     1.782437    5.003108
         16  |   3.334749   .8203066     4.07   0.000     1.726978    4.942521
         17  |    3.28364   .8540952     3.84   0.000     1.609644    4.957636
         18  |   3.317226   .8307932     3.99   0.000     1.688901    4.945551
             |
       dsize |
          1  |  -.0125562   .0296132    -0.42   0.672    -.0705971    .0454847
          2  |  -.0118434   .0292155    -0.41   0.685    -.0691047    .0454179
             |
  initialemp |    .062538   .0011709    53.41   0.000      .060243     .064833
-------------+----------------------------------------------------------------
snd3_lnvar   |
       _cons |  -.0072358    .016688    -0.43   0.665    -.0399437    .0254721
------------------------------------------------------------------------------

 ( 1)  [fst3_mean]_cons - [snd3_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3329803   .0372527     8.94   0.000     .2599664    .4059943
------------------------------------------------------------------------------

. capture program drop emprtn

. program emprtn, rclass
  1.         qui suest fst3 snd3
  2.         foreach X of numlist 2 5 10 15 20 25 {
  3.         lincom ([fst3_mean]_b[_cons]-[snd3_mean]_b[initialemp])*`X' ///
>                                 +[fst3_mean]_b[emptendif2]*`X'*`X' ///
>                                 +[fst3_mean]_b[emptendif3]*`X'*`X'*`X'
  4.         return scalar rtn`X' =r(se)
  5.         }
  6. end

. emprtn

 ( 1)  4*[fst3_mean]emptendif2 + 8*[fst3_mean]emptendif3 + 2*[fst3_mean]_cons -
       2*[snd3_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .6660261   .0747012     8.92   0.000     .5196145    .8124378
------------------------------------------------------------------------------

 ( 1)  25*[fst3_mean]emptendif2 + 125*[fst3_mean]emptendif3 + 5*[fst3_mean]_cons
       - 5*[snd3_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.665076   .1881374     8.85   0.000     1.296333    2.033818
------------------------------------------------------------------------------

 ( 1)  100*[fst3_mean]emptendif2 + 1000*[fst3_mean]emptendif3 +
       10*[fst3_mean]_cons - 10*[snd3_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   3.328934   .3829032     8.69   0.000     2.578458    4.079411
------------------------------------------------------------------------------

 ( 1)  225*[fst3_mean]emptendif2 + 3375*[fst3_mean]emptendif3 +
       15*[fst3_mean]_cons - 15*[snd3_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   4.989226   .5851931     8.53   0.000     3.842269    6.136184
------------------------------------------------------------------------------

 ( 1)  400*[fst3_mean]emptendif2 + 8000*[fst3_mean]emptendif3 +
       20*[fst3_mean]_cons - 20*[snd3_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   6.643604   .7927182     8.38   0.000     5.089905    8.197303
------------------------------------------------------------------------------

 ( 1)  625*[fst3_mean]emptendif2 + 15625*[fst3_mean]emptendif3 +
       25*[fst3_mean]_cons - 25*[snd3_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   8.289718   1.001592     8.28   0.000     6.326634     10.2528
------------------------------------------------------------------------------

. 
. ** quartic
. capture program drop coef

. program coef, rclass
  1.         suest fst4 snd4
  2.         lincom [fst4_mean]_b[_cons]-[snd4_mean]_b[initialemp]
  3.         return scalar diffse =r(se)
  4. end

. coef

Simultaneous results for fst4, snd4

                                                Number of obs     =      8,807

------------------------------------------------------------------------------
             |               Robust
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
fst4_mean    |
        year |
       2006  |  -.1195643   .0318097    -3.76   0.000    -.1819102   -.0572184
       2007  |  -.0827452   .0304703    -2.72   0.007     -.142466   -.0230244
       2008  |   -.099027    .028538    -3.47   0.001    -.1549604   -.0430935
       2009  |  -.0694307   .0285958    -2.43   0.015    -.1254774    -.013384
       2010  |  -.1287471   .0261431    -4.92   0.000    -.1799865   -.0775077
       2011  |  -.0878322   .0260511    -3.37   0.001    -.1388913    -.036773
       2012  |  -.0663843   .0250394    -2.65   0.008    -.1154606    -.017308
       2013  |  -.0921815   .0260533    -3.54   0.000    -.1432449    -.041118
       2014  |  -.0041093   .0273307    -0.15   0.880    -.0576765    .0494578
             |
  emptendif2 |   -.000696   .0022465    -0.31   0.757     -.005099     .003707
  empexpdif2 |  -.0232345   .0030295    -7.67   0.000    -.0291722   -.0172969
  emptendif3 |   .0000528    .000089     0.59   0.553    -.0001216    .0002273
  empexpdif3 |   .0005901     .00009     6.56   0.000     .0004138    .0007664
  emptendif4 |  -1.02e-06   1.09e-06    -0.94   0.349    -3.17e-06    1.12e-06
  empexpdif4 |  -5.15e-06   8.96e-07    -5.75   0.000    -6.90e-06   -3.39e-06
       _cons |   .4544411   .0424726    10.70   0.000     .3711963     .537686
-------------+----------------------------------------------------------------
fst4_lnvar   |
       _cons |  -1.627534    .040516   -40.17   0.000    -1.706944   -1.548124
-------------+----------------------------------------------------------------
snd4_mean    |
  1.dmarital |  -.3126046   .0321813    -9.71   0.000    -.3756787   -.2495304
             |
   schooling |
         12  |   .9479987   .0757376    12.52   0.000     .7995557    1.096442
         14  |    1.29761    .082265    15.77   0.000     1.136373    1.458846
         16  |   1.597697   .0776922    20.56   0.000     1.445423    1.749971
             |
  1.dregular |   .5829381   .0487051    11.97   0.000     .4874778    .6783983
    1.dunion |  -.0023279   .0273232    -0.09   0.932    -.0558804    .0512246
             |
         occ |
          2  |  -.0465269    .872118    -0.05   0.957    -1.755847    1.662793
          3  |   .5002182   .8100333     0.62   0.537    -1.087418    2.087854
          4  |   .3159621   .8146669     0.39   0.698    -1.280756     1.91268
          5  |  -.0075188   .8133659    -0.01   0.993    -1.601687    1.586649
          6  |   .3065009   .8134035     0.38   0.706    -1.287741    1.900742
          7  |   .5652502   .8148382     0.69   0.488    -1.031803    2.162304
          8  |   .5912122   .8141042     0.73   0.468    -1.004403    2.186827
          9  |   .7754054   .8145517     0.95   0.341    -.8210865    2.371897
         10  |    .639868   .8136929     0.79   0.432    -.9549408    2.234677
         11  |   .2817478   .8158623     0.35   0.730    -1.317313    1.880809
         12  |   .4111381   .8197253     0.50   0.616    -1.195494     2.01777
             |
         ind |
          2  |   2.867268   .5261519     5.45   0.000     1.836029    3.898507
          3  |   4.316679   .8604828     5.02   0.000     2.630164    6.003195
          4  |    3.27098   .8199816     3.99   0.000     1.663846    4.878115
          5  |   3.238815   .8199597     3.95   0.000     1.631723    4.845906
          6  |   3.227249   .8175193     3.95   0.000     1.624941    4.829558
          7  |   3.643225   .8241484     4.42   0.000     2.027924    5.258526
          8  |    3.52156   .8204521     4.29   0.000     1.913504    5.129617
          9  |   3.427201    .823233     4.16   0.000     1.813694    5.040708
         10  |   3.271057   .8209875     3.98   0.000     1.661951    4.880163
         11  |   3.368008   .8211427     4.10   0.000     1.758598    4.977418
         12  |   3.340817   .8221768     4.06   0.000      1.72938    4.952254
         13  |   3.436981   .8223937     4.18   0.000     1.825119    5.048844
         14  |   3.488259   .8207186     4.25   0.000      1.87968    5.096838
         15  |   3.392773   .8216148     4.13   0.000     1.782437    5.003108
         16  |   3.334749   .8203066     4.07   0.000     1.726978    4.942521
         17  |    3.28364   .8540952     3.84   0.000     1.609644    4.957636
         18  |   3.317226   .8307932     3.99   0.000     1.688901    4.945551
             |
       dsize |
          1  |  -.0125562   .0296132    -0.42   0.672    -.0705971    .0454847
          2  |  -.0118434   .0292155    -0.41   0.685    -.0691047    .0454179
             |
  initialemp |    .062538   .0011709    53.41   0.000      .060243     .064833
-------------+----------------------------------------------------------------
snd4_lnvar   |
       _cons |  -.0072358    .016688    -0.43   0.665    -.0399437    .0254721
------------------------------------------------------------------------------

 ( 1)  [fst4_mean]_cons - [snd4_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3919031    .042513     9.22   0.000     .3085792     .475227
------------------------------------------------------------------------------

. capture program drop emprtn

. program emprtn, rclass
  1.         qui suest fst4 snd4
  2.         foreach X of numlist 2 5 10 15 20 25 {
  3.         lincom ([fst4_mean]_b[_cons]-[snd4_mean]_b[initialemp])*`X' ///
>                                 +[fst4_mean]_b[emptendif2]*`X'*`X' ///
>                                 +[fst4_mean]_b[emptendif3]*`X'*`X'*`X' ///
>                                 +[fst4_mean]_b[emptendif4]*`X'*`X'*`X'*`X'
  4.         return scalar rtn`X' =r(se)
  5.         }
  6. end

. emprtn

 ( 1)  4*[fst4_mean]emptendif2 + 8*[fst4_mean]emptendif3 +
       16*[fst4_mean]emptendif4 + 2*[fst4_mean]_cons - 2*[snd4_mean]initialemp =
       0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .7814285   .0851521     9.18   0.000     .6145334    .9483237
------------------------------------------------------------------------------

 ( 1)  25*[fst4_mean]emptendif2 + 125*[fst4_mean]emptendif3 +
       625*[fst4_mean]emptendif4 + 5*[fst4_mean]_cons - 5*[snd4_mean]initialemp =
       0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    1.94808   .2161275     9.01   0.000     1.524478    2.371682
------------------------------------------------------------------------------

 ( 1)  100*[fst4_mean]emptendif2 + 1000*[fst4_mean]emptendif3 +
       10000*[fst4_mean]emptendif4 + 10*[fst4_mean]_cons -
       10*[snd4_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   3.892023   .4472188     8.70   0.000      3.01549    4.768555
------------------------------------------------------------------------------

 ( 1)  225*[fst4_mean]emptendif2 + 3375*[fst4_mean]emptendif3 +
       50625*[fst4_mean]emptendif4 + 15*[fst4_mean]_cons -
       15*[snd4_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   5.848411   .6882441     8.50   0.000     4.499478    7.197345
------------------------------------------------------------------------------

 ( 1)  400*[fst4_mean]emptendif2 + 8000*[fst4_mean]emptendif3 +
       160000*[fst4_mean]emptendif4 + 20*[fst4_mean]_cons -
       20*[snd4_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    7.81847   .9291356     8.41   0.000     5.997397    9.639542
------------------------------------------------------------------------------

 ( 1)  625*[fst4_mean]emptendif2 + 15625*[fst4_mean]emptendif3 +
       390625*[fst4_mean]emptendif4 + 25*[fst4_mean]_cons -
       25*[snd4_mean]initialemp = 0

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   9.788062   1.163618     8.41   0.000     7.507413    12.06871
------------------------------------------------------------------------------

. 
end of do-file
. 
. *** output tex all results
. quietly {
. }

.  
.  /*
> * 5. Compare with Toda(2009)
> {
> ** make the same sample as Toda
> qui {
>         use "$Inputfd\jhps_hc_allsample.dta", clear
>         destring, replace
>         tsset id year
> }
> *** construct employer tenure
> forvalues X = 2005/2014{ 
>         *** working more than 800h & not switched->+1
>         /// If the sample dropped on the way was resurrected, 
>         /// it is assumed that he kept being employed for the period
>         /// in which it was dropped.
>         dis "current year is `X' "
>         bysort id (year): replace emptenure=emptenure[_n-1]+(year-year[_n-1]) /
> //
>                 if dswitch==0 & year==`X' & _n>1
>         *** switched->0
>         bysort id (year): replace emptenure=0.5 ///
>                 if dswitch==1 & year==`X'
> }
> do "$Code\SampleSelection.do"
> *** replace workexp
> replace workexp=age-schooling-6
> *** sample selection: male, employed, 2004--2007, 20--60, regular
> keep if year<=2007
> tab year
> keep if age>=20 & age<=60
> sum age
> keep if dregular==1
> tab dregular
> save "$Inputfd\jhps_hc_toda.dta", replace
> 
> ** AS
> qui {
>         local commonVar realwage i.occ i.ind i.dunion schooling i.dsize
>         local toda1 c.emptenure c.workexp
>         local toda2 c.emptenure##c.emptenure c.workexp##c.workexp
>         local toda3 c.emptenure##c.emptenure##c.emptenure ///
>                                                 c.workexp##c.workexp##c.workexp
>         local toda4 c.emptenure##c.emptenure##c.emptenure##c.emptenure ///
>                                                 c.workexp##c.workexp##c.workexp
> ##c.workexp
>         local todaiv1 emptenureiv workexpiv
>         local todaiv2 emptenureiv emptenureiv2 ///
>                                                 workexpiv workexpiv2
>         local todaiv3 emptenureiv emptenureiv2 emptenureiv3 ///
>                                                 workexpiv workexpiv2 workexpiv3
>         local todaiv4 emptenureiv emptenureiv2 emptenureiv3 emptenureiv4 ///
>                                                 workexpiv workexpiv2 workexpiv3
>  workexpiv4
> }
> 
> qui {
>         use "$Inputfd\jhps_hc_toda.dta", clear
>         destring, replace
>         tsset id year
> }
> sum realwage schooling dsize emptenure workexp, de
> 
> *** OLS
> forvalues poly_x=1/4{
>         dis "/* OLS  `poly_x'th order */"
>         reg ///
>                         `commonVar' ///
>                         `toda`poly_x'' ///
>                         , vce(r)
>         est sto olstoda`poly_x'
> }
> 
> *** AS
> forvalues poly_x=1/4{
>         qui {
>                 use "$Inputfd\jhps_hc_toda.dta", clear
>                 destring, replace
>                 tsset id year
>                 do "$Code\ConstructIV.do"
>                 ivregress 2sls ///
>                                         `commonVar' ///
>                                         (`toda`poly_x'' = `todaiv`poly_x'') ///
>                                         , vce(r)
>                 est sto isvtoda`poly_x'
>                 drop if _est_isvtoda`poly_x'==0
>                 drop *iv *iv? avg*
>                 do "$Code\ConstructIV.do"
>         }
>         dis "/* AS'sIV  `poly_x'th order */"
>         ivregress 2sls ///
>                                 `commonVar' ///
>                                 (`toda`poly_x'' = `todaiv`poly_x'') ///
>                                 , vce(r)
>         est sto isvtoda`poly_x'
> }
> 
> ** culc. return
> qui{
>         local culcemp1 emptenure*_b[emptenure]
>         local culcemp2 emptenure*_b[emptenure] ///
>                                                         +(emptenure^2)*_b[c.emp
> tenure#c.emptenure]
>         local culcemp3 emptenure*_b[emptenure] ///
>                                                         +(emptenure^2)*_b[c.emp
> tenure#c.emptenure] ///
>                                                         +(emptenure^3)*_b[c.emp
> tenure#c.emptenure#c.emptenure]
>         local culcemp4 emptenure*_b[emptenure] ///
>                                                         +(emptenure^2)*_b[c.emp
> tenure#c.emptenure] ///
>                                                         +(emptenure^3)*_b[c.emp
> tenure#c.emptenure#c.emptenure] ///
>                                                         +(emptenure^4)*_b[c.emp
> tenure#c.emptenure#c.emptenure#c.emptenure]
> }
> 
> forvalues poly_x=1/4{ /* loop within ten_inomial */
>                 *** culculation
>                 est res olstoda`poly_x'
>                 margins, exp(`culcemp`poly_x'') ///
>                 at(emptenure=(0(1)25)) noe post
>                 est sto olstodar`poly_x'
>                 est res isvtoda`poly_x'
>                 margins, exp(`culcemp`poly_x'') ///
>                 at(emptenure=(0(1)25)) noe post
>                 est sto isvtodar`poly_x'
>                 
>                 *** plot
>                 qui coefplot (olstodar`poly_x', label(OLS)) (isvtodar`poly_x', 
> label(IV)), ///
>                 at ciopts(recast(rline) lpattern(dash)) recast(connected) ///
>                 xtitle("Employer Tenure") ytitle("Returns to Tenure on Earnings
>  (%)") ///
>                 yline(0) rescale(100)
>                 graph export "$Output\plot_as_toda_`poly_x'.pdf", replace
> }
> 
> *** Topel
> qui {
>         global DmYear
>         global FstReg reg empwagedif
>         global SndReg reg intwemp1 i.dunion ///
>                                                                 i.occ i.ind i.d
> size ///
>                                                                 initialemp, noc
> ons
> }
> 
> qui {
>         use "$Inputfd\jhps_hc_toda.dta", clear
>         destring, replace
>         tsset id year
> }
> do "$Code\EstTopel.do"
> }
> 
> 
> 
> * 6. OLS->AS / iv of year dummy
> {/*
> local commonVar realwage i.occ i.ind i.dunion i.dmarital ///
>                                                                 i.schooling i.d
> size i.dregular
> *local ydm y2005 y2006 y2007 y2008 ///
> *                               y2009 y2010 y2011 y2012 y2013 y2014
> *local yiv yiv2005 yiv2006 yiv2007 yiv2008 ///
> *                               yiv2009 yiv2010 yiv2011 yiv2012 yiv2013 yiv2014
> local ydm year
> local yiv yiv
> 
> ** AS
> forvalues poly_x=1/4{
>                 qui {
>                         do "$Code\ReadData.do"
>                         do "$Code\ConstructIV.do"
>                         ivregress 2sls ///
>                                                 `commonVar' ///
>                                                 (`emp`poly_x'' `ydm' = `empiv`p
> oly_x'' `yiv' ) ///
>                                                 , vce(r)
>                         est sto isvydm`poly_x'
>                         drop if _est_isvydm`poly_x'==0
>                         drop *iv *iv? avg*
>                         **** re-build iv
>                         do "$Code\ConstructIV.do"
>                 }
>                 dis "/* AS's IV emp `poly_x'th order */"
>                 ivregress 2sls ///
>                                 `commonVar' ///
>                                 (`emp`poly_x'' `ydm' = `empiv`poly_x'' `yiv' ) 
> ///
>                                 , vce(r)
>                 est sto isvydm`poly_x'
> }
> 
> ** culc. return
> qui{
>         local culcemp1 _b[oj]+emptenure*_b[emptenure]
>         local culcemp2 _b[oj]+emptenure*_b[emptenure] ///
>                                                         +(emptenure^2)*_b[c.emp
> tenure#c.emptenure]
>         local culcemp3 _b[oj]+emptenure*_b[emptenure] ///
>                                                         +(emptenure^2)*_b[c.emp
> tenure#c.emptenure] ///
>                                                         +(emptenure^3)*_b[c.emp
> tenure#c.emptenure#c.emptenure]
>         local culcemp4 _b[oj]+emptenure*_b[emptenure] ///
>                                                         +(emptenure^2)*_b[c.emp
> tenure#c.emptenure] ///
>                                                         +(emptenure^3)*_b[c.emp
> tenure#c.emptenure#c.emptenure] ///
>                                                         +(emptenure^4)*_b[c.emp
> tenure#c.emptenure#c.emptenure#c.emptenure]
> }
> 
> forvalues poly_x=1/4{ /* loop within ten_inomial */
>                 *** culculation
>                 dis "/* emp `poly_x'th order */"
>                 est res olsemp`poly_x'
>                 margins, exp(`culcemp`poly_x'') ///
>                 at(emptenure=(0(1)25)) noe post
>                 est sto olsempr`poly_x'
>                 est res isvydm`poly_x'
>                 margins, exp(`culcemp`poly_x'') ///
>                 at(emptenure=(0(1)25)) noe post
>                 est sto isvydmr`poly_x'
>                 
>                 *** plot
>                 qui coefplot (olsempr`poly_x', label(OLS)) (isvydmr`poly_x', la
> bel(IV)), ///
>                 at ciopts(recast(rline) lpattern(dash)) recast(connected) ///
>                 xtitle("Employer Tenure") ytitle("Returns to Tenure on Earnings
>  (%)") ///
>                 yline(0) rescale(100)
>                 graph export "$Output\plot_as_emp_ydm_`poly_x'.pdf", replace
> }
> 
> ** output tex all results
> qui{
> local labelVar emptenure "Employer tenure" ///
>                                                 c.emptenure#c.emptenure "Emp.te
> n.$^{2}\times 100$" ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure "Emp.ten.$^{3}\times 100$" ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure#c.emptenure "Emp.ten.$^{4}\times 1000$" ///
>                                                 oj "Old job" ///
>                                                 workexp "Total experience" c.wo
> rkexp#c.workexp "Experience$^{2}$" ///
>                                                 c.workexp#c.workexp#c.workexp "
> Exp.$^{3}\times 100$" ///
>                                                 c.workexp#c.workexp#c.workexp#c
> .workexp "Exp.$^{4}\times 10000$"
> local transVar c.emptenure#c.emptenure 100*@ 100 ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure 100*@ 100 ///
>                                                 c.emptenure#c.emptenurec.empten
> ure#c.emptenure 10000*@ 10000 ///
>                                                 c.workexp#c.workexp#c.workexp 1
> 00*@ 100 ///
>                                                 c.workexp#c.workexp#c.workexp 1
> 0000*@ 10000 ///
>                                                 c.occtenure#c.occtenure 100*@ 1
> 00 ///
>                                                 c.occtenure#c.occtenure#c.occte
> nure 100*@ 100 ///
>                                                 c.occtenure#c.occtenure#c.occte
> nure#c.occtenure 10000*@ 10000
> 
> *** coefficients / emptenure
> local keepVar emptenure c.emptenure#c.emptenure ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure ///
>                                                 c.emptenure#c.emptenure#c.empte
> nure#c.emptenure ///
>                                                 oj workexp c.workexp#c.workexp 
> ///
>                                                 c.workexp#c.workexp#c.workexp /
> //
>                                                 c.workexp#c.workexp#c.workexp#c
> .workexp
> 
> esttab olsemp2 olsemp3 olsemp4 isvydm2 isvydm3 isvydm4 ///
> using "$Output\as_emp_ydm.tex", ///
> se star(* 0.1 ** 0.05 *** 0.01) b(4) ///
> keep(`keepVar') ///
> order(`keepVar') ///
> coeflabel(`labelVar') ///
> transform(`transVar') ///
> nodep nonote nomtitles ///
> title(Earnings Function Estimates, using Sample up to 64-year-old, ///
> including Non-regular Workers and Specialists, ///
> Variables of Occupation Tenure are not Controlled.) ///
> mgroups("OLS" "IV" ///
> pattern(1 0 0 1 0 0) ///
> prefix(\multicolumn{@span}{c}{) suffix(}) span erepeat(\cmidrule(lr){@span})) /
> //
> replace
> 
> *** return
> esttab olsempr2 isvydmr2 ///
> using "$Output\as_return_ydm.tex", ///
> se star(* 0.1 ** 0.05 *** 0.01) b(4) ///
> keep(3._at 6._at 11._at 16._at 21._at 26._at) ///
> coeflabel(3._at "2 Years" ///
> 6._at "5 Years" 11._at "10 Years" ///
> 16._at "15 Years" ///
> 21._at "20 Years" 26._at "25 Years") ///
> nodep nonote nomtitles ///
> title(Estimated Returns to Employer Tenure, using Sample up to 64-year-old, ///
> including Non-regular Workers and Specialists.) ///
> mgroups("OLS" "IV" ///
> pattern(1 0 1 0) ///
> prefix(\multicolumn{@span}{c}{) suffix(}) span erepeat(\cmidrule(lr){@span})) /
> //
> replace
> }
> }
> */
> 
> log close

end of do-file

